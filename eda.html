
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Ejercicio 1. Análisis Exploratorio de Datos &#8212; jbook_Parcial_Practico</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'eda';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ejercicio 2. Modelos de Clasificación" href="modelos_clasificacion.html" />
    <link rel="prev" title="Por: Angélica Sepúlveda, Andrés Pedraza y Jefry Llerena" href="descripcion_del_proyecto.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="descripcion_del_proyecto.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo-uninorte.png" class="logo__image only-light" alt="jbook_Parcial_Practico - Home"/>
    <script>document.write(`<img src="_static/logo-uninorte.png" class="logo__image only-dark" alt="jbook_Parcial_Practico - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="descripcion_del_proyecto.html">
                    Por: Angélica Sepúlveda, Andrés Pedraza y Jefry Llerena
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Ejercicio 1. Análisis Exploratorio de Datos</a></li>

<li class="toctree-l1"><a class="reference internal" href="modelos_clasificacion.html">Ejercicio 2. Modelos de Clasificación</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelos_regresion.html">Ejercicio 3. Modelos de Regresión</a></li>

<li class="toctree-l1"><a class="reference internal" href="modelos_segmentacion.html">Ejercicio 4. Modelos de Segmentación</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Feda.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/eda.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ejercicio 1. Análisis Exploratorio de Datos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Ejercicio 1. Análisis Exploratorio de Datos</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#taller-2">Taller 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#punto-1">Punto 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-velocidad-del-viento">1.1. Dataset Velocidad del Viento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-deteccion-de-fraude">1.2. Dataset Deteccion de Fraude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limpieza-y-preparacion">1.3. Limpieza y Preparación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamiento-de-nulos">1.3.1. Tratamiento de Nulos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-dimencionalidad-con-chi2">1.3.2. Reduccion de Dimencionalidad con Chi2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-dimensionalidad-con-vif">1.3.3. Reduccion de dimensionalidad con VIF</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ejercicio-1-analisis-exploratorio-de-datos">
<h1>Ejercicio 1. Análisis Exploratorio de Datos<a class="headerlink" href="#ejercicio-1-analisis-exploratorio-de-datos" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function ClickConnect(){</span>
<span class="c1">#   colab.config</span>
<span class="c1">#   console.log(&quot;Connnect Clicked - Start&quot;);</span>
<span class="c1">#   document.querySelector(&quot;#top-toolbar &gt; colab-connect-button&quot;).shadowRoot.querySelector(&quot;#connect&quot;).click();</span>
<span class="c1">#   console.log(&quot;Connnect Clicked - End&quot;);</span>
<span class="c1"># };</span>
<span class="c1"># setInterval(ClickConnect, 60000)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">google.colab</span><span class="w"> </span><span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>statsmodels<span class="w"> </span>scipy<span class="w"> </span>scikit-optimize
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: statsmodels in /usr/local/lib/python3.11/dist-packages (0.14.4)
Requirement already satisfied: scipy in /usr/local/lib/python3.11/dist-packages (1.14.1)
Collecting scikit-optimize
  Downloading scikit_optimize-0.10.2-py2.py3-none-any.whl.metadata (9.7 kB)
Requirement already satisfied: numpy&lt;3,&gt;=1.22.3 in /usr/local/lib/python3.11/dist-packages (from statsmodels) (2.0.2)
Requirement already satisfied: pandas!=2.1.0,&gt;=1.4 in /usr/local/lib/python3.11/dist-packages (from statsmodels) (2.2.2)
Requirement already satisfied: patsy&gt;=0.5.6 in /usr/local/lib/python3.11/dist-packages (from statsmodels) (1.0.1)
Requirement already satisfied: packaging&gt;=21.3 in /usr/local/lib/python3.11/dist-packages (from statsmodels) (24.2)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.11/dist-packages (from scikit-optimize) (1.4.2)
Collecting pyaml&gt;=16.9 (from scikit-optimize)
  Downloading pyaml-25.1.0-py3-none-any.whl.metadata (12 kB)
Requirement already satisfied: scikit-learn&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from scikit-optimize) (1.6.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2025.2)
Requirement already satisfied: PyYAML in /usr/local/lib/python3.11/dist-packages (from pyaml&gt;=16.9-&gt;scikit-optimize) (6.0.2)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn&gt;=1.0.0-&gt;scikit-optimize) (3.6.0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (1.17.0)
Downloading scikit_optimize-0.10.2-py2.py3-none-any.whl (107 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">107.8/107.8 kB</span> <span class=" -Color -Color-Red">3.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading pyaml-25.1.0-py3-none-any.whl (26 kB)
Installing collected packages: pyaml, scikit-optimize
Successfully installed pyaml-25.1.0 scikit-optimize-0.10.2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.outliers_influence</span><span class="w"> </span><span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tools.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">add_constant</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gc</span>  <span class="c1"># Garbage Collector</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="taller-2">
<h1>Taller 2<a class="headerlink" href="#taller-2" title="Link to this heading">#</a></h1>
<section id="punto-1">
<h2>Punto 1<a class="headerlink" href="#punto-1" title="Link to this heading">#</a></h2>
<section id="dataset-velocidad-del-viento">
<h3>1.1. Dataset Velocidad del Viento<a class="headerlink" href="#dataset-velocidad-del-viento" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_viento</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/lihkir/Data/refs/heads/main/wind_speed/data_treino_dv_df_2000_2010.csv&quot;</span><span class="p">)</span>

<span class="n">df_viento</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-cedf522f-e65b-497e-bcb3-478d6e0a8887" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>HORA (UTC)</th>
      <th>VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))</th>
      <th>VENTO, VELOCIDADE HORARIA (m/s)</th>
      <th>UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)</th>
      <th>UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)</th>
      <th>TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>UMIDADE RELATIVA DO AR, HORARIA (%)</th>
      <th>PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)</th>
      <th>PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)</th>
      <th>VENTO, RAJADA MAXIMA (m/s)</th>
      <th>PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)</th>
      <th>PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87688</th>
      <td>19:00</td>
      <td>-0.615661</td>
      <td>5.6</td>
      <td>83.0</td>
      <td>78.0</td>
      <td>21.8</td>
      <td>21.1</td>
      <td>80.0</td>
      <td>879.1</td>
      <td>0.0</td>
      <td>12.3</td>
      <td>879.8</td>
      <td>879.1</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>20:00</td>
      <td>-0.469472</td>
      <td>4.9</td>
      <td>84.0</td>
      <td>79.0</td>
      <td>21.7</td>
      <td>21.0</td>
      <td>84.0</td>
      <td>879.2</td>
      <td>0.0</td>
      <td>9.9</td>
      <td>879.2</td>
      <td>878.9</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>21:00</td>
      <td>-0.484810</td>
      <td>4.5</td>
      <td>86.0</td>
      <td>82.0</td>
      <td>21.2</td>
      <td>20.6</td>
      <td>86.0</td>
      <td>879.7</td>
      <td>0.0</td>
      <td>8.9</td>
      <td>879.8</td>
      <td>879.2</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>22:00</td>
      <td>-0.484810</td>
      <td>3.2</td>
      <td>88.0</td>
      <td>85.0</td>
      <td>20.6</td>
      <td>20.2</td>
      <td>88.0</td>
      <td>880.5</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>880.5</td>
      <td>879.6</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>23:00</td>
      <td>-0.573576</td>
      <td>2.3</td>
      <td>95.0</td>
      <td>88.0</td>
      <td>20.2</td>
      <td>19.3</td>
      <td>95.0</td>
      <td>881.1</td>
      <td>0.6</td>
      <td>7.5</td>
      <td>881.1</td>
      <td>880.5</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 13 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cedf522f-e65b-497e-bcb3-478d6e0a8887')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cedf522f-e65b-497e-bcb3-478d6e0a8887 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cedf522f-e65b-497e-bcb3-478d6e0a8887');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4f593a5c-b324-4340-a62b-2b55f06c018e">
  <button class="colab-df-quickchart" onclick="quickchart('df-4f593a5c-b324-4340-a62b-2b55f06c018e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4f593a5c-b324-4340-a62b-2b55f06c018e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_24986d47-dd72-4882-ba60-796771e14803">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_viento')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_24986d47-dd72-4882-ba60-796771e14803 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_viento');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_viento</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;HORA (UTC)&#39;, &#39;VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))&#39;,
       &#39;VENTO, VELOCIDADE HORARIA (m/s)&#39;,
       &#39;UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)&#39;,
       &#39;UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)&#39;,
       &#39;TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)&#39;,
       &#39;TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)&#39;,
       &#39;UMIDADE RELATIVA DO AR, HORARIA (%)&#39;,
       &#39;PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)&#39;,
       &#39;PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)&#39;, &#39;VENTO, RAJADA MAXIMA (m/s)&#39;,
       &#39;PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)&#39;,
       &#39;PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1.1 Reduccion de nombres extensos en columnas</span>
<span class="n">df_viento</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;hora&quot;</span><span class="p">,</span> <span class="s2">&quot;viento_direccion_horaria&quot;</span><span class="p">,</span> <span class="s2">&quot;viento_velocidad_horaria&quot;</span><span class="p">,</span>
    <span class="s2">&quot;humedad_max_hora&quot;</span><span class="p">,</span> <span class="s2">&quot;humedad_min_hora&quot;</span><span class="p">,</span> <span class="s2">&quot;temp_min_hora&quot;</span><span class="p">,</span> <span class="s2">&quot;temp_max_hora&quot;</span><span class="p">,</span>
    <span class="s2">&quot;humedad_relativa&quot;</span><span class="p">,</span> <span class="s2">&quot;presion_armosferica&quot;</span><span class="p">,</span> <span class="s2">&quot;precip_atmos_total&quot;</span><span class="p">,</span> <span class="s2">&quot;viento_bajada_max&quot;</span><span class="p">,</span>
    <span class="s2">&quot;precip_atmos_max&quot;</span><span class="p">,</span> <span class="s2">&quot;precip_atmos_min&quot;</span>
<span class="p">]</span>

<span class="n">df_viento</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a5e4f8af-fed8-46a0-8aa5-d82997a5fc10" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hora</th>
      <th>viento_direccion_horaria</th>
      <th>viento_velocidad_horaria</th>
      <th>humedad_max_hora</th>
      <th>humedad_min_hora</th>
      <th>temp_min_hora</th>
      <th>temp_max_hora</th>
      <th>humedad_relativa</th>
      <th>presion_armosferica</th>
      <th>precip_atmos_total</th>
      <th>viento_bajada_max</th>
      <th>precip_atmos_max</th>
      <th>precip_atmos_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87688</th>
      <td>19:00</td>
      <td>-0.615661</td>
      <td>5.6</td>
      <td>83.0</td>
      <td>78.0</td>
      <td>21.8</td>
      <td>21.1</td>
      <td>80.0</td>
      <td>879.1</td>
      <td>0.0</td>
      <td>12.3</td>
      <td>879.8</td>
      <td>879.1</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>20:00</td>
      <td>-0.469472</td>
      <td>4.9</td>
      <td>84.0</td>
      <td>79.0</td>
      <td>21.7</td>
      <td>21.0</td>
      <td>84.0</td>
      <td>879.2</td>
      <td>0.0</td>
      <td>9.9</td>
      <td>879.2</td>
      <td>878.9</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>21:00</td>
      <td>-0.484810</td>
      <td>4.5</td>
      <td>86.0</td>
      <td>82.0</td>
      <td>21.2</td>
      <td>20.6</td>
      <td>86.0</td>
      <td>879.7</td>
      <td>0.0</td>
      <td>8.9</td>
      <td>879.8</td>
      <td>879.2</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>22:00</td>
      <td>-0.484810</td>
      <td>3.2</td>
      <td>88.0</td>
      <td>85.0</td>
      <td>20.6</td>
      <td>20.2</td>
      <td>88.0</td>
      <td>880.5</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>880.5</td>
      <td>879.6</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>23:00</td>
      <td>-0.573576</td>
      <td>2.3</td>
      <td>95.0</td>
      <td>88.0</td>
      <td>20.2</td>
      <td>19.3</td>
      <td>95.0</td>
      <td>881.1</td>
      <td>0.6</td>
      <td>7.5</td>
      <td>881.1</td>
      <td>880.5</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 13 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a5e4f8af-fed8-46a0-8aa5-d82997a5fc10')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a5e4f8af-fed8-46a0-8aa5-d82997a5fc10 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a5e4f8af-fed8-46a0-8aa5-d82997a5fc10');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5b14a8f2-ff39-45bf-8055-3c367389618f">
  <button class="colab-df-quickchart" onclick="quickchart('df-5b14a8f2-ff39-45bf-8055-3c367389618f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5b14a8f2-ff39-45bf-8055-3c367389618f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_4c49c5de-3654-4954-87f9-1216af254fea">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_viento')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_4c49c5de-3654-4954-87f9-1216af254fea button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_viento');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_viento</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 87693 entries, 0 to 87692
Data columns (total 13 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   hora                      87693 non-null  object 
 1   viento_direccion_horaria  87693 non-null  float64
 2   viento_velocidad_horaria  87693 non-null  float64
 3   humedad_max_hora          87693 non-null  float64
 4   humedad_min_hora          87693 non-null  float64
 5   temp_min_hora             87693 non-null  float64
 6   temp_max_hora             87693 non-null  float64
 7   humedad_relativa          87693 non-null  float64
 8   presion_armosferica       87693 non-null  float64
 9   precip_atmos_total        87693 non-null  float64
 10  viento_bajada_max         87693 non-null  float64
 11  precip_atmos_max          87693 non-null  float64
 12  precip_atmos_min          87693 non-null  float64
dtypes: float64(12), object(1)
memory usage: 8.7+ MB
</pre></div>
</div>
</div>
</div>
<p>El conjunto de datos tiene 87693 registros y 13 columnas.</p>
<p>Sólo una columna es de tipo texto (hora), todas las demás son numéricas.</p>
<p>No hay valores nulos en ninguna de las columnas, lo cual es excelente para el análisis predictivo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1.2 Descripcion de media, desv, min, max, cuartiles</span>
<span class="n">df_viento</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5b1691ef-fc9d-4a92-8a10-1ee0b575b018" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>viento_direccion_horaria</th>
      <th>viento_velocidad_horaria</th>
      <th>humedad_max_hora</th>
      <th>humedad_min_hora</th>
      <th>temp_min_hora</th>
      <th>temp_max_hora</th>
      <th>humedad_relativa</th>
      <th>presion_armosferica</th>
      <th>precip_atmos_total</th>
      <th>viento_bajada_max</th>
      <th>precip_atmos_max</th>
      <th>precip_atmos_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
      <td>87693.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.405810</td>
      <td>2.466192</td>
      <td>69.058465</td>
      <td>63.176194</td>
      <td>21.921264</td>
      <td>20.684570</td>
      <td>66.146682</td>
      <td>887.251925</td>
      <td>0.160907</td>
      <td>5.161076</td>
      <td>887.580724</td>
      <td>886.891093</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.686247</td>
      <td>1.313968</td>
      <td>19.640222</td>
      <td>20.166336</td>
      <td>3.721386</td>
      <td>3.513744</td>
      <td>19.992327</td>
      <td>4.012404</td>
      <td>1.307515</td>
      <td>2.311157</td>
      <td>3.646750</td>
      <td>3.564539</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.000000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>10.000000</td>
      <td>9.200000</td>
      <td>8.400000</td>
      <td>10.000000</td>
      <td>863.400000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>865.300000</td>
      <td>862.800000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.156434</td>
      <td>1.500000</td>
      <td>54.000000</td>
      <td>48.000000</td>
      <td>19.200000</td>
      <td>18.400000</td>
      <td>51.000000</td>
      <td>885.300000</td>
      <td>0.000000</td>
      <td>3.400000</td>
      <td>885.600000</td>
      <td>885.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.788011</td>
      <td>2.400000</td>
      <td>72.000000</td>
      <td>64.000000</td>
      <td>21.400000</td>
      <td>20.200000</td>
      <td>68.000000</td>
      <td>887.200000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>887.500000</td>
      <td>886.900000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.970296</td>
      <td>3.400000</td>
      <td>87.000000</td>
      <td>80.000000</td>
      <td>24.700000</td>
      <td>23.100000</td>
      <td>84.000000</td>
      <td>889.100000</td>
      <td>0.000000</td>
      <td>6.800000</td>
      <td>889.300000</td>
      <td>888.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>10.000000</td>
      <td>100.000000</td>
      <td>98.000000</td>
      <td>35.300000</td>
      <td>34.400000</td>
      <td>99.000000</td>
      <td>1023.500000</td>
      <td>70.800000</td>
      <td>24.300000</td>
      <td>913.100000</td>
      <td>910.900000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5b1691ef-fc9d-4a92-8a10-1ee0b575b018')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5b1691ef-fc9d-4a92-8a10-1ee0b575b018 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5b1691ef-fc9d-4a92-8a10-1ee0b575b018');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5de1a917-5075-48b8-90b5-58ed585bf3c9">
  <button class="colab-df-quickchart" onclick="quickchart('df-5de1a917-5075-48b8-90b5-58ed585bf3c9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5de1a917-5075-48b8-90b5-58ed585bf3c9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Velocidad</span> <span class="pre">del</span> <span class="pre">viento</span> <span class="pre">(viento_velocidad_horaria):</span> </code></p>
<ul>
<li><p>Promedio: 2.46 m/s</p></li>
<li><p>Mínimo: 0 m/s, Máximo: 10 m/s</p></li>
<li><p>Se observa una variabilidad moderada (desviación estándar: 1.31 m/s).</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ráfaga</span> <span class="pre">máxima</span> <span class="pre">(viento_bajada_max):</span></code></p>
<ul>
<li><p>Promedio: 5.16 m/s</p></li>
<li><p>Puede llegar hasta los 24.3 m/s.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Humedad</span> <span class="pre">relativa:</span></code></p>
<ul>
<li><p>Valores medios alrededor del 66%, con extremos entre 10% y 99%.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Temperatura</span> <span class="pre">mínima</span> <span class="pre">y</span> <span class="pre">máxima:</span></code></p>
<ul>
<li><p>Rango de temperaturas mínimo entre 9.2 °C y 35.3 °C.</p></li>
<li><p>Las máximas registradas oscilan hasta los 34.4 °C.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Precipitación</span> <span class="pre">total</span> <span class="pre">por</span> <span class="pre">hora:</span></code></p>
<ul>
<li><p>La mayoría de los registros tienen 0 mm de precipitación, pero hay valores máximos de hasta 70.8 mm, lo cual indica lluvias intensas en algunos momentos.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Presión</span> <span class="pre">atmosférica:</span></code></p>
<ul>
<li><p>En promedio, se mantiene alrededor de los 887 mB, con una variación normal.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1.3. Datos faltantes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cantidad de nulos:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_viento</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No hay valores nulos en ninguna columna.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cantidad de nulos:

hora                        0
viento_direccion_horaria    0
viento_velocidad_horaria    0
humedad_max_hora            0
humedad_min_hora            0
temp_min_hora               0
temp_max_hora               0
humedad_relativa            0
presion_armosferica         0
precip_atmos_total          0
viento_bajada_max           0
precip_atmos_max            0
precip_atmos_min            0
dtype: int64
No hay valores nulos en ninguna columna.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1.4. Seleccion de variables independientes</span>
<span class="n">viento_variables_independientes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;viento_direccion_horaria&quot;</span><span class="p">,</span>
    <span class="s2">&quot;viento_velocidad_horaria&quot;</span><span class="p">,</span>
    <span class="s2">&quot;viento_bajada_max&quot;</span><span class="p">,</span>
    <span class="s2">&quot;humedad_relativa&quot;</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">viento_variables_independientes</span><span class="p">:</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span>
        <span class="n">kde</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograma para la variable   &#39;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/71ad7cf963ea700b50f1d004f68e614be3bae91bfc59784620a6ef5e388be460.png" src="_images/71ad7cf963ea700b50f1d004f68e614be3bae91bfc59784620a6ef5e388be460.png" />
<img alt="_images/311825002d79537666a72679198d009316ea2b115422196f8c08676d666ff995.png" src="_images/311825002d79537666a72679198d009316ea2b115422196f8c08676d666ff995.png" />
<img alt="_images/3b4a38025167c1128c927163850a36981fbf5f2122819272778161aeb89cba68.png" src="_images/3b4a38025167c1128c927163850a36981fbf5f2122819272778161aeb89cba68.png" />
<img alt="_images/9a40a72564640078564082e90aacbc635be03b7d9be8c18af18fce13f48e8547.png" src="_images/9a40a72564640078564082e90aacbc635be03b7d9be8c18af18fce13f48e8547.png" />
</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">viento_direccion_horaria</span></code></p></li>
</ol>
<ul class="simple">
<li><p>La distribución es asimétrica, con dos picos notables.</p></li>
<li><p>La mayoría de los valores están entre -1 y 1, lo que puede estar representando una codificación trigonométrica (como cos(θ)).</p></li>
<li><p>Hay más densidad hacia valores positivos, lo que sugiere que ciertas direcciones del viento son predominantes.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">viento_velocidad_horaria</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Tiene una distribución sesgada hacia la derecha.</p></li>
<li><p>La mayoría de las velocidades están entre 1 y 4 m/s, con una caída rápida después.</p></li>
<li><p>Hay pocos valores extremos hasta los 10 m/s, lo cual puede indicar días con condiciones de viento más intensas.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><code class="docutils literal notranslate"><span class="pre">viento_bajada_max</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Similar a la anterior, también presenta una cola larga hacia la derecha.</p></li>
<li><p>Los valores más comunes están entre 3 y 7 m/s, pero hay algunos valores que alcanzan más de 20 m/s, indicando ráfagas muy fuertes en eventos poco frecuentes.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">humedad_relativa</span></code></p></li>
</ol>
<ul class="simple">
<li><p>Tiene una forma más simétrica y normalizada, centrada alrededor del 60-70%.</p></li>
<li><p>Esto indica una humedad ambiental bastante estable en la mayoría de los registros.</p></li>
<li><p>No hay valores extremos ni colas muy pronunciadas, lo cual es bueno para análisis estadísticos.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">viento_variables_independientes</span><span class="p">:</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">variable</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Boxplot para la variable   &#39;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/daa915e6f18b6b92ac1d5d823ac2a77082b9a002154a266b9e5818cac05a9715.png" src="_images/daa915e6f18b6b92ac1d5d823ac2a77082b9a002154a266b9e5818cac05a9715.png" />
<img alt="_images/05a9f2fc428c66ae45eef059ad170189fea4a53c3cd13912f44aaa582d19e561.png" src="_images/05a9f2fc428c66ae45eef059ad170189fea4a53c3cd13912f44aaa582d19e561.png" />
<img alt="_images/6bbdd496d921b7323a9b0a5d0e0f26d7ffe930994ec5133a29ef33ec20eabd0e.png" src="_images/6bbdd496d921b7323a9b0a5d0e0f26d7ffe930994ec5133a29ef33ec20eabd0e.png" />
<img alt="_images/2d04aa6ce8cf9944c32b1b1a9cb9c51a8843ccc3dbcf51e7d12c2712f2ef1bc4.png" src="_images/2d04aa6ce8cf9944c32b1b1a9cb9c51a8843ccc3dbcf51e7d12c2712f2ef1bc4.png" />
</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">viento_direccion_horaria</span></code></p>
<ul class="simple">
<li><p>La distribución tiene una amplitud moderada, entre aproximadamente -1 y 1.</p></li>
<li><p>Hay algunos valores atípicos (outliers), principalmente en los extremos negativos y positivos, pero no son excesivos.</p></li>
<li><p>El rango intercuartílico (IQR) es amplio, lo que sugiere variabilidad en las direcciones del viento.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">viento_velocidad_horaria</span></code></p>
<ul class="simple">
<li><p>La mayor parte de los valores están por debajo de los 5 m/s.</p></li>
<li><p>Aparecen varios outliers por encima de los 6-7 m/s, algunos llegando hasta los 10 m/s.</p></li>
<li><p>Esto sugiere que existen días poco frecuentes con vientos considerablemente más intensos.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">viento_bajada_max</span></code></p>
<ul class="simple">
<li><p>Similar al anterior, pero con una mayor presencia de valores extremos (hasta 24.3 m/s).</p></li>
<li><p>El IQR está entre aproximadamente 3.4 y 6.8 m/s, con una mediana en torno a 5 m/s.</p></li>
<li><p>Los outliers representan ráfagas muy intensas, probablemente eventos climáticos puntuales.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">humedad_relativa</span></code></p>
<ul class="simple">
<li><p>Distribución más simétrica y centrada, sin grandes sesgos.</p></li>
<li><p>El IQR va aproximadamente de 51% a 84%, con pocos outliers en ambos extremos.</p></li>
<li><p>Esto confirma la estabilidad de la humedad en la mayoría de los registros.</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple">
<li><p>Simetría</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">viento_direccion_horaria</span></code>: Presenta asimetría leve, con mayor densidad hacia valores positivos. Esto puede estar relacionado con una codificación trigonométrica (ej. valores tipo cos(θ)), por lo que es normal no ver una forma de campana simétrica.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">viento_velocidad_horaria</span></code> y <code class="docutils literal notranslate"><span class="pre">viento_bajada_max</span></code>: Ambas tienen una distribución asimétrica positiva o sesgada a la derecha, es decir, hay una mayor concentración de datos en valores bajos, pero con una “cola” que se extiende hacia valores más altos.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">humedad_relativa</span></code>: Es la más simétrica del grupo, con una forma parecida a una distribución normal, centrada cerca del 65%.</p></li>
</ul>
</li>
<li><p>Datos Atípicos (Outliers)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">viento_velocidad_horaria</span></code>: Tiene varios outliers por encima de 6 m/s, indicando eventos esporádicos de viento fuerte. Estos datos son importantes en contextos de energía eólica porque pueden representar picos de generación.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">viento_bajada_max</span></code>: Tiene la mayor cantidad de outliers. Algunos registros alcanzan más de 20 m/s, lo que podría ser relevante para estudios de condiciones extremas o alertas meteorológicas.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">viento_direccion_horaria</span></code>: Tiene unos cuantos valores fuera del rango principal, aunque no son extremos en cantidad.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">humedad_relativa</span></code>: Tiene pocos outliers. Esto refuerza que es una variable estable a lo largo del tiempo.</p></li>
</ul>
</li>
<li><p>Dispersión</p>
<ul class="simple">
<li><p>Alta dispersión:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">viento_bajada_max</span></code>: Gran variabilidad, desde valores bajos (cercanos a 0) hasta más de 24 m/s.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">viento_velocidad_horaria</span></code>: Aunque en menor medida, también muestra amplitud de valores.</p></li>
</ul>
</li>
<li><p>Dispersión moderada:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">viento_direccion_horaria</span></code>: Tiene un rango amplio entre -1 y 1, pero la mayoría de los valores están concentrados en zonas específicas.</p></li>
</ul>
</li>
<li><p>Baja dispersión:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">humedad_relativa</span></code>: Tiene valores bastante agrupados entre 50% y 85%, lo cual indica estabilidad.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;temp_min_hora&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;humedad_min_hora&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Scatterplot: &#39;temp_min_hora&#39; vs &#39;humedad_min_hora&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;precip_atmos_min&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;humedad_min_hora&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Scatterplot: &#39;precip_atmos_min&#39; vs &#39;humedad_min_hora&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;temp_max_hora&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;humedad_max_hora&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Scatterplot: &#39;temp_max_hora&#39; vs &#39;humedad_max_hora&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;humedad_relativa&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;viento_velocidad_horaria&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Scatterplot: &#39;humedad_relativa&#39; vs &#39;viento_velocidad_horaria&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02213c5dd01bc81347085518c0d865acbc1ca95bef5bc1a45dbb445052fc6446.png" src="_images/02213c5dd01bc81347085518c0d865acbc1ca95bef5bc1a45dbb445052fc6446.png" />
<img alt="_images/d5f1513fc79f37226d661ee7de3ccc1a29633b178e8f706710923ea018b77158.png" src="_images/d5f1513fc79f37226d661ee7de3ccc1a29633b178e8f706710923ea018b77158.png" />
<img alt="_images/9d66e336d8d33ed89be326067acf646c150e268884161db6ee4f6527308406b8.png" src="_images/9d66e336d8d33ed89be326067acf646c150e268884161db6ee4f6527308406b8.png" />
<img alt="_images/81f4cb7b42d42a89df73aee209e66918947b9b46461be6ff5150f5f5ebd041ed.png" src="_images/81f4cb7b42d42a89df73aee209e66918947b9b46461be6ff5150f5f5ebd041ed.png" />
</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">temp_min_hora</span></code> vs <code class="docutils literal notranslate"><span class="pre">humedad_min_hora</span></code></p>
<ul class="simple">
<li><p>Se observa una clara relación inversa: a medida que la temperatura mínima aumenta, la humedad mínima tiende a disminuir.</p></li>
<li><p>La nube de puntos tiene una forma descendente clara, lo que sugiere una correlación negativa fuerte.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">precip_atmos_min</span></code> vs <code class="docutils literal notranslate"><span class="pre">humedad_min_hora</span></code></p>
<ul class="simple">
<li><p>La relación es más difusa, aunque se puede ver una leve tendencia positiva: mayores niveles de presión mínima podrían estar ligeramente asociados a mayor humedad mínima.</p></li>
<li><p>Sin embargo, hay mucha dispersión y el patrón no es tan claro como en el primer gráfico.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">temp_max_hora</span></code> vs <code class="docutils literal notranslate"><span class="pre">humedad_max_hora</span></code></p>
<ul class="simple">
<li><p>Similar al primer gráfico, muestra una relación inversa: temperaturas máximas más altas tienden a coincidir con menores niveles de humedad máxima.</p></li>
<li><p>Aunque hay mayor dispersión que en el primer caso, el patrón sigue siendo reconocible.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">humedad_relativa</span></code> vs <code class="docutils literal notranslate"><span class="pre">viento_velocidad_horaria</span></code></p>
<ul class="simple">
<li><p>Aquí la relación es débil o casi nula. Los puntos están dispersos sin una tendencia clara ascendente o descendente.</p></li>
<li><p>Esto sugiere que la humedad relativa no tiene una relación lineal evidente con la velocidad del viento horaria.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;temp_min_hora&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;humedad_min_hora&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Regplot: &#39;temp_min_hora&#39; vs &#39;humedad_min_hora&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;precip_atmos_min&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;humedad_min_hora&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Regplot: &#39;precip_atmos_min&#39; vs &#39;humedad_min_hora&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;temp_max_hora&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;humedad_max_hora&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Regplot: &#39;temp_max_hora&#39; vs &#39;humedad_max_hora&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_viento</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;humedad_relativa&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;viento_velocidad_horaria&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Regplot: &#39;humedad_relativa&#39; vs &#39;viento_velocidad_horaria&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8667c5ddb52476b5ddff9b32cf168fce5172a0d525e6707030ba4ff244f7a3ad.png" src="_images/8667c5ddb52476b5ddff9b32cf168fce5172a0d525e6707030ba4ff244f7a3ad.png" />
<img alt="_images/5da63d5da3523daf098f769988568124b859e0ef0363ecf13c817d8d2a1da411.png" src="_images/5da63d5da3523daf098f769988568124b859e0ef0363ecf13c817d8d2a1da411.png" />
<img alt="_images/77436c18e510dfd5dd83a145660643368a59cb85541b8ab74d2eed3b07b00872.png" src="_images/77436c18e510dfd5dd83a145660643368a59cb85541b8ab74d2eed3b07b00872.png" />
<img alt="_images/550cbc9571e62d91b6ca1809f49ca96728233cbabf0159419709ff1b3da02637.png" src="_images/550cbc9571e62d91b6ca1809f49ca96728233cbabf0159419709ff1b3da02637.png" />
</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">temp_min_hora</span></code> vs <code class="docutils literal notranslate"><span class="pre">humedad_min_hora</span></code></p>
<ul class="simple">
<li><p>Se confirma la fuerte relación inversa observada en el scatterplot. La línea de regresión desciende de forma clara a medida que aumenta la temperatura mínima.</p></li>
<li><p>Esto sugiere que en condiciones de mayor temperatura mínima, la humedad mínima registrada es menor, probablemente por mayor capacidad del aire para retener vapor de agua.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">precip_atmos_min</span></code> vs <code class="docutils literal notranslate"><span class="pre">humedad_min_hora</span></code></p>
<ul class="simple">
<li><p>La línea de regresión tiene una pendiente levemente positiva, pero la dispersión sigue siendo muy amplia.</p></li>
<li><p>Aunque hay una sugerencia de correlación, la alta variabilidad indica que la presión mínima no es un predictor confiable por sí sola para la humedad mínima.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">temp_max_hora</span></code> vs <code class="docutils literal notranslate"><span class="pre">humedad_max_hora</span></code></p>
<ul class="simple">
<li><p>La relación inversa también se ve reflejada aquí con una pendiente negativa moderada.</p></li>
<li><p>La dispersión es mayor que en el caso de la temperatura mínima, pero la tendencia general sugiere que temperaturas máximas elevadas tienden a coincidir con menor humedad máxima.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">humedad_relativa</span></code> vs <code class="docutils literal notranslate"><span class="pre">viento_velocidad_horaria</span></code></p>
<ul class="simple">
<li><p>La línea de regresión es casi horizontal, reforzando la idea de que no hay una correlación lineal clara entre estas dos variables.</p></li>
<li><p>La densidad de puntos no sugiere una relación predecible, lo cual podría indicar que la velocidad del viento está más influida por otras variables externas o dinámicas más complejas. ​</p></li>
</ul>
</li>
</ol>
</section>
<section id="dataset-deteccion-de-fraude">
<h3>1.2. Dataset Deteccion de Fraude<a class="headerlink" href="#dataset-deteccion-de-fraude" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_test_identity = pd.read_csv(&quot;fraude/test_identity.csv&quot;)</span>
<span class="c1"># df_test_transaction = pd.read_csv(&quot;fraude/test_transaction.csv&quot;)</span>

<span class="c1"># df_train_identity = pd.read_csv(&quot;fraude/train_identity.csv&quot;)</span>
<span class="c1"># df_train_transaction = pd.read_csv(&quot;fraude/train_transaction.csv&quot;)</span>

<span class="n">df_test_identity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/Trabajo Online/Andres Pedraza/Trabajo 3/fraude/test_identity.csv&quot;</span><span class="p">)</span>
<span class="n">df_test_transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/Trabajo Online/Andres Pedraza/Trabajo 3/fraude/test_transaction.csv&quot;</span><span class="p">)</span>

<span class="n">df_train_identity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/Trabajo Online/Andres Pedraza/Trabajo 3/fraude/train_identity.csv&quot;</span><span class="p">)</span>
<span class="n">df_train_transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/Trabajo Online/Andres Pedraza/Trabajo 3/fraude/train_transaction.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_identity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1db66051-1739-41d1-9de5-77afd1aff89f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>id_01</th>
      <th>id_02</th>
      <th>id_03</th>
      <th>id_04</th>
      <th>id_05</th>
      <th>id_06</th>
      <th>id_07</th>
      <th>id_08</th>
      <th>id_09</th>
      <th>...</th>
      <th>id_31</th>
      <th>id_32</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987004</td>
      <td>0.0</td>
      <td>70787.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>samsung browser 6.2</td>
      <td>32.0</td>
      <td>2220x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987008</td>
      <td>-5.0</td>
      <td>98945.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>-5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>mobile safari 11.0</td>
      <td>32.0</td>
      <td>1334x750</td>
      <td>match_status:1</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>iOS Device</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987010</td>
      <td>-5.0</td>
      <td>191631.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>...</td>
      <td>chrome 62.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987011</td>
      <td>-5.0</td>
      <td>221832.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>-6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>chrome 62.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>desktop</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987016</td>
      <td>0.0</td>
      <td>7460.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>...</td>
      <td>chrome 62.0</td>
      <td>24.0</td>
      <td>1280x800</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>desktop</td>
      <td>MacOS</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>144228</th>
      <td>3577521</td>
      <td>-15.0</td>
      <td>145955.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>...</td>
      <td>chrome 66.0 for android</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>F3111 Build/33.3.A.1.97</td>
    </tr>
    <tr>
      <th>144229</th>
      <td>3577526</td>
      <td>-5.0</td>
      <td>172059.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>-5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>chrome 55.0 for android</td>
      <td>32.0</td>
      <td>855x480</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>A574BL Build/NMF26F</td>
    </tr>
    <tr>
      <th>144230</th>
      <td>3577529</td>
      <td>-20.0</td>
      <td>632381.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.0</td>
      <td>-36.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>chrome 65.0 for android</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>Moto E (4) Plus Build/NMA26.42-152</td>
    </tr>
    <tr>
      <th>144231</th>
      <td>3577531</td>
      <td>-5.0</td>
      <td>55528.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>...</td>
      <td>chrome 66.0</td>
      <td>24.0</td>
      <td>2560x1600</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>MacOS</td>
    </tr>
    <tr>
      <th>144232</th>
      <td>3577534</td>
      <td>-45.0</td>
      <td>339406.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-10.0</td>
      <td>-100.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>chrome 66.0 for android</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>RNE-L03 Build/HUAWEIRNE-L03</td>
    </tr>
  </tbody>
</table>
<p>144233 rows × 41 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1db66051-1739-41d1-9de5-77afd1aff89f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1db66051-1739-41d1-9de5-77afd1aff89f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1db66051-1739-41d1-9de5-77afd1aff89f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-76aa9fe9-0284-4398-8bfe-90a0b385c8c4">
  <button class="colab-df-quickchart" onclick="quickchart('df-76aa9fe9-0284-4398-8bfe-90a0b385c8c4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-76aa9fe9-0284-4398-8bfe-90a0b385c8c4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_af9d09ff-6ae8-4f0c-a9a6-63d2f7751a61">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_train_identity')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_af9d09ff-6ae8-4f0c-a9a6-63d2f7751a61 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_train_identity');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_transaction</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-32d8d888-b560-4367-886a-2e86837f2692" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>V330</th>
      <th>V331</th>
      <th>V332</th>
      <th>V333</th>
      <th>V334</th>
      <th>V335</th>
      <th>V336</th>
      <th>V337</th>
      <th>V338</th>
      <th>V339</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.50</td>
      <td>W</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.00</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.00</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.00</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.00</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>3577535</td>
      <td>0</td>
      <td>15811047</td>
      <td>49.00</td>
      <td>W</td>
      <td>6550</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>3577536</td>
      <td>0</td>
      <td>15811049</td>
      <td>39.50</td>
      <td>W</td>
      <td>10444</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>3577537</td>
      <td>0</td>
      <td>15811079</td>
      <td>30.95</td>
      <td>W</td>
      <td>12037</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>3577538</td>
      <td>0</td>
      <td>15811088</td>
      <td>117.00</td>
      <td>W</td>
      <td>7826</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>3577539</td>
      <td>0</td>
      <td>15811131</td>
      <td>279.95</td>
      <td>W</td>
      <td>15066</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 394 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-32d8d888-b560-4367-886a-2e86837f2692')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-32d8d888-b560-4367-886a-2e86837f2692 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-32d8d888-b560-4367-886a-2e86837f2692');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ea0909e3-6557-4f22-b871-ab1bc5026a20">
  <button class="colab-df-quickchart" onclick="quickchart('df-ea0909e3-6557-4f22-b871-ab1bc5026a20')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ea0909e3-6557-4f22-b871-ab1bc5026a20 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_6743e6cf-9565-4b43-a8fa-1010f9c5225a">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_train_transaction')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_6743e6cf-9565-4b43-a8fa-1010f9c5225a button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_train_transaction');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">left</span><span class="o">=</span><span class="n">df_test_transaction</span><span class="p">,</span>
    <span class="n">right</span><span class="o">=</span><span class="n">df_test_identity</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;TransactionID&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">df_train_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">left</span><span class="o">=</span><span class="n">df_train_transaction</span><span class="p">,</span>
    <span class="n">right</span><span class="o">=</span><span class="n">df_train_identity</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;TransactionID&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">df_test_full</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c463bd2e-9a24-4ec9-9f13-928fbd6e9c1b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>card6</th>
      <th>...</th>
      <th>id-31</th>
      <th>id-32</th>
      <th>id-33</th>
      <th>id-34</th>
      <th>id-35</th>
      <th>id-36</th>
      <th>id-37</th>
      <th>id-38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3663549</td>
      <td>18403224</td>
      <td>31.950</td>
      <td>W</td>
      <td>10409</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3663550</td>
      <td>18403263</td>
      <td>49.000</td>
      <td>W</td>
      <td>4272</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3663551</td>
      <td>18403310</td>
      <td>171.000</td>
      <td>W</td>
      <td>4476</td>
      <td>574.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3663552</td>
      <td>18403310</td>
      <td>284.950</td>
      <td>W</td>
      <td>10989</td>
      <td>360.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3663553</td>
      <td>18403317</td>
      <td>67.950</td>
      <td>W</td>
      <td>18018</td>
      <td>452.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>506686</th>
      <td>4170235</td>
      <td>34214279</td>
      <td>94.679</td>
      <td>C</td>
      <td>13832</td>
      <td>375.0</td>
      <td>185.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>506687</th>
      <td>4170236</td>
      <td>34214287</td>
      <td>12.173</td>
      <td>C</td>
      <td>3154</td>
      <td>408.0</td>
      <td>185.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>chrome 43.0 for android</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>ALE-L23 Build/HuaweiALE-L23</td>
    </tr>
    <tr>
      <th>506688</th>
      <td>4170237</td>
      <td>34214326</td>
      <td>49.000</td>
      <td>W</td>
      <td>16661</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>506689</th>
      <td>4170238</td>
      <td>34214337</td>
      <td>202.000</td>
      <td>W</td>
      <td>16621</td>
      <td>516.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>506690</th>
      <td>4170239</td>
      <td>34214345</td>
      <td>24.346</td>
      <td>C</td>
      <td>5713</td>
      <td>168.0</td>
      <td>144.0</td>
      <td>visa</td>
      <td>147.0</td>
      <td>credit</td>
      <td>...</td>
      <td>samsung browser 8.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>SAMSUNG</td>
    </tr>
  </tbody>
</table>
<p>506691 rows × 433 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c463bd2e-9a24-4ec9-9f13-928fbd6e9c1b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c463bd2e-9a24-4ec9-9f13-928fbd6e9c1b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c463bd2e-9a24-4ec9-9f13-928fbd6e9c1b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f77aa53a-1946-481c-878a-b71314a56b3e">
  <button class="colab-df-quickchart" onclick="quickchart('df-f77aa53a-1946-481c-878a-b71314a56b3e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f77aa53a-1946-481c-878a-b71314a56b3e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_9c7e8a45-2858-44d9-af89-92ec1efb7d6f">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_test_full')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_9c7e8a45-2858-44d9-af89-92ec1efb7d6f button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_test_full');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Liberar memoria</span>
<span class="k">del</span> <span class="n">df_test_identity</span>
<span class="k">del</span> <span class="n">df_test_transaction</span>

<span class="k">del</span> <span class="n">df_train_identity</span>
<span class="k">del</span> <span class="n">df_train_transaction</span>

<span class="c1"># Forzar recolección de basura</span>
<span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>48966
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test_full</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_test_full</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
<span class="n">df_test_full</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-74ae9507-791b-46f4-8e09-e6dde897da2e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>card6</th>
      <th>...</th>
      <th>id_31</th>
      <th>id_32</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3663549</td>
      <td>18403224</td>
      <td>31.950</td>
      <td>W</td>
      <td>10409</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3663550</td>
      <td>18403263</td>
      <td>49.000</td>
      <td>W</td>
      <td>4272</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3663551</td>
      <td>18403310</td>
      <td>171.000</td>
      <td>W</td>
      <td>4476</td>
      <td>574.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3663552</td>
      <td>18403310</td>
      <td>284.950</td>
      <td>W</td>
      <td>10989</td>
      <td>360.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3663553</td>
      <td>18403317</td>
      <td>67.950</td>
      <td>W</td>
      <td>18018</td>
      <td>452.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>506686</th>
      <td>4170235</td>
      <td>34214279</td>
      <td>94.679</td>
      <td>C</td>
      <td>13832</td>
      <td>375.0</td>
      <td>185.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>506687</th>
      <td>4170236</td>
      <td>34214287</td>
      <td>12.173</td>
      <td>C</td>
      <td>3154</td>
      <td>408.0</td>
      <td>185.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>chrome 43.0 for android</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>ALE-L23 Build/HuaweiALE-L23</td>
    </tr>
    <tr>
      <th>506688</th>
      <td>4170237</td>
      <td>34214326</td>
      <td>49.000</td>
      <td>W</td>
      <td>16661</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>506689</th>
      <td>4170238</td>
      <td>34214337</td>
      <td>202.000</td>
      <td>W</td>
      <td>16621</td>
      <td>516.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>506690</th>
      <td>4170239</td>
      <td>34214345</td>
      <td>24.346</td>
      <td>C</td>
      <td>5713</td>
      <td>168.0</td>
      <td>144.0</td>
      <td>visa</td>
      <td>147.0</td>
      <td>credit</td>
      <td>...</td>
      <td>samsung browser 8.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>SAMSUNG</td>
    </tr>
  </tbody>
</table>
<p>506691 rows × 433 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-74ae9507-791b-46f4-8e09-e6dde897da2e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-74ae9507-791b-46f4-8e09-e6dde897da2e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-74ae9507-791b-46f4-8e09-e6dde897da2e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6a568fe8-c5f8-4992-823d-b2565606594c">
  <button class="colab-df-quickchart" onclick="quickchart('df-6a568fe8-c5f8-4992-823d-b2565606594c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6a568fe8-c5f8-4992-823d-b2565606594c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_dab8516b-639b-408f-8c49-a991b4ce1e4c">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_test_full')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_dab8516b-639b-408f-8c49-a991b4ce1e4c button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_test_full');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_full</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7b6409c0-b527-41e9-90b5-03aef7274f1b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>id_31</th>
      <th>id_32</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.50</td>
      <td>W</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.00</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.00</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.00</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.00</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>samsung browser 6.2</td>
      <td>32.0</td>
      <td>2220x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>3577535</td>
      <td>0</td>
      <td>15811047</td>
      <td>49.00</td>
      <td>W</td>
      <td>6550</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>3577536</td>
      <td>0</td>
      <td>15811049</td>
      <td>39.50</td>
      <td>W</td>
      <td>10444</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>3577537</td>
      <td>0</td>
      <td>15811079</td>
      <td>30.95</td>
      <td>W</td>
      <td>12037</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>3577538</td>
      <td>0</td>
      <td>15811088</td>
      <td>117.00</td>
      <td>W</td>
      <td>7826</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>3577539</td>
      <td>0</td>
      <td>15811131</td>
      <td>279.95</td>
      <td>W</td>
      <td>15066</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 434 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7b6409c0-b527-41e9-90b5-03aef7274f1b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7b6409c0-b527-41e9-90b5-03aef7274f1b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7b6409c0-b527-41e9-90b5-03aef7274f1b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-08c640f4-717e-4e3b-9061-67f01fe0dde4">
  <button class="colab-df-quickchart" onclick="quickchart('df-08c640f4-717e-4e3b-9061-67f01fe0dde4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-08c640f4-717e-4e3b-9061-67f01fe0dde4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_a4fc4919-3932-43a2-ac12-cdddac9cdf7d">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_train_full')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_a4fc4919-3932-43a2-ac12-cdddac9cdf7d button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_train_full');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_full</span><span class="p">[</span><span class="s2">&quot;isFraud&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>isFraud</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>569877</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20663</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_full</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 434 entries, TransactionID to DeviceInfo
dtypes: float64(399), int64(4), object(31)
memory usage: 1.9+ GB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cantidad de variables por tipo de variable:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df_train_full</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cantidad de variables por tipo de variable:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>float64</th>
      <td>399</td>
    </tr>
    <tr>
      <th>object</th>
      <td>31</td>
    </tr>
    <tr>
      <th>int64</th>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label></div></div>
</div>
<p>El conjunto de datos tiene 590540 registros y 434 columnas</p>
<p>Existen 399 columnas decimales, 31 categoricas y 4 con numeros enteros.</p>
<p>Cantidad de columnas con algun nulo: 382</p>
<p>Cantidad de columnas sin nulos: 52</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad_nulos_train</span> <span class="o">=</span> <span class="n">df_train_full</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">porcentaje_nulos_train</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">cantidad_nulos_train</span> <span class="o">/</span> <span class="n">df_train_full</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Porcentaje de Nulos por Columna en Train&quot;</span><span class="p">)</span>
<span class="n">porcentaje_nulos_train</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Porcentaje de Nulos por Columna en Train
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;id_24&#39;: 99.2,
 &#39;id_25&#39;: 99.1,
 &#39;id_07&#39;: 99.1,
 &#39;id_08&#39;: 99.1,
 &#39;id_21&#39;: 99.1,
 &#39;id_26&#39;: 99.1,
 &#39;id_27&#39;: 99.1,
 &#39;id_23&#39;: 99.1,
 &#39;id_22&#39;: 99.1,
 &#39;dist2&#39;: 93.6,
 &#39;D7&#39;: 93.4,
 &#39;id_18&#39;: 92.4,
 &#39;D13&#39;: 89.5,
 &#39;D14&#39;: 89.5,
 &#39;D12&#39;: 89.0,
 &#39;id_04&#39;: 88.8,
 &#39;id_03&#39;: 88.8,
 &#39;D6&#39;: 87.6,
 &#39;id_33&#39;: 87.6,
 &#39;id_09&#39;: 87.3,
 &#39;D8&#39;: 87.3,
 &#39;id_10&#39;: 87.3,
 &#39;D9&#39;: 87.3,
 &#39;id_30&#39;: 86.9,
 &#39;id_32&#39;: 86.9,
 &#39;id_34&#39;: 86.8,
 &#39;id_14&#39;: 86.4,
 &#39;V138&#39;: 86.1,
 &#39;V139&#39;: 86.1,
 &#39;V148&#39;: 86.1,
 &#39;V154&#39;: 86.1,
 &#39;V162&#39;: 86.1,
 &#39;V141&#39;: 86.1,
 &#39;V157&#39;: 86.1,
 &#39;V146&#39;: 86.1,
 &#39;V163&#39;: 86.1,
 &#39;V155&#39;: 86.1,
 &#39;V142&#39;: 86.1,
 &#39;V161&#39;: 86.1,
 &#39;V158&#39;: 86.1,
 &#39;V156&#39;: 86.1,
 &#39;V140&#39;: 86.1,
 &#39;V149&#39;: 86.1,
 &#39;V147&#39;: 86.1,
 &#39;V153&#39;: 86.1,
 &#39;V159&#39;: 86.1,
 &#39;V160&#39;: 86.1,
 &#39;V166&#39;: 86.1,
 &#39;V164&#39;: 86.1,
 &#39;V165&#39;: 86.1,
 &#39;V152&#39;: 86.1,
 &#39;V145&#39;: 86.1,
 &#39;V143&#39;: 86.1,
 &#39;V144&#39;: 86.1,
 &#39;V150&#39;: 86.1,
 &#39;V151&#39;: 86.1,
 &#39;V330&#39;: 86.1,
 &#39;V329&#39;: 86.1,
 &#39;V336&#39;: 86.1,
 &#39;V333&#39;: 86.1,
 &#39;V334&#39;: 86.1,
 &#39;V331&#39;: 86.1,
 &#39;V326&#39;: 86.1,
 &#39;V325&#39;: 86.1,
 &#39;V324&#39;: 86.1,
 &#39;V327&#39;: 86.1,
 &#39;V323&#39;: 86.1,
 &#39;V322&#39;: 86.1,
 &#39;V338&#39;: 86.1,
 &#39;V339&#39;: 86.1,
 &#39;V335&#39;: 86.1,
 &#39;V337&#39;: 86.1,
 &#39;V328&#39;: 86.1,
 &#39;V332&#39;: 86.1,
 &#39;DeviceInfo&#39;: 79.9,
 &#39;id_13&#39;: 78.4,
 &#39;id_16&#39;: 78.1,
 &#39;V249&#39;: 77.9,
 &#39;V277&#39;: 77.9,
 &#39;V278&#39;: 77.9,
 &#39;V248&#39;: 77.9,
 &#39;V275&#39;: 77.9,
 &#39;V276&#39;: 77.9,
 &#39;V252&#39;: 77.9,
 &#39;V247&#39;: 77.9,
 &#39;V246&#39;: 77.9,
 &#39;V232&#39;: 77.9,
 &#39;V237&#39;: 77.9,
 &#39;V244&#39;: 77.9,
 &#39;V243&#39;: 77.9,
 &#39;V241&#39;: 77.9,
 &#39;V242&#39;: 77.9,
 &#39;V240&#39;: 77.9,
 &#39;V236&#39;: 77.9,
 &#39;V263&#39;: 77.9,
 &#39;V262&#39;: 77.9,
 &#39;V261&#39;: 77.9,
 &#39;V264&#39;: 77.9,
 &#39;V267&#39;: 77.9,
 &#39;V266&#39;: 77.9,
 &#39;V269&#39;: 77.9,
 &#39;V265&#39;: 77.9,
 &#39;V268&#39;: 77.9,
 &#39;V273&#39;: 77.9,
 &#39;V274&#39;: 77.9,
 &#39;V254&#39;: 77.9,
 &#39;V260&#39;: 77.9,
 &#39;V253&#39;: 77.9,
 &#39;V257&#39;: 77.9,
 &#39;V258&#39;: 77.9,
 &#39;V218&#39;: 77.9,
 &#39;V217&#39;: 77.9,
 &#39;V219&#39;: 77.9,
 &#39;V223&#39;: 77.9,
 &#39;V226&#39;: 77.9,
 &#39;V225&#39;: 77.9,
 &#39;V224&#39;: 77.9,
 &#39;V231&#39;: 77.9,
 &#39;V228&#39;: 77.9,
 &#39;V229&#39;: 77.9,
 &#39;V233&#39;: 77.9,
 &#39;V235&#39;: 77.9,
 &#39;V230&#39;: 77.9,
 &#39;id_05&#39;: 76.8,
 &#39;id_06&#39;: 76.8,
 &#39;R_emaildomain&#39;: 76.8,
 &#39;id_20&#39;: 76.4,
 &#39;id_19&#39;: 76.4,
 &#39;id_17&#39;: 76.4,
 &#39;V213&#39;: 76.4,
 &#39;V215&#39;: 76.4,
 &#39;V214&#39;: 76.4,
 &#39;V206&#39;: 76.4,
 &#39;V183&#39;: 76.4,
 &#39;V168&#39;: 76.4,
 &#39;V173&#39;: 76.4,
 &#39;V181&#39;: 76.4,
 &#39;V212&#39;: 76.4,
 &#39;V211&#39;: 76.4,
 &#39;V205&#39;: 76.4,
 &#39;V207&#39;: 76.4,
 &#39;V216&#39;: 76.4,
 &#39;V167&#39;: 76.4,
 &#39;V182&#39;: 76.4,
 &#39;V193&#39;: 76.4,
 &#39;V192&#39;: 76.4,
 &#39;V187&#39;: 76.4,
 &#39;V204&#39;: 76.4,
 &#39;V202&#39;: 76.4,
 &#39;V203&#39;: 76.4,
 &#39;V199&#39;: 76.4,
 &#39;V196&#39;: 76.4,
 &#39;V186&#39;: 76.4,
 &#39;V179&#39;: 76.4,
 &#39;V177&#39;: 76.4,
 &#39;V178&#39;: 76.4,
 &#39;V176&#39;: 76.4,
 &#39;V172&#39;: 76.4,
 &#39;V191&#39;: 76.4,
 &#39;V190&#39;: 76.4,
 &#39;V175&#39;: 76.3,
 &#39;V209&#39;: 76.3,
 &#39;V208&#39;: 76.3,
 &#39;V169&#39;: 76.3,
 &#39;V180&#39;: 76.3,
 &#39;V174&#39;: 76.3,
 &#39;V184&#39;: 76.3,
 &#39;V185&#39;: 76.3,
 &#39;V189&#39;: 76.3,
 &#39;V171&#39;: 76.3,
 &#39;V170&#39;: 76.3,
 &#39;V200&#39;: 76.3,
 &#39;V201&#39;: 76.3,
 &#39;V210&#39;: 76.3,
 &#39;V197&#39;: 76.3,
 &#39;V198&#39;: 76.3,
 &#39;V194&#39;: 76.3,
 &#39;V188&#39;: 76.3,
 &#39;V195&#39;: 76.3,
 &#39;id_31&#39;: 76.2,
 &#39;DeviceType&#39;: 76.2,
 &#39;id_02&#39;: 76.1,
 &#39;id_28&#39;: 76.1,
 &#39;id_11&#39;: 76.1,
 &#39;id_29&#39;: 76.1,
 &#39;id_15&#39;: 76.1,
 &#39;id_38&#39;: 76.1,
 &#39;id_36&#39;: 76.1,
 &#39;id_35&#39;: 76.1,
 &#39;id_37&#39;: 76.1,
 &#39;V251&#39;: 76.1,
 &#39;V250&#39;: 76.1,
 &#39;V255&#39;: 76.1,
 &#39;V256&#39;: 76.1,
 &#39;V259&#39;: 76.1,
 &#39;V272&#39;: 76.1,
 &#39;V271&#39;: 76.1,
 &#39;V270&#39;: 76.1,
 &#39;V234&#39;: 76.1,
 &#39;V239&#39;: 76.1,
 &#39;V238&#39;: 76.1,
 &#39;V245&#39;: 76.1,
 &#39;V227&#39;: 76.1,
 &#39;V220&#39;: 76.1,
 &#39;V222&#39;: 76.1,
 &#39;V221&#39;: 76.1,
 &#39;id_12&#39;: 75.6,
 &#39;id_01&#39;: 75.6,
 &#39;dist1&#39;: 59.7,
 &#39;M5&#39;: 59.3,
 &#39;M7&#39;: 58.6,
 &#39;M9&#39;: 58.6,
 &#39;M8&#39;: 58.6,
 &#39;D5&#39;: 52.5,
 &#39;M4&#39;: 47.7,
 &#39;D2&#39;: 47.5,
 &#39;V11&#39;: 47.3,
 &#39;V3&#39;: 47.3,
 &#39;V4&#39;: 47.3,
 &#39;V6&#39;: 47.3,
 &#39;V5&#39;: 47.3,
 &#39;V10&#39;: 47.3,
 &#39;V1&#39;: 47.3,
 &#39;V9&#39;: 47.3,
 &#39;V8&#39;: 47.3,
 &#39;V2&#39;: 47.3,
 &#39;V7&#39;: 47.3,
 &#39;D11&#39;: 47.3,
 &#39;M1&#39;: 45.9,
 &#39;M3&#39;: 45.9,
 &#39;M2&#39;: 45.9,
 &#39;D3&#39;: 44.5,
 &#39;M6&#39;: 28.7,
 &#39;V52&#39;: 28.6,
 &#39;V49&#39;: 28.6,
 &#39;V48&#39;: 28.6,
 &#39;V45&#39;: 28.6,
 &#39;V43&#39;: 28.6,
 &#39;V50&#39;: 28.6,
 &#39;V47&#39;: 28.6,
 &#39;V46&#39;: 28.6,
 &#39;V44&#39;: 28.6,
 &#39;V51&#39;: 28.6,
 &#39;V35&#39;: 28.6,
 &#39;V37&#39;: 28.6,
 &#39;V36&#39;: 28.6,
 &#39;V42&#39;: 28.6,
 &#39;V39&#39;: 28.6,
 &#39;V41&#39;: 28.6,
 &#39;V38&#39;: 28.6,
 &#39;V40&#39;: 28.6,
 &#39;D4&#39;: 28.6,
 &#39;P_emaildomain&#39;: 16.0,
 &#39;V81&#39;: 15.1,
 &#39;V90&#39;: 15.1,
 &#39;V78&#39;: 15.1,
 &#39;V75&#39;: 15.1,
 &#39;V82&#39;: 15.1,
 &#39;V94&#39;: 15.1,
 &#39;V83&#39;: 15.1,
 &#39;V84&#39;: 15.1,
 &#39;V85&#39;: 15.1,
 &#39;V86&#39;: 15.1,
 &#39;V92&#39;: 15.1,
 &#39;V93&#39;: 15.1,
 &#39;V77&#39;: 15.1,
 &#39;V87&#39;: 15.1,
 &#39;V76&#39;: 15.1,
 &#39;V79&#39;: 15.1,
 &#39;V80&#39;: 15.1,
 &#39;V91&#39;: 15.1,
 &#39;V89&#39;: 15.1,
 &#39;V88&#39;: 15.1,
 &#39;D15&#39;: 15.1,
 &#39;V67&#39;: 13.1,
 &#39;V68&#39;: 13.1,
 &#39;V71&#39;: 13.1,
 &#39;V70&#39;: 13.1,
 &#39;V69&#39;: 13.1,
 &#39;V60&#39;: 13.1,
 &#39;V59&#39;: 13.1,
 &#39;V66&#39;: 13.1,
 &#39;V74&#39;: 13.1,
 &#39;V65&#39;: 13.1,
 &#39;V63&#39;: 13.1,
 &#39;V62&#39;: 13.1,
 &#39;V61&#39;: 13.1,
 &#39;V64&#39;: 13.1,
 &#39;V72&#39;: 13.1,
 &#39;V73&#39;: 13.1,
 &#39;V54&#39;: 13.1,
 &#39;V56&#39;: 13.1,
 &#39;V58&#39;: 13.1,
 &#39;V55&#39;: 13.1,
 &#39;V53&#39;: 13.1,
 &#39;V57&#39;: 13.1,
 &#39;V22&#39;: 12.9,
 &#39;V20&#39;: 12.9,
 &#39;V21&#39;: 12.9,
 &#39;V27&#39;: 12.9,
 &#39;V28&#39;: 12.9,
 &#39;V29&#39;: 12.9,
 &#39;V32&#39;: 12.9,
 &#39;V31&#39;: 12.9,
 &#39;V19&#39;: 12.9,
 &#39;V18&#39;: 12.9,
 &#39;V25&#39;: 12.9,
 &#39;V24&#39;: 12.9,
 &#39;V23&#39;: 12.9,
 &#39;V26&#39;: 12.9,
 &#39;V14&#39;: 12.9,
 &#39;V15&#39;: 12.9,
 &#39;V16&#39;: 12.9,
 &#39;V30&#39;: 12.9,
 &#39;V33&#39;: 12.9,
 &#39;V34&#39;: 12.9,
 &#39;V12&#39;: 12.9,
 &#39;V13&#39;: 12.9,
 &#39;V17&#39;: 12.9,
 &#39;D10&#39;: 12.9,
 &#39;addr2&#39;: 11.1,
 &#39;addr1&#39;: 11.1,
 &#39;card2&#39;: 1.5,
 &#39;card5&#39;: 0.7,
 &#39;card4&#39;: 0.3,
 &#39;card6&#39;: 0.3,
 &#39;card3&#39;: 0.3,
 &#39;V282&#39;: 0.2,
 &#39;V281&#39;: 0.2,
 &#39;V283&#39;: 0.2,
 &#39;V289&#39;: 0.2,
 &#39;V288&#39;: 0.2,
 &#39;V301&#39;: 0.2,
 &#39;V296&#39;: 0.2,
 &#39;V314&#39;: 0.2,
 &#39;V315&#39;: 0.2,
 &#39;V313&#39;: 0.2,
 &#39;V300&#39;: 0.2,
 &#39;D1&#39;: 0.2,
 &#39;V107&#39;: 0.1,
 &#39;V108&#39;: 0.1,
 &#39;V109&#39;: 0.1,
 &#39;V133&#39;: 0.1,
 &#39;V130&#39;: 0.1,
 &#39;V131&#39;: 0.1,
 &#39;V132&#39;: 0.1,
 &#39;V137&#39;: 0.1,
 &#39;V125&#39;: 0.1,
 &#39;V123&#39;: 0.1,
 &#39;V124&#39;: 0.1,
 &#39;V127&#39;: 0.1,
 &#39;V126&#39;: 0.1,
 &#39;V128&#39;: 0.1,
 &#39;V129&#39;: 0.1,
 &#39;V110&#39;: 0.1,
 &#39;V100&#39;: 0.1,
 &#39;V99&#39;: 0.1,
 &#39;V102&#39;: 0.1,
 &#39;V106&#39;: 0.1,
 &#39;V134&#39;: 0.1,
 &#39;V135&#39;: 0.1,
 &#39;V136&#39;: 0.1,
 &#39;V112&#39;: 0.1,
 &#39;V111&#39;: 0.1,
 &#39;V113&#39;: 0.1,
 &#39;V121&#39;: 0.1,
 &#39;V114&#39;: 0.1,
 &#39;V115&#39;: 0.1,
 &#39;V116&#39;: 0.1,
 &#39;V117&#39;: 0.1,
 &#39;V101&#39;: 0.1,
 &#39;V104&#39;: 0.1,
 &#39;V103&#39;: 0.1,
 &#39;V122&#39;: 0.1,
 &#39;V118&#39;: 0.1,
 &#39;V97&#39;: 0.1,
 &#39;V95&#39;: 0.1,
 &#39;V96&#39;: 0.1,
 &#39;V105&#39;: 0.1,
 &#39;V119&#39;: 0.1,
 &#39;V120&#39;: 0.1,
 &#39;V98&#39;: 0.1,
 &#39;V306&#39;: 0.0,
 &#39;V320&#39;: 0.0,
 &#39;V319&#39;: 0.0,
 &#39;V318&#39;: 0.0,
 &#39;V321&#39;: 0.0,
 &#39;V298&#39;: 0.0,
 &#39;V295&#39;: 0.0,
 &#39;V299&#39;: 0.0,
 &#39;V294&#39;: 0.0,
 &#39;V291&#39;: 0.0,
 &#39;V292&#39;: 0.0,
 &#39;V297&#39;: 0.0,
 &#39;V286&#39;: 0.0,
 &#39;V287&#39;: 0.0,
 &#39;V290&#39;: 0.0,
 &#39;V285&#39;: 0.0,
 &#39;V280&#39;: 0.0,
 &#39;V279&#39;: 0.0,
 &#39;V284&#39;: 0.0,
 &#39;V293&#39;: 0.0,
 &#39;V302&#39;: 0.0,
 &#39;V308&#39;: 0.0,
 &#39;V307&#39;: 0.0,
 &#39;V310&#39;: 0.0,
 &#39;V312&#39;: 0.0,
 &#39;V303&#39;: 0.0,
 &#39;V304&#39;: 0.0,
 &#39;V305&#39;: 0.0,
 &#39;V309&#39;: 0.0,
 &#39;V311&#39;: 0.0,
 &#39;V316&#39;: 0.0,
 &#39;V317&#39;: 0.0,
 &#39;card1&#39;: 0.0,
 &#39;TransactionAmt&#39;: 0.0,
 &#39;TransactionDT&#39;: 0.0,
 &#39;isFraud&#39;: 0.0,
 &#39;ProductCD&#39;: 0.0,
 &#39;C1&#39;: 0.0,
 &#39;C2&#39;: 0.0,
 &#39;C3&#39;: 0.0,
 &#39;C7&#39;: 0.0,
 &#39;C4&#39;: 0.0,
 &#39;C5&#39;: 0.0,
 &#39;C6&#39;: 0.0,
 &#39;C10&#39;: 0.0,
 &#39;C9&#39;: 0.0,
 &#39;C8&#39;: 0.0,
 &#39;C11&#39;: 0.0,
 &#39;C14&#39;: 0.0,
 &#39;C13&#39;: 0.0,
 &#39;C12&#39;: 0.0,
 &#39;TransactionID&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cantidad de columnas con algun nulo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">porcentaje_nulos_train</span><span class="p">[</span><span class="n">porcentaje_nulos_train</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cantidad de columnas sin nulos&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">porcentaje_nulos_train</span><span class="p">[</span><span class="n">porcentaje_nulos_train</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cantidad de columnas con algun nulo
(382,)
Cantidad de columnas sin nulos
(52,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_full_descripcion</span> <span class="o">=</span> <span class="n">df_train_full</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">df_train_full_descripcion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e468ca07-c0c4-4bde-ae8f-df1f06f0652a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>...</th>
      <th>id_17</th>
      <th>id_18</th>
      <th>id_19</th>
      <th>id_20</th>
      <th>id_21</th>
      <th>id_22</th>
      <th>id_24</th>
      <th>id_25</th>
      <th>id_26</th>
      <th>id_32</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.905400e+05</td>
      <td>590540.000000</td>
      <td>5.905400e+05</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>581607.000000</td>
      <td>588975.000000</td>
      <td>586281.000000</td>
      <td>524834.000000</td>
      <td>524834.000000</td>
      <td>...</td>
      <td>139369.000000</td>
      <td>45113.000000</td>
      <td>139318.000000</td>
      <td>139261.000000</td>
      <td>5159.000000</td>
      <td>5169.000000</td>
      <td>4747.000000</td>
      <td>5132.000000</td>
      <td>5163.000000</td>
      <td>77586.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.282270e+06</td>
      <td>0.034990</td>
      <td>7.372311e+06</td>
      <td>135.027176</td>
      <td>9898.734658</td>
      <td>362.555488</td>
      <td>153.194925</td>
      <td>199.278897</td>
      <td>290.733794</td>
      <td>86.800630</td>
      <td>...</td>
      <td>189.451377</td>
      <td>14.237337</td>
      <td>353.128174</td>
      <td>403.882666</td>
      <td>368.269820</td>
      <td>16.002708</td>
      <td>12.800927</td>
      <td>329.608924</td>
      <td>149.070308</td>
      <td>26.508597</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.704744e+05</td>
      <td>0.183755</td>
      <td>4.617224e+06</td>
      <td>239.162522</td>
      <td>4901.170153</td>
      <td>157.793246</td>
      <td>11.336444</td>
      <td>41.244453</td>
      <td>101.741072</td>
      <td>2.690623</td>
      <td>...</td>
      <td>30.375360</td>
      <td>1.561302</td>
      <td>141.095343</td>
      <td>152.160327</td>
      <td>198.847038</td>
      <td>6.897665</td>
      <td>2.372447</td>
      <td>97.461089</td>
      <td>32.101995</td>
      <td>3.737502</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.987000e+06</td>
      <td>0.000000</td>
      <td>8.640000e+04</td>
      <td>0.251000</td>
      <td>1000.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>10.000000</td>
      <td>...</td>
      <td>100.000000</td>
      <td>10.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>10.000000</td>
      <td>11.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.134635e+06</td>
      <td>0.000000</td>
      <td>3.027058e+06</td>
      <td>43.321000</td>
      <td>6019.000000</td>
      <td>214.000000</td>
      <td>150.000000</td>
      <td>166.000000</td>
      <td>204.000000</td>
      <td>87.000000</td>
      <td>...</td>
      <td>166.000000</td>
      <td>13.000000</td>
      <td>266.000000</td>
      <td>256.000000</td>
      <td>252.000000</td>
      <td>14.000000</td>
      <td>11.000000</td>
      <td>321.000000</td>
      <td>119.000000</td>
      <td>24.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.282270e+06</td>
      <td>0.000000</td>
      <td>7.306528e+06</td>
      <td>68.769000</td>
      <td>9678.000000</td>
      <td>361.000000</td>
      <td>150.000000</td>
      <td>226.000000</td>
      <td>299.000000</td>
      <td>87.000000</td>
      <td>...</td>
      <td>166.000000</td>
      <td>15.000000</td>
      <td>341.000000</td>
      <td>472.000000</td>
      <td>252.000000</td>
      <td>14.000000</td>
      <td>11.000000</td>
      <td>321.000000</td>
      <td>149.000000</td>
      <td>24.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.429904e+06</td>
      <td>0.000000</td>
      <td>1.124662e+07</td>
      <td>125.000000</td>
      <td>14184.000000</td>
      <td>512.000000</td>
      <td>150.000000</td>
      <td>226.000000</td>
      <td>330.000000</td>
      <td>87.000000</td>
      <td>...</td>
      <td>225.000000</td>
      <td>15.000000</td>
      <td>427.000000</td>
      <td>533.000000</td>
      <td>486.500000</td>
      <td>14.000000</td>
      <td>15.000000</td>
      <td>371.000000</td>
      <td>169.000000</td>
      <td>32.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.577539e+06</td>
      <td>1.000000</td>
      <td>1.581113e+07</td>
      <td>31937.391000</td>
      <td>18396.000000</td>
      <td>600.000000</td>
      <td>231.000000</td>
      <td>237.000000</td>
      <td>540.000000</td>
      <td>102.000000</td>
      <td>...</td>
      <td>229.000000</td>
      <td>29.000000</td>
      <td>671.000000</td>
      <td>661.000000</td>
      <td>854.000000</td>
      <td>44.000000</td>
      <td>26.000000</td>
      <td>548.000000</td>
      <td>216.000000</td>
      <td>32.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 403 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e468ca07-c0c4-4bde-ae8f-df1f06f0652a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e468ca07-c0c4-4bde-ae8f-df1f06f0652a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e468ca07-c0c4-4bde-ae8f-df1f06f0652a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d37b352d-93c2-491e-b724-5d2dda58c3ee">
  <button class="colab-df-quickchart" onclick="quickchart('df-d37b352d-93c2-491e-b724-5d2dda58c3ee')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d37b352d-93c2-491e-b724-5d2dda58c3ee button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_62ef5b55-8772-4d9c-b51c-4e9a8ac9622f">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_train_full_descripcion')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_62ef5b55-8772-4d9c-b51c-4e9a8ac9622f button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_train_full_descripcion');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<ul class="simple">
<li><p>El valor de <code class="docutils literal notranslate"><span class="pre">isFraud</span></code> es claramente bajo, reflejando un fuerte desbalance de clases. Esto es común en datasets de fraude, ya que los casos fraudulentos son escasos en comparación con las transacciones legítimas. Por ejemplo, en la columna <code class="docutils literal notranslate"><span class="pre">isFraud</span></code>, la media es cercana a cero, lo que indica que la mayoría de las transacciones no son fraudulentas.</p></li>
<li><p>Muchas variables tienen valores centralizados alrededor de promedios representativos, aunque también se observan <em>outliers</em> y distribuciones altamente variables. Por ejemplo, <code class="docutils literal notranslate"><span class="pre">TransactionAmt</span></code> tiene un rango amplio de valores, con una media moderada y una desviación estándar elevada, lo que sugiere la presencia de algunas transacciones con montos muy altos o muy bajos.</p></li>
<li><p>Varias columnas contienen valores anonimizados cuyo significado específico no puede ser interpretado sin información adicional, pero su comportamiento estadístico revela que capturan patrones significativos. Por ejemplo, columnas como <code class="docutils literal notranslate"><span class="pre">card1</span></code>, <code class="docutils literal notranslate"><span class="pre">card2</span></code>, <code class="docutils literal notranslate"><span class="pre">addr1</span></code> y <code class="docutils literal notranslate"><span class="pre">addr2</span></code> presentan medias y desviaciones estándar que indican variabilidad útil para la detección de patrones, a pesar de no conocer su significado exacto.</p></li>
<li><p>Algunas columnas presentan valores constantes o con muy poca variación, lo que podría indicar que son poco informativas y candidatas para ser eliminadas en el preprocesamiento. Un ejemplo de esto son columnas como <code class="docutils literal notranslate"><span class="pre">id_20</span></code>, <code class="docutils literal notranslate"><span class="pre">id_25</span></code> o <code class="docutils literal notranslate"><span class="pre">M4</span></code>, donde el mínimo, el máximo y la desviación estándar son muy cercanos, sugiriendo baja diversidad de valores.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1.4. Seleccion de variables independientes</span>
<span class="n">fraude_variables_independientes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;card4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DeviceType&quot;</span><span class="p">,</span>
    <span class="s2">&quot;D9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;M1&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">fraude_variables_independientes</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">df_train_full</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Diagrama de Barras para la variable   &#39;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label_type</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/60a0f05d4486b257aa9bdcb97bcf0d3bd724055ec370fd8445a23d4f939ce8bb.png" src="_images/60a0f05d4486b257aa9bdcb97bcf0d3bd724055ec370fd8445a23d4f939ce8bb.png" />
<img alt="_images/748832c06b618c316537c4dafa6b7b827700e9d0764612e0dd26de9d657e795e.png" src="_images/748832c06b618c316537c4dafa6b7b827700e9d0764612e0dd26de9d657e795e.png" />
<img alt="_images/a6c2bf7d294a63cf8342972240c652f7188359c87bb024e1537c1ad338143b20.png" src="_images/a6c2bf7d294a63cf8342972240c652f7188359c87bb024e1537c1ad338143b20.png" />
<img alt="_images/93cde66b6a406cd2b381e180dd072e1f6eb871509481f2b091af61d7a9bcf95f.png" src="_images/93cde66b6a406cd2b381e180dd072e1f6eb871509481f2b091af61d7a9bcf95f.png" />
</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">card4</span></code>:</p>
<ul class="simple">
<li><p>La mayoria de transacciones fueron realizadas desde una tarjeta Visa y en menor medida una tarjeta Discover</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">DeviceType</span></code>:</p>
<ul class="simple">
<li><p>Existen dos dispositivos sobre lo que se hicieron las transaciones y son Mobile y Desktop, siendo esta ultima la que mayor representa las transacciones y luego Mobile.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">D9</span></code>:</p>
<ul class="simple">
<li><p>Para esta variable, se observa que el valor ~0.79 es el valor mas repetido y aquellos cercanos a el (desde ~0.66 hasta ~0.95) y los valores ceranos al ~0.375 son los valores menor frecuencia.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">M1</span></code>:</p>
<ul class="simple">
<li><p>Para la variable M1, solo existe la categoria T y F, donde T es la que presenta por mucho la mayor frecuencia de datos, y F solo tiene 25 observaciones.</p></li>
</ul>
</li>
</ol>
</section>
<section id="limpieza-y-preparacion">
<h3>1.3. Limpieza y Preparación<a class="headerlink" href="#limpieza-y-preparacion" title="Link to this heading">#</a></h3>
</section>
<section id="tratamiento-de-nulos">
<h3>1.3.1. Tratamiento de Nulos<a class="headerlink" href="#tratamiento-de-nulos" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hay varias columnas que tienen demasiadas categorias como para ser consideradas</span>
<span class="c1"># para un Encoder, por lo que se eliminaran</span>

<span class="n">variables_a_eliminar</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;TransactionID&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id_30&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id_31&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id_33&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DeviceInfo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;P_emaildomain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;R_emaildomain&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">df_train_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">variables_a_eliminar</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_test_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">variables_a_eliminar</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad_nulos_train</span> <span class="o">=</span> <span class="n">df_train_full</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">porcentaje_nulos_train</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">cantidad_nulos_train</span> <span class="o">/</span> <span class="n">df_train_full</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_porc_nulos_50_train</span> <span class="o">=</span> <span class="n">porcentaje_nulos_train</span><span class="p">[</span><span class="n">porcentaje_nulos_train</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">porcentaje_nulos_train</span><span class="p">[</span><span class="n">porcentaje_nulos_train</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_24</th>
      <td>99.2</td>
    </tr>
    <tr>
      <th>id_25</th>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_07</th>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_08</th>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_21</th>
      <td>99.1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>V11</th>
      <td>47.3</td>
    </tr>
    <tr>
      <th>M2</th>
      <td>45.9</td>
    </tr>
    <tr>
      <th>M3</th>
      <td>45.9</td>
    </tr>
    <tr>
      <th>M1</th>
      <td>45.9</td>
    </tr>
    <tr>
      <th>D3</th>
      <td>44.5</td>
    </tr>
  </tbody>
</table>
<p>227 rows × 1 columns</p>
</div><br><label><b>dtype:</b> float64</label></div></div>
</div>
<p>Existen 227 columnas que tienen un porcentaje de nulos de mas de 30% y varias de ellas llegan hasta 99%, por lo que todas estas columnas serán eliminadas ya que no vale la pena su procesamiento y utilizacion en los modelos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columnas_porc_nulos_50_train</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_test_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columnas_porc_nulos_50_train</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Para imputar valores respecto a los nulos, de acuerdo al diccionario de datos muchas de las columnas corresponden a identificadores, no mediciones, por lo que se eligira la Moda como la medida de imputacion para todas las columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">columna</span> <span class="ow">in</span> <span class="n">df_train_full</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df_train_full</span><span class="p">[</span><span class="n">columna</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>  <span class="c1"># Verificar si hay nulos en la columna</span>
        <span class="n">moda</span> <span class="o">=</span> <span class="n">df_train_full</span><span class="p">[</span><span class="n">columna</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moda para columna  </span><span class="si">{</span><span class="n">columna</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">moda</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
        <span class="n">df_train_full</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="n">columna</span><span class="p">:</span> <span class="n">moda</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">df_test_full</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="n">columna</span><span class="p">:</span> <span class="n">moda</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Moda para columna  card2 : 321.0 
Moda para columna  card3 : 150.0 
Moda para columna  card4 : visa 
Moda para columna  card5 : 226.0 
Moda para columna  card6 : debit 
Moda para columna  addr1 : 299.0 
Moda para columna  addr2 : 87.0 
Moda para columna  D1 : 0.0 
Moda para columna  D4 : 0.0 
Moda para columna  D10 : 0.0 
Moda para columna  D15 : 0.0 
Moda para columna  M6 : F 
Moda para columna  V12 : 1.0 
Moda para columna  V13 : 1.0 
Moda para columna  V14 : 1.0 
Moda para columna  V15 : 0.0 
Moda para columna  V16 : 0.0 
Moda para columna  V17 : 0.0 
Moda para columna  V18 : 0.0 
Moda para columna  V19 : 1.0 
Moda para columna  V20 : 1.0 
Moda para columna  V21 : 0.0 
Moda para columna  V22 : 0.0 
Moda para columna  V23 : 1.0 
Moda para columna  V24 : 1.0 
Moda para columna  V25 : 1.0 
Moda para columna  V26 : 1.0 
Moda para columna  V27 : 0.0 
Moda para columna  V28 : 0.0 
Moda para columna  V29 : 0.0 
Moda para columna  V30 : 0.0 
Moda para columna  V31 : 0.0 
Moda para columna  V32 : 0.0 
Moda para columna  V33 : 0.0 
Moda para columna  V34 : 0.0 
Moda para columna  V35 : 1.0 
Moda para columna  V36 : 1.0 
Moda para columna  V37 : 1.0 
Moda para columna  V38 : 1.0 
Moda para columna  V39 : 0.0 
Moda para columna  V40 : 0.0 
Moda para columna  V41 : 1.0 
Moda para columna  V42 : 0.0 
Moda para columna  V43 : 0.0 
Moda para columna  V44 : 1.0 
Moda para columna  V45 : 1.0 
Moda para columna  V46 : 1.0 
Moda para columna  V47 : 1.0 
Moda para columna  V48 : 0.0 
Moda para columna  V49 : 0.0 
Moda para columna  V50 : 0.0 
Moda para columna  V51 : 0.0 
Moda para columna  V52 : 0.0 
Moda para columna  V53 : 1.0 
Moda para columna  V54 : 1.0 
Moda para columna  V55 : 1.0 
Moda para columna  V56 : 1.0 
Moda para columna  V57 : 0.0 
Moda para columna  V58 : 0.0 
Moda para columna  V59 : 0.0 
Moda para columna  V60 : 0.0 
Moda para columna  V61 : 1.0 
Moda para columna  V62 : 1.0 
Moda para columna  V63 : 0.0 
Moda para columna  V64 : 0.0 
Moda para columna  V65 : 1.0 
Moda para columna  V66 : 1.0 
Moda para columna  V67 : 1.0 
Moda para columna  V68 : 0.0 
Moda para columna  V69 : 0.0 
Moda para columna  V70 : 0.0 
Moda para columna  V71 : 0.0 
Moda para columna  V72 : 0.0 
Moda para columna  V73 : 0.0 
Moda para columna  V74 : 0.0 
Moda para columna  V75 : 1.0 
Moda para columna  V76 : 1.0 
Moda para columna  V77 : 1.0 
Moda para columna  V78 : 1.0 
Moda para columna  V79 : 0.0 
Moda para columna  V80 : 0.0 
Moda para columna  V81 : 0.0 
Moda para columna  V82 : 1.0 
Moda para columna  V83 : 1.0 
Moda para columna  V84 : 0.0 
Moda para columna  V85 : 0.0 
Moda para columna  V86 : 1.0 
Moda para columna  V87 : 1.0 
Moda para columna  V88 : 1.0 
Moda para columna  V89 : 0.0 
Moda para columna  V90 : 0.0 
Moda para columna  V91 : 0.0 
Moda para columna  V92 : 0.0 
Moda para columna  V93 : 0.0 
Moda para columna  V94 : 0.0 
Moda para columna  V95 : 0.0 
Moda para columna  V96 : 0.0 
Moda para columna  V97 : 0.0 
Moda para columna  V98 : 0.0 
Moda para columna  V99 : 0.0 
Moda para columna  V100 : 0.0 
Moda para columna  V101 : 0.0 
Moda para columna  V102 : 0.0 
Moda para columna  V103 : 0.0 
Moda para columna  V104 : 0.0 
Moda para columna  V105 : 0.0 
Moda para columna  V106 : 0.0 
Moda para columna  V107 : 1.0 
Moda para columna  V108 : 1.0 
Moda para columna  V109 : 1.0 
Moda para columna  V110 : 1.0 
Moda para columna  V111 : 1.0 
Moda para columna  V112 : 1.0 
Moda para columna  V113 : 1.0 
Moda para columna  V114 : 1.0 
Moda para columna  V115 : 1.0 
Moda para columna  V116 : 1.0 
Moda para columna  V117 : 1.0 
Moda para columna  V118 : 1.0 
Moda para columna  V119 : 1.0 
Moda para columna  V120 : 1.0 
Moda para columna  V121 : 1.0 
Moda para columna  V122 : 1.0 
Moda para columna  V123 : 1.0 
Moda para columna  V124 : 1.0 
Moda para columna  V125 : 1.0 
Moda para columna  V126 : 0.0 
Moda para columna  V127 : 0.0 
Moda para columna  V128 : 0.0 
Moda para columna  V129 : 0.0 
Moda para columna  V130 : 0.0 
Moda para columna  V131 : 0.0 
Moda para columna  V132 : 0.0 
Moda para columna  V133 : 0.0 
Moda para columna  V134 : 0.0 
Moda para columna  V135 : 0.0 
Moda para columna  V136 : 0.0 
Moda para columna  V137 : 0.0 
Moda para columna  V279 : 0.0 
Moda para columna  V280 : 0.0 
Moda para columna  V281 : 0.0 
Moda para columna  V282 : 1.0 
Moda para columna  V283 : 1.0 
Moda para columna  V284 : 0.0 
Moda para columna  V285 : 0.0 
Moda para columna  V286 : 0.0 
Moda para columna  V287 : 0.0 
Moda para columna  V288 : 0.0 
Moda para columna  V289 : 0.0 
Moda para columna  V290 : 1.0 
Moda para columna  V291 : 1.0 
Moda para columna  V292 : 1.0 
Moda para columna  V293 : 0.0 
Moda para columna  V294 : 0.0 
Moda para columna  V295 : 0.0 
Moda para columna  V296 : 0.0 
Moda para columna  V297 : 0.0 
Moda para columna  V298 : 0.0 
Moda para columna  V299 : 0.0 
Moda para columna  V300 : 0.0 
Moda para columna  V301 : 0.0 
Moda para columna  V302 : 0.0 
Moda para columna  V303 : 0.0 
Moda para columna  V304 : 0.0 
Moda para columna  V305 : 1.0 
Moda para columna  V306 : 0.0 
Moda para columna  V307 : 0.0 
Moda para columna  V308 : 0.0 
Moda para columna  V309 : 0.0 
Moda para columna  V310 : 0.0 
Moda para columna  V311 : 0.0 
Moda para columna  V312 : 0.0 
Moda para columna  V313 : 0.0 
Moda para columna  V314 : 0.0 
Moda para columna  V315 : 0.0 
Moda para columna  V316 : 0.0 
Moda para columna  V317 : 0.0 
Moda para columna  V318 : 0.0 
Moda para columna  V319 : 0.0 
Moda para columna  V320 : 0.0 
Moda para columna  V321 : 0.0 
</pre></div>
</div>
</div>
</div>
</section>
<section id="reduccion-de-dimencionalidad-con-chi2">
<h3>1.3.2. Reduccion de Dimencionalidad con Chi2<a class="headerlink" href="#reduccion-de-dimencionalidad-con-chi2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_categoricas</span> <span class="o">=</span> <span class="n">df_train_full</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span>
<span class="n">df_categoricas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-bb239e3b-d7d8-43b4-99da-73ed09d0c241" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ProductCD</th>
      <th>card4</th>
      <th>card6</th>
      <th>M6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>W</td>
      <td>discover</td>
      <td>credit</td>
      <td>T</td>
    </tr>
    <tr>
      <th>1</th>
      <td>W</td>
      <td>mastercard</td>
      <td>credit</td>
      <td>T</td>
    </tr>
    <tr>
      <th>2</th>
      <td>W</td>
      <td>visa</td>
      <td>debit</td>
      <td>F</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W</td>
      <td>mastercard</td>
      <td>debit</td>
      <td>F</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>mastercard</td>
      <td>credit</td>
      <td>F</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>W</td>
      <td>visa</td>
      <td>debit</td>
      <td>F</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>W</td>
      <td>mastercard</td>
      <td>debit</td>
      <td>T</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>W</td>
      <td>mastercard</td>
      <td>debit</td>
      <td>T</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>W</td>
      <td>mastercard</td>
      <td>debit</td>
      <td>T</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>W</td>
      <td>mastercard</td>
      <td>credit</td>
      <td>T</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bb239e3b-d7d8-43b4-99da-73ed09d0c241')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bb239e3b-d7d8-43b4-99da-73ed09d0c241 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bb239e3b-d7d8-43b4-99da-73ed09d0c241');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a69ed9a2-30a0-424a-ba4a-232bf4f72cb0">
  <button class="colab-df-quickchart" onclick="quickchart('df-a69ed9a2-30a0-424a-ba4a-232bf4f72cb0')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a69ed9a2-30a0-424a-ba4a-232bf4f72cb0 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_bd93ffb7-e0ba-4c3b-9f29-71e58a1a6006">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_categoricas')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_bd93ffb7-e0ba-4c3b-9f29-71e58a1a6006 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_categoricas');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calcular_p_valores</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">columnas</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">p_valores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">columnas</span><span class="p">))),</span>
                    <span class="n">columns</span><span class="o">=</span><span class="n">columnas</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">columnas</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">columnas</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">tabla_contingencia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col1</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">col2</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">tabla_contingencia</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># En caso de error</span>
        <span class="n">p_valores</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
        <span class="n">p_valores</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">col2</span><span class="p">,</span> <span class="n">col1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>

    <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">p_valores</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Ignorar diagonal</span>
    <span class="k">return</span> <span class="n">p_valores</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_valores</span> <span class="o">=</span> <span class="n">calcular_p_valores</span><span class="p">(</span><span class="n">df_categoricas</span><span class="p">)</span>
<span class="n">significativos</span> <span class="o">=</span> <span class="n">p_valores</span> <span class="o">&lt;</span> <span class="mf">0.05</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valores P de la prueba de Chi2&quot;</span><span class="p">)</span>
<span class="n">p_valores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valores P de la prueba de Chi2
</pre></div>
</div>
<div class="output text_html">
  <div id="df-4ff03ef3-8821-499c-9ef5-e696a5e228e5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ProductCD</th>
      <th>card4</th>
      <th>card6</th>
      <th>M6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ProductCD</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>card4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>card6</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>M6</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4ff03ef3-8821-499c-9ef5-e696a5e228e5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4ff03ef3-8821-499c-9ef5-e696a5e228e5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4ff03ef3-8821-499c-9ef5-e696a5e228e5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e7aab5f1-47a9-4da4-a83a-ca5792a2a0ab">
  <button class="colab-df-quickchart" onclick="quickchart('df-e7aab5f1-47a9-4da4-a83a-ca5792a2a0ab')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e7aab5f1-47a9-4da4-a83a-ca5792a2a0ab button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_fddf2e7e-b24d-4018-a4c4-73579b5cb193">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('p_valores')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_fddf2e7e-b24d-4018-a4c4-73579b5cb193 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('p_valores');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Significativos en la prueba de Chi2&quot;</span><span class="p">)</span>
<span class="n">significativos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Significativos en la prueba de Chi2
</pre></div>
</div>
<div class="output text_html">
  <div id="df-288b6434-89f9-4f46-9907-b54f1e89b748" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ProductCD</th>
      <th>card4</th>
      <th>card6</th>
      <th>M6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ProductCD</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>card4</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>card6</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>M6</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-288b6434-89f9-4f46-9907-b54f1e89b748')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-288b6434-89f9-4f46-9907-b54f1e89b748 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-288b6434-89f9-4f46-9907-b54f1e89b748');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8af3e473-f28c-4c1b-a2c8-72508e2c5c44">
  <button class="colab-df-quickchart" onclick="quickchart('df-8af3e473-f28c-4c1b-a2c8-72508e2c5c44')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8af3e473-f28c-4c1b-a2c8-72508e2c5c44 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_8313fd22-0cdd-407d-b3af-724b329d5e5c">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('significativos')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_8313fd22-0cdd-407d-b3af-724b329d5e5c button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('significativos');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_restantes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_categoricas</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">columnas_a_eliminar</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columnas categoricas restantes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas_restantes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Contar correlaciones por columna</span>
    <span class="n">contador</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnas_restantes</span><span class="p">:</span>
        <span class="n">otras</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columnas_restantes</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">col</span><span class="p">]</span>
        <span class="n">contador</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">significativos</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">otras</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">max_correlaciones</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">contador</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_correlaciones</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>  <span class="c1"># No hay más correlaciones</span>

    <span class="c1"># Eliminar la columna con más correlaciones</span>
    <span class="n">columna_eliminar</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">contador</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="n">max_correlaciones</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">columnas_a_eliminar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">columna_eliminar</span><span class="p">)</span>
    <span class="n">columnas_restantes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">columna_eliminar</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Columnas categoricas que se quedan </span><span class="si">{</span><span class="n">columnas_restantes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Columnas categoricas que se eliminan </span><span class="si">{</span><span class="n">columnas_a_eliminar</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">df_test_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columnas_a_eliminar</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_train_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columnas_a_eliminar</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas categoricas restantes: 4
Columnas categoricas restantes: 3
Columnas categoricas restantes: 2
Columnas categoricas restantes: 1


Columnas categoricas que se quedan [&#39;M6&#39;]


Columnas categoricas que se eliminan [&#39;ProductCD&#39;, &#39;card4&#39;, &#39;card6&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="reduccion-de-dimensionalidad-con-vif">
<h3>1.3.3. Reduccion de dimensionalidad con VIF<a class="headerlink" href="#reduccion-de-dimensionalidad-con-vif" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numerico</span> <span class="o">=</span> <span class="n">df_train_full</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;float64&quot;</span><span class="p">,</span> <span class="s2">&quot;int64&quot;</span><span class="p">])</span>
<span class="n">df_numerico</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-3bb0cb01-42f6-4ac6-9fea-f5825927922c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>C1</th>
      <th>...</th>
      <th>V312</th>
      <th>V313</th>
      <th>V314</th>
      <th>V315</th>
      <th>V316</th>
      <th>V317</th>
      <th>V318</th>
      <th>V319</th>
      <th>V320</th>
      <th>V321</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>86400</td>
      <td>68.50</td>
      <td>13926</td>
      <td>321.0</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>117.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>86401</td>
      <td>29.00</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>86469</td>
      <td>59.00</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>86499</td>
      <td>50.00</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>135.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>50.0</td>
      <td>1404.0</td>
      <td>790.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>86506</td>
      <td>50.00</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>0</td>
      <td>15811047</td>
      <td>49.00</td>
      <td>6550</td>
      <td>321.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>272.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>47.950001</td>
      <td>47.950001</td>
      <td>47.950001</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>0</td>
      <td>15811049</td>
      <td>39.50</td>
      <td>10444</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>204.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>0</td>
      <td>15811079</td>
      <td>30.95</td>
      <td>12037</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>231.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>0</td>
      <td>15811088</td>
      <td>117.00</td>
      <td>7826</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>387.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>117.0</td>
      <td>317.500000</td>
      <td>669.500000</td>
      <td>317.500000</td>
      <td>0.0</td>
      <td>2234.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>0</td>
      <td>15811131</td>
      <td>279.95</td>
      <td>15066</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>279.950012</td>
      <td>279.950012</td>
      <td>279.950012</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 196 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3bb0cb01-42f6-4ac6-9fea-f5825927922c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3bb0cb01-42f6-4ac6-9fea-f5825927922c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3bb0cb01-42f6-4ac6-9fea-f5825927922c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3b88973e-aa8e-4d80-a1cd-0b52af5eb9cd">
  <button class="colab-df-quickchart" onclick="quickchart('df-3b88973e-aa8e-4d80-a1cd-0b52af5eb9cd')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3b88973e-aa8e-4d80-a1cd-0b52af5eb9cd button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_1aef6606-6620-4179-9fac-95fca74980a1">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_numerico')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_1aef6606-6620-4179-9fac-95fca74980a1 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_numerico');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<p>Debido a las caracteristicas de Google Colab de que no es posible ejecutar un algoritmo por mas de 1 hora sin que se desconecte la instancia, la eliminacion de los VIF se hizo paulativamente y se fue anotando cuales eran las variables eliminadas para que al momento de volver a ejecutar el codigo, estas se eliminaran del dataframe antes de continuar con el procedimiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Columna eliminada &#39;V97&#39; con VIF: 6385753.148413811</span>
<span class="c1"># Columna eliminada &#39;V96&#39; con VIF: 2980581.4650588417</span>
<span class="c1"># Columna eliminada &#39;V280&#39; con VIF: 946847.5605745484</span>
<span class="c1"># Columna eliminada &#39;V308&#39; con VIF: 680987.9367579839</span>
<span class="c1"># Columna eliminada &#39;V95&#39; con VIF: 413564.33749025664</span>
<span class="c1"># Columna eliminada &#39;V307&#39; con VIF: 290090.80968394416</span>
<span class="c1"># Columna eliminada &#39;V126&#39; con VIF: 131630.34998746112</span>
<span class="c1"># Columna eliminada &#39;V279&#39; con VIF: 99568.92630256433</span>
<span class="c1"># Columna eliminada &#39;V127&#39; con VIF: 23906.13163455604</span>
<span class="c1"># Columna eliminada &#39;V134&#39; con VIF: 7167.980093190434</span>
<span class="c1"># Columna eliminada &#39;C12&#39; con VIF: 4610.0395266698415</span>
<span class="c1"># Columna eliminada &#39;V103&#39; con VIF: 4096.66280755667</span>
<span class="c1"># Columna eliminada &#39;V316&#39; con VIF: 2488.745555478495</span>
<span class="c1"># Columna eliminada &#39;V293&#39; con VIF: 2397.338403604842</span>
<span class="c1"># Columna eliminada &#39;C11&#39; con VIF: 1812.3552275020093</span>
<span class="c1"># Columna eliminada &#39;C8&#39; con VIF: 1391.389701468855</span>
<span class="c1"># Columna eliminada &#39;V294&#39; con VIF: 1149.6820327570645</span>
<span class="c1"># Columna eliminada &#39;C4&#39; con VIF: 588.5989949227932</span>
<span class="c1"># Columna eliminada &#39;V133&#39; con VIF: 578.3210694759822</span>
<span class="c1"># Columna eliminada &#39;V132&#39; con VIF: 484.08811546256317</span>
<span class="c1"># Columna eliminada &#39;V318&#39; con VIF: 436.2367451591822</span>
<span class="c1"># Columna eliminada &#39;C10&#39; con VIF: 419.962508303669</span>
<span class="c1"># Columna eliminada &#39;V15&#39; con VIF: 338.4806837144098</span>
<span class="c1"># Columna eliminada &#39;C6&#39; con VIF: 277.8255230653713</span>
<span class="c1"># Columna eliminada &#39;V57&#39; con VIF: 264.71531702204805</span>
<span class="c1"># Columna eliminada &#39;V295&#39; con VIF: 196.20506417179288</span>
<span class="c1"># Columna eliminada &#39;C1&#39; con VIF: 194.24500060236178</span>
<span class="c1"># Columna eliminada &#39;V298&#39; con VIF: 184.30862482899562</span>
<span class="c1"># Columna eliminada &#39;V137&#39; con VIF: 164.58050801517732</span>
<span class="c1"># Columna eliminada &#39;V17&#39; con VIF: 153.2256749049885</span>
<span class="c1"># Columna eliminada &#39;V102&#39; con VIF: 150.9588074131013</span>
<span class="c1"># Columna eliminada &#39;V32&#39; con VIF: 102.7404663093373</span>
<span class="c1"># Columna eliminada &#39;V106&#39; con VIF: 100.98773708269033</span>
<span class="c1"># Columna eliminada &#39;C2&#39; con VIF: 86.11639631025432</span>
<span class="c1"># Columna eliminada &#39;V306&#39; con VIF: 81.94410756153545</span>
<span class="c1"># Columna eliminada &#39;V93&#39; con VIF: 81.14716291016839</span>
<span class="c1"># Columna eliminada &#39;V105&#39; con VIF: 71.19150815753059</span>
<span class="c1"># Columna eliminada &#39;V128&#39; con VIF: 63.23130342975755</span>
<span class="c1"># Columna eliminada &#39;V72&#39; con VIF: 59.61719315451742</span>
<span class="c1"># Columna eliminada &#39;C13&#39; con VIF: 51.10063313196958</span>
<span class="c1"># Columna eliminada &#39;V321&#39; con VIF: 50.89755295618454</span>
<span class="c1"># Columna eliminada &#39;V84&#39; con VIF: 48.62129936909281</span>
<span class="c1"># Columna eliminada &#39;V63&#39; con VIF: 42.267377955572535</span>
<span class="c1"># Columna eliminada &#39;V51&#39; con VIF: 38.90878989197315</span>
<span class="c1"># Columna eliminada &#39;V33&#39; con VIF: 37.618501442554404</span>
<span class="c1"># Columna eliminada &#39;V136&#39; con VIF: 36.12573298317818</span>
<span class="c1"># Columna eliminada &#39;V90&#39; con VIF: 35.52295678457032</span>
<span class="c1"># Columna eliminada &#39;V304&#39; con VIF: 34.890533696939876</span>
<span class="c1"># Columna eliminada &#39;V21&#39; con VIF: 33.55770979716764</span>
<span class="c1"># Columna eliminada &#39;V42&#39; con VIF: 29.202791751625362</span>
<span class="c1"># Columna eliminada &#39;V59&#39; con VIF: 28.204369797660856</span>
<span class="c1"># Columna eliminada &#39;V73&#39; con VIF: 27.23591501275453</span>
<span class="c1"># Columna eliminada &#39;V69&#39; con VIF: 26.153089272639594</span>
<span class="c1"># Columna eliminada &#39;V81&#39; con VIF: 25.262455291536234</span>
<span class="c1"># Columna eliminada &#39;V58&#39; con VIF: 24.41515428442981</span>
<span class="c1"># Columna eliminada &#39;V292&#39; con VIF: 24.375737451682628</span>
<span class="c1"># Columna eliminada &#39;V48&#39; con VIF: 23.65961185877247</span>
<span class="c1"># Columna eliminada &#39;V28&#39; con VIF: 23.203525055368573</span>
<span class="c1"># Columna eliminada &#39;V16&#39; con VIF: 21.24258783006306</span>
<span class="c1"># Columna eliminada &#39;V299&#39; con VIF: 20.01301843186232</span>
<span class="c1"># Columna eliminada &#39;V131&#39; con VIF: 19.27902029391925</span>
<span class="c1"># Columna eliminada &#39;V317&#39; con VIF: 18.389502612834114</span>
<span class="c1"># Columna eliminada &#39;V92&#39; con VIF: 18.0282852662873</span>
<span class="c1"># Columna eliminada &#39;V94&#39; con VIF: 17.704913104898296</span>
<span class="c1"># Columna eliminada &#39;V30&#39; con VIF: 17.447311351011063</span>
<span class="c1"># Columna eliminada &#39;V39&#39; con VIF: 16.199512137116862</span>
<span class="c1"># Columna eliminada &#39;V320&#39; con VIF: 16.189243430240783</span>
<span class="c1"># Columna eliminada &#39;V309&#39; con VIF: 15.416507582967746</span>
<span class="c1"># Columna eliminada &#39;V31&#39; con VIF: 14.753774920514614</span>
<span class="c1"># Columna eliminada &#39;V315&#39; con VIF: 14.400701016770533</span>
<span class="c1"># Columna eliminada &#39;V76&#39; con VIF: 14.37065360874736</span>
<span class="c1"># Columna eliminada &#39;V45&#39; con VIF: 13.11564471190686</span>
<span class="c1"># Columna eliminada &#39;V35&#39; con VIF: 12.70745812952196</span>
<span class="c1"># Columna eliminada &#39;V287&#39; con VIF: 12.487475844464422</span>
<span class="c1"># Columna eliminada &#39;V50&#39; con VIF: 12.184244762580407</span>
<span class="c1"># Columna eliminada &#39;V113&#39; con VIF: 11.93384008839884</span>
<span class="c1"># Columna eliminada &#39;V22&#39; con VIF: 11.553486178587873</span>
<span class="c1"># Columna eliminada &#39;V12&#39; con VIF: 11.169807495347724</span>
<span class="c1"># Columna eliminada &#39;V116&#39; con VIF: 10.616482079016798</span>
<span class="c1"># Columna eliminada &#39;V297&#39; con VIF: 10.517905438986556</span>
<span class="c1"># Columna eliminada &#39;V64&#39; con VIF: 10.27872623677124</span>
<span class="c1"># Columna eliminada &#39;V52&#39; con VIF: 10.245754798460924</span>
<span class="c1"># Columna eliminada &#39;V19&#39; con VIF: 10.182913772262543</span>
<span class="c1"># Columna eliminada &#39;V99&#39; con VIF: 10.151263727310196</span>

<span class="n">lista_columnas_eliminadas_vif</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;V97&#39;</span><span class="p">,</span><span class="s1">&#39;V96&#39;</span><span class="p">,</span><span class="s1">&#39;V280&#39;</span><span class="p">,</span><span class="s1">&#39;V308&#39;</span><span class="p">,</span><span class="s1">&#39;V95&#39;</span><span class="p">,</span><span class="s1">&#39;V307&#39;</span><span class="p">,</span><span class="s1">&#39;V126&#39;</span><span class="p">,</span><span class="s1">&#39;V279&#39;</span><span class="p">,</span>
    <span class="s1">&#39;V127&#39;</span><span class="p">,</span><span class="s1">&#39;V134&#39;</span><span class="p">,</span><span class="s1">&#39;C12&#39;</span><span class="p">,</span><span class="s1">&#39;V103&#39;</span><span class="p">,</span><span class="s1">&#39;V316&#39;</span><span class="p">,</span><span class="s1">&#39;V293&#39;</span><span class="p">,</span><span class="s1">&#39;C11&#39;</span><span class="p">,</span><span class="s1">&#39;C8&#39;</span><span class="p">,</span><span class="s1">&#39;V294&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;V133&#39;</span><span class="p">,</span><span class="s1">&#39;V132&#39;</span><span class="p">,</span><span class="s1">&#39;V318&#39;</span><span class="p">,</span><span class="s1">&#39;C10&#39;</span><span class="p">,</span><span class="s1">&#39;V15&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span><span class="s1">&#39;V57&#39;</span><span class="p">,</span><span class="s1">&#39;V295&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;V298&#39;</span><span class="p">,</span><span class="s1">&#39;V137&#39;</span><span class="p">,</span><span class="s1">&#39;V17&#39;</span><span class="p">,</span><span class="s1">&#39;V102&#39;</span><span class="p">,</span><span class="s1">&#39;V32&#39;</span><span class="p">,</span><span class="s1">&#39;V106&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;V306&#39;</span><span class="p">,</span><span class="s1">&#39;V93&#39;</span><span class="p">,</span>
    <span class="s1">&#39;V105&#39;</span><span class="p">,</span><span class="s1">&#39;V128&#39;</span><span class="p">,</span><span class="s1">&#39;V72&#39;</span><span class="p">,</span><span class="s1">&#39;C13&#39;</span><span class="p">,</span><span class="s1">&#39;V321&#39;</span><span class="p">,</span><span class="s1">&#39;V84&#39;</span><span class="p">,</span><span class="s1">&#39;V63&#39;</span><span class="p">,</span><span class="s1">&#39;V51&#39;</span><span class="p">,</span><span class="s1">&#39;V33&#39;</span><span class="p">,</span><span class="s1">&#39;V136&#39;</span><span class="p">,</span>
    <span class="s1">&#39;V90&#39;</span><span class="p">,</span><span class="s1">&#39;V304&#39;</span><span class="p">,</span><span class="s1">&#39;V21&#39;</span><span class="p">,</span><span class="s1">&#39;V42&#39;</span><span class="p">,</span><span class="s1">&#39;V59&#39;</span><span class="p">,</span><span class="s1">&#39;V73&#39;</span><span class="p">,</span><span class="s1">&#39;V69&#39;</span><span class="p">,</span><span class="s1">&#39;V81&#39;</span><span class="p">,</span><span class="s1">&#39;V58&#39;</span><span class="p">,</span><span class="s1">&#39;V292&#39;</span><span class="p">,</span>
    <span class="s1">&#39;V48&#39;</span><span class="p">,</span><span class="s1">&#39;V28&#39;</span><span class="p">,</span><span class="s1">&#39;V16&#39;</span><span class="p">,</span><span class="s1">&#39;V299&#39;</span><span class="p">,</span><span class="s1">&#39;V131&#39;</span><span class="p">,</span><span class="s1">&#39;V317&#39;</span><span class="p">,</span><span class="s1">&#39;V92&#39;</span><span class="p">,</span><span class="s1">&#39;V94&#39;</span><span class="p">,</span><span class="s1">&#39;V30&#39;</span><span class="p">,</span><span class="s1">&#39;V39&#39;</span><span class="p">,</span>
    <span class="s1">&#39;V320&#39;</span><span class="p">,</span><span class="s1">&#39;V309&#39;</span><span class="p">,</span><span class="s1">&#39;V31&#39;</span><span class="p">,</span><span class="s1">&#39;V315&#39;</span><span class="p">,</span><span class="s1">&#39;V76&#39;</span><span class="p">,</span><span class="s1">&#39;V45&#39;</span><span class="p">,</span><span class="s1">&#39;V35&#39;</span><span class="p">,</span><span class="s1">&#39;V287&#39;</span><span class="p">,</span><span class="s1">&#39;V50&#39;</span><span class="p">,</span><span class="s1">&#39;V113&#39;</span><span class="p">,</span>
    <span class="s1">&#39;V22&#39;</span><span class="p">,</span><span class="s1">&#39;V12&#39;</span><span class="p">,</span><span class="s1">&#39;V116&#39;</span><span class="p">,</span><span class="s1">&#39;V297&#39;</span><span class="p">,</span><span class="s1">&#39;V64&#39;</span><span class="p">,</span><span class="s1">&#39;V52&#39;</span><span class="p">,</span><span class="s1">&#39;V19&#39;</span><span class="p">,</span><span class="s1">&#39;V99&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">df_numerico</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">lista_columnas_eliminadas_vif</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calcular_vif</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">limite</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">X_const</span> <span class="o">=</span> <span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">vifs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
            <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X_const</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span>
            <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">)</span>
        <span class="n">max_vif</span> <span class="o">=</span> <span class="n">vifs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">max_vif</span> <span class="o">&gt;</span> <span class="n">limite</span><span class="p">:</span>
            <span class="n">drop_col</span> <span class="o">=</span> <span class="n">vifs</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columna eliminada &#39;</span><span class="si">{</span><span class="n">drop_col</span><span class="si">}</span><span class="s2">&#39; con VIF: </span><span class="si">{</span><span class="n">max_vif</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">drop_col</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No hay mas columnas con un VIF mayor a </span><span class="si">{</span><span class="n">limite</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">X</span>


<span class="n">df_numerico_copy</span> <span class="o">=</span> <span class="n">df_numerico</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;isFraud&quot;</span><span class="p">])</span>

<span class="c1"># Desactivamos el calculo del VIF porque ya las columnas calculadas en horas pasadas</span>
<span class="c1"># fueron eliminadas</span>
<span class="c1"># df_numerico_copy_limpio = calcular_vif(df_numerico_copy, limite=10.0)</span>

<span class="n">df_numerico_copy_limpio</span> <span class="o">=</span> <span class="n">df_numerico_copy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">lista_columnas_eliminadas_vif</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_test_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">lista_columnas_eliminadas_vif</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_categoricas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M6&#39;</span><span class="p">]</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train_full</span><span class="p">[</span><span class="n">columnas_categoricas</span><span class="p">])</span>

<span class="n">df_train_full_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_train_full</span><span class="p">[</span><span class="n">columnas_categoricas</span><span class="p">])</span>
<span class="n">df_test_full_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_test_full</span><span class="p">[</span><span class="n">columnas_categoricas</span><span class="p">])</span>

<span class="n">df_train_full_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_train_full_encoded</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">columnas_categoricas</span><span class="p">))</span>
<span class="n">df_test_full_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_test_full_encoded</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">columnas_categoricas</span><span class="p">))</span>

<span class="n">df_train_full_encoded</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-66884979-9e3b-430f-8fa9-6a6b00f4085d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>M6_F</th>
      <th>M6_T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-66884979-9e3b-430f-8fa9-6a6b00f4085d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-66884979-9e3b-430f-8fa9-6a6b00f4085d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-66884979-9e3b-430f-8fa9-6a6b00f4085d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-acaaf73d-4d67-4dc8-842d-534f7bf36ddf">
  <button class="colab-df-quickchart" onclick="quickchart('df-acaaf73d-4d67-4dc8-842d-534f7bf36ddf')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-acaaf73d-4d67-4dc8-842d-534f7bf36ddf button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_37406370-ec23-4acb-af48-70f9a81af7f7">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_train_full_encoded')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_37406370-ec23-4acb-af48-70f9a81af7f7 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_train_full_encoded');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_train_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columnas_categoricas</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">df_train_full_encoded</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_test_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_test_full</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columnas_categoricas</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">df_test_full_encoded</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_train_full</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9a1c9fea-f54f-4c69-9445-5b13fb1f2334" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>C3</th>
      <th>...</th>
      <th>V303</th>
      <th>V305</th>
      <th>V310</th>
      <th>V311</th>
      <th>V312</th>
      <th>V313</th>
      <th>V314</th>
      <th>V319</th>
      <th>M6_F</th>
      <th>M6_T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>86400</td>
      <td>68.50</td>
      <td>13926</td>
      <td>321.0</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>86401</td>
      <td>29.00</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>86469</td>
      <td>59.00</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>86499</td>
      <td>50.00</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>354.000000</td>
      <td>0.0</td>
      <td>135.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>86506</td>
      <td>50.00</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>0</td>
      <td>15811047</td>
      <td>49.00</td>
      <td>6550</td>
      <td>321.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>272.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>47.950001</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>47.950001</td>
      <td>47.950001</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>0</td>
      <td>15811049</td>
      <td>39.50</td>
      <td>10444</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>204.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>0</td>
      <td>15811079</td>
      <td>30.95</td>
      <td>12037</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>231.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>0</td>
      <td>15811088</td>
      <td>117.00</td>
      <td>7826</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>387.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>669.500000</td>
      <td>0.0</td>
      <td>117.0</td>
      <td>317.500000</td>
      <td>669.500000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>0</td>
      <td>15811131</td>
      <td>279.95</td>
      <td>15066</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>279.950012</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 114 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9a1c9fea-f54f-4c69-9445-5b13fb1f2334')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9a1c9fea-f54f-4c69-9445-5b13fb1f2334 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9a1c9fea-f54f-4c69-9445-5b13fb1f2334');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d6c681cf-052c-4a27-b2d8-eef74297ec38">
  <button class="colab-df-quickchart" onclick="quickchart('df-d6c681cf-052c-4a27-b2d8-eef74297ec38')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d6c681cf-052c-4a27-b2d8-eef74297ec38 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_d9cf990d-ed02-44fc-bd3d-7ab6a941fecb">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_train_full')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_d9cf990d-ed02-44fc-bd3d-7ab6a941fecb button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_train_full');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="descripcion_del_proyecto.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Por:</strong> Angélica Sepúlveda, Andrés Pedraza y Jefry Llerena</p>
      </div>
    </a>
    <a class="right-next"
       href="modelos_clasificacion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ejercicio 2. Modelos de Clasificación</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Ejercicio 1. Análisis Exploratorio de Datos</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#taller-2">Taller 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#punto-1">Punto 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-velocidad-del-viento">1.1. Dataset Velocidad del Viento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-deteccion-de-fraude">1.2. Dataset Deteccion de Fraude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limpieza-y-preparacion">1.3. Limpieza y Preparación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamiento-de-nulos">1.3.1. Tratamiento de Nulos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-dimencionalidad-con-chi2">1.3.2. Reduccion de Dimencionalidad con Chi2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-dimensionalidad-con-vif">1.3.3. Reduccion de dimensionalidad con VIF</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Angélica Sepúlveda, Andrés Pedraza y Jefry Llerena
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>