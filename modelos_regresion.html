

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Ejercicio 3. Modelos de Regresión &#8212; jbook_Parcial_Practico</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modelos_regresion';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ejercicio 4. Modelos de Segmentación" href="modelos_segmentacion.html" />
    <link rel="prev" title="Ejercicio 2. Modelos de Clasificación" href="modelos_clasificacion.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="descripcion_del_proyecto.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo-uninorte.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo-uninorte.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="descripcion_del_proyecto.html">
                    Por: Angélica Sepúlveda, Andrés Pedraza y Jefry Llerena
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="eda.html">Ejercicio 1. Análisis Exploratorio de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelos_clasificacion.html">Ejercicio 2. Modelos de Clasificación</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Ejercicio 3. Modelos de Regresión</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelos_segmentacion.html">Ejercicio 4. Modelos de Segmentación</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fmodelos_regresion.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/modelos_regresion.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ejercicio 3. Modelos de Regresión</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-knn">Codigo de KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-regresion-lineal">Codigo de Regresion Lineal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-ridge">Codigo de Ridge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-lasso">Codigo de Lasso</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-arbol-de-decision">Codigo de Arbol de decision</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-random-forest">Codigo de Random Forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-xgboost">Codigo de XGBoost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-svm">Codigo de SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-mlp">Codigo de MLP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparacion-para-rnn-y-lstm">Preparacion para RNN y LSTM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-rnn">Codigo de RNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-lstm">Codigo de LSTM</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-evaluacion-para-los-modelos-propuestos">Métricas de evaluación para los modelos propuestos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-absoluto-medio-mae">1. Error Absoluto Medio (MAE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raiz-del-error-cuadratico-medio-rmse">2. Raíz del Error Cuadrático Medio (RMSE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-cuadratico-medio-mse">3. Error Cuadrático Medio (MSE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-porcentual-absoluto-medio-mape">4. Error Porcentual Absoluto Medio (MAPE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coeficiente-de-determinacion-r-2">5. Coeficiente de Determinación ((R^2))</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvalue-del-test-de-ljungbox">6. p‑value del Test de Ljung–Box</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-comparativo-de-los-modelos"><strong>Análisis Comparativo de los Modelos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-de-modelos-y-metricas"><strong>Resumen de Modelos y Métricas</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-por-categoria-de-modelos"><strong>Análisis por Categoría de Modelos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-ensemble"><strong>1. Modelos Ensemble</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-lineales"><strong>2. Modelos Lineales</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-soporte-vectorial"><strong>3. Modelos de Soporte Vectorial</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#redes-neuronales"><strong>4. Redes Neuronales</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#knn"><strong>5. K‑NN</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-de-rendimiento-en-metricas"><strong>Comparación de Rendimiento en Métricas</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observaciones"><strong>Observaciones</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-finales"><strong>Conclusiones Finales</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ejercicio-3-modelos-de-regresion">
<h1>Ejercicio 3. Modelos de Regresión<a class="headerlink" href="#ejercicio-3-modelos-de-regresion" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>xgboost<span class="w"> </span>statsmodels<span class="w"> </span>tensorflow
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: xgboost in /usr/local/lib/python3.11/dist-packages (2.1.4)
Requirement already satisfied: statsmodels in /usr/local/lib/python3.11/dist-packages (0.14.4)
Requirement already satisfied: tensorflow in /usr/local/lib/python3.11/dist-packages (2.18.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from xgboost) (2.0.2)
Requirement already satisfied: nvidia-nccl-cu12 in /usr/local/lib/python3.11/dist-packages (from xgboost) (2.21.5)
Requirement already satisfied: scipy in /usr/local/lib/python3.11/dist-packages (from xgboost) (1.14.1)
Requirement already satisfied: pandas!=2.1.0,&gt;=1.4 in /usr/local/lib/python3.11/dist-packages (from statsmodels) (2.2.2)
Requirement already satisfied: patsy&gt;=0.5.6 in /usr/local/lib/python3.11/dist-packages (from statsmodels) (1.0.1)
Requirement already satisfied: packaging&gt;=21.3 in /usr/local/lib/python3.11/dist-packages (from statsmodels) (24.2)
Requirement already satisfied: absl-py&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (1.4.0)
Requirement already satisfied: astunparse&gt;=1.6.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (1.6.3)
Requirement already satisfied: flatbuffers&gt;=24.3.25 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (25.2.10)
Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,&gt;=0.2.1 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (0.6.0)
Requirement already satisfied: google-pasta&gt;=0.1.1 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (0.2.0)
Requirement already satisfied: libclang&gt;=13.0.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (18.1.1)
Requirement already satisfied: opt-einsum&gt;=2.3.2 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (3.4.0)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;6.0.0dev,&gt;=3.20.3 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (5.29.4)
Requirement already satisfied: requests&lt;3,&gt;=2.21.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (2.32.3)
Requirement already satisfied: setuptools in /usr/local/lib/python3.11/dist-packages (from tensorflow) (75.2.0)
Requirement already satisfied: six&gt;=1.12.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (1.17.0)
Requirement already satisfied: termcolor&gt;=1.1.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (3.0.1)
Requirement already satisfied: typing-extensions&gt;=3.6.6 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (4.13.1)
Requirement already satisfied: wrapt&gt;=1.11.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (1.17.2)
Requirement already satisfied: grpcio&lt;2.0,&gt;=1.24.3 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (1.71.0)
Requirement already satisfied: tensorboard&lt;2.19,&gt;=2.18 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (2.18.0)
Requirement already satisfied: keras&gt;=3.5.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (3.8.0)
Requirement already satisfied: h5py&gt;=3.11.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (3.13.0)
Requirement already satisfied: ml-dtypes&lt;0.5.0,&gt;=0.4.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (0.4.1)
Requirement already satisfied: tensorflow-io-gcs-filesystem&gt;=0.23.1 in /usr/local/lib/python3.11/dist-packages (from tensorflow) (0.37.1)
Requirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /usr/local/lib/python3.11/dist-packages (from astunparse&gt;=1.6.0-&gt;tensorflow) (0.45.1)
Requirement already satisfied: rich in /usr/local/lib/python3.11/dist-packages (from keras&gt;=3.5.0-&gt;tensorflow) (13.9.4)
Requirement already satisfied: namex in /usr/local/lib/python3.11/dist-packages (from keras&gt;=3.5.0-&gt;tensorflow) (0.0.8)
Requirement already satisfied: optree in /usr/local/lib/python3.11/dist-packages (from keras&gt;=3.5.0-&gt;tensorflow) (0.15.0)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2025.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.11/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow) (3.4.1)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.11/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow) (2.3.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow) (2025.1.31)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.11/dist-packages (from tensorboard&lt;2.19,&gt;=2.18-&gt;tensorflow) (3.7)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /usr/local/lib/python3.11/dist-packages (from tensorboard&lt;2.19,&gt;=2.18-&gt;tensorflow) (0.7.2)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.11/dist-packages (from tensorboard&lt;2.19,&gt;=2.18-&gt;tensorflow) (3.1.3)
Requirement already satisfied: MarkupSafe&gt;=2.1.1 in /usr/local/lib/python3.11/dist-packages (from werkzeug&gt;=1.0.1-&gt;tensorboard&lt;2.19,&gt;=2.18-&gt;tensorflow) (3.0.2)
Requirement already satisfied: markdown-it-py&gt;=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich-&gt;keras&gt;=3.5.0-&gt;tensorflow) (3.0.0)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich-&gt;keras&gt;=3.5.0-&gt;tensorflow) (2.18.0)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py&gt;=2.2.0-&gt;rich-&gt;keras&gt;=3.5.0-&gt;tensorflow) (0.1.2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">clone</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">SimpleRNN</span><span class="p">,</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_viento</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/lihkir/Data/refs/heads/main/wind_speed/data_treino_dv_df_2000_2010.csv&quot;</span><span class="p">)</span>

<span class="n">df_viento</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;hora&quot;</span><span class="p">,</span> <span class="s2">&quot;viento_direccion_horaria&quot;</span><span class="p">,</span> <span class="s2">&quot;viento_velocidad_horaria&quot;</span><span class="p">,</span>
    <span class="s2">&quot;humedad_max_hora&quot;</span><span class="p">,</span> <span class="s2">&quot;humedad_min_hora&quot;</span><span class="p">,</span> <span class="s2">&quot;temp_min_hora&quot;</span><span class="p">,</span> <span class="s2">&quot;temp_max_hora&quot;</span><span class="p">,</span>
    <span class="s2">&quot;humedad_relativa&quot;</span><span class="p">,</span> <span class="s2">&quot;presion_armosferica&quot;</span><span class="p">,</span> <span class="s2">&quot;precip_atmos_total&quot;</span><span class="p">,</span> <span class="s2">&quot;viento_bajada_max&quot;</span><span class="p">,</span>
    <span class="s2">&quot;precip_atmos_max&quot;</span><span class="p">,</span> <span class="s2">&quot;precip_atmos_min&quot;</span>
<span class="p">]</span>

<span class="n">df_viento</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hora</th>
      <th>viento_direccion_horaria</th>
      <th>viento_velocidad_horaria</th>
      <th>humedad_max_hora</th>
      <th>humedad_min_hora</th>
      <th>temp_min_hora</th>
      <th>temp_max_hora</th>
      <th>humedad_relativa</th>
      <th>presion_armosferica</th>
      <th>precip_atmos_total</th>
      <th>viento_bajada_max</th>
      <th>precip_atmos_max</th>
      <th>precip_atmos_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87688</th>
      <td>19:00</td>
      <td>-0.615661</td>
      <td>5.6</td>
      <td>83.0</td>
      <td>78.0</td>
      <td>21.8</td>
      <td>21.1</td>
      <td>80.0</td>
      <td>879.1</td>
      <td>0.0</td>
      <td>12.3</td>
      <td>879.8</td>
      <td>879.1</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>20:00</td>
      <td>-0.469472</td>
      <td>4.9</td>
      <td>84.0</td>
      <td>79.0</td>
      <td>21.7</td>
      <td>21.0</td>
      <td>84.0</td>
      <td>879.2</td>
      <td>0.0</td>
      <td>9.9</td>
      <td>879.2</td>
      <td>878.9</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>21:00</td>
      <td>-0.484810</td>
      <td>4.5</td>
      <td>86.0</td>
      <td>82.0</td>
      <td>21.2</td>
      <td>20.6</td>
      <td>86.0</td>
      <td>879.7</td>
      <td>0.0</td>
      <td>8.9</td>
      <td>879.8</td>
      <td>879.2</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>22:00</td>
      <td>-0.484810</td>
      <td>3.2</td>
      <td>88.0</td>
      <td>85.0</td>
      <td>20.6</td>
      <td>20.2</td>
      <td>88.0</td>
      <td>880.5</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>880.5</td>
      <td>879.6</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>23:00</td>
      <td>-0.573576</td>
      <td>2.3</td>
      <td>95.0</td>
      <td>88.0</td>
      <td>20.2</td>
      <td>19.3</td>
      <td>95.0</td>
      <td>881.1</td>
      <td>0.6</td>
      <td>7.5</td>
      <td>881.1</td>
      <td>880.5</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 13 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_viento_sin_hora</span> <span class="o">=</span> <span class="n">df_viento</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hora&quot;</span><span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df_viento_sin_hora</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;viento_velocidad_horaria&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_viento_sin_hora</span><span class="p">[</span><span class="s2">&quot;viento_velocidad_horaria&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="n">ventanas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.8, 2.7, 2. , ..., 4.5, 3.2, 2.3])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pliegues_rolling</span><span class="p">(</span><span class="n">dias</span><span class="p">,</span> <span class="n">muestras_dia</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">dias</span> <span class="o">*</span> <span class="n">muestras_dia</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">muestras_dia</span>
    <span class="k">for</span> <span class="n">fin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">fin</span> <span class="o">-</span> <span class="n">w</span><span class="p">,</span> <span class="n">fin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">fin</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">obtener_predicciones</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">dias</span><span class="p">):</span>
    <span class="n">yv</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">tr</span><span class="p">,</span> <span class="n">te</span> <span class="ow">in</span> <span class="n">pliegues_rolling</span><span class="p">(</span><span class="n">dias</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="n">modelo</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">tr</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">tr</span><span class="p">])</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">te</span><span class="p">])</span>
        <span class="n">yv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">te</span><span class="p">])</span>
        <span class="n">yp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">yv</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">yp</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">metricas</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span> <span class="n">yp</span><span class="p">):</span>
    <span class="n">resid</span> <span class="o">=</span> <span class="n">yv</span> <span class="o">-</span> <span class="n">yp</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">yv</span> <span class="o">-</span> <span class="n">yp</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">yv</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">yv</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span> <span class="n">yp</span><span class="p">))</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>

    <span class="n">resid</span> <span class="o">-=</span> <span class="n">resid</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">pval</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">mape</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="n">pval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="codigo-de-knn">
<h2>Codigo de KNN<a class="headerlink" href="#codigo-de-knn" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 1 ─ KNN ENTRENAMIENTO</span>
<span class="n">modelo_knn</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s2">&quot;esc&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;knn&quot;</span><span class="p">,</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">))])</span>
<span class="n">y_true_knn</span><span class="p">,</span> <span class="n">y_pred_knn</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_knn</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_knn</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_knn</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KNN ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KNN ventana 7 días 8.71s
KNN ventana 14 días 9.51s
KNN ventana 21 días 10.58s
KNN ventana 28 días 11.15s
</pre></div>
</div>
</div>
</div>
<p>KNN ventana 7 días 8.71s</p>
<p>KNN ventana 14 días 9.51s</p>
<p>KNN ventana 21 días 10.58s</p>
<p>KNN ventana 28 días 11.15s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 2 ─ KNN MÉTRICAS</span>
<span class="n">res_knn</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_knn</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_knn</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_knn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_knn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_knn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana KNN&quot;</span><span class="p">,</span> <span class="n">df_knn</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>
<span class="n">df_knn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE        R2    LB_p
7  2.487e+08 6.745e-01 8.753e-01 7.661e-01 5.564e-01  0.e+00
14 2.318e+08 6.282e-01 8.164e-01 6.665e-01 6.143e-01  0.e+00
21 2.245e+08 6.055e-01 7.877e-01 6.205e-01 6.409e-01  0.e+00
28 2.166e+08 5.926e-01 7.705e-01 5.937e-01 6.565e-01  0.e+00
Mejor ventana KNN 28
</pre></div>
</div>
<div class="output text_html">
  <div id="df-95659c31-2174-43c8-aad8-4b2a522b6425" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>2.487e+08</td>
      <td>6.745e-01</td>
      <td>8.753e-01</td>
      <td>7.661e-01</td>
      <td>5.564e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2.318e+08</td>
      <td>6.282e-01</td>
      <td>8.164e-01</td>
      <td>6.665e-01</td>
      <td>6.143e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2.245e+08</td>
      <td>6.055e-01</td>
      <td>7.877e-01</td>
      <td>6.205e-01</td>
      <td>6.409e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2.166e+08</td>
      <td>5.926e-01</td>
      <td>7.705e-01</td>
      <td>5.937e-01</td>
      <td>6.565e-01</td>
      <td>0.e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-95659c31-2174-43c8-aad8-4b2a522b6425')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-95659c31-2174-43c8-aad8-4b2a522b6425 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-95659c31-2174-43c8-aad8-4b2a522b6425');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fc2ecb04-9b3d-4ece-9d2d-fca5acece0ff">
  <button class="colab-df-quickchart" onclick="quickchart('df-fc2ecb04-9b3d-4ece-9d2d-fca5acece0ff')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fc2ecb04-9b3d-4ece-9d2d-fca5acece0ff button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_d01a628d-1875-44af-9b32-08a0129b008a">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_knn')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_d01a628d-1875-44af-9b32-08a0129b008a button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_knn');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>    <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">2.487e+08</span> <span class="mf">6.745e-01</span> <span class="mf">8.753e-01</span> <span class="mf">7.661e-01</span> <span class="mf">5.564e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">14</span> <span class="mf">2.318e+08</span> <span class="mf">6.282e-01</span> <span class="mf">8.164e-01</span> <span class="mf">6.665e-01</span> <span class="mf">6.143e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">21</span> <span class="mf">2.245e+08</span> <span class="mf">6.055e-01</span> <span class="mf">7.877e-01</span> <span class="mf">6.205e-01</span> <span class="mf">6.409e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">28</span> <span class="mf">2.166e+08</span> <span class="mf">5.926e-01</span> <span class="mf">7.705e-01</span> <span class="mf">5.937e-01</span> <span class="mf">6.565e-01</span>  <span class="mf">0.e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">KNN</span> <span class="mi">28</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">2.487e+08</span>	<span class="mf">6.745e-01</span>	<span class="mf">8.753e-01</span>	<span class="mf">7.661e-01</span>	<span class="mf">5.564e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">14</span>	<span class="mf">2.318e+08</span>	<span class="mf">6.282e-01</span>	<span class="mf">8.164e-01</span>	<span class="mf">6.665e-01</span>	<span class="mf">6.143e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">21</span>	<span class="mf">2.245e+08</span>	<span class="mf">6.055e-01</span>	<span class="mf">7.877e-01</span>	<span class="mf">6.205e-01</span>	<span class="mf">6.409e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">28</span>	<span class="mf">2.166e+08</span>	<span class="mf">5.926e-01</span>	<span class="mf">7.705e-01</span>	<span class="mf">5.937e-01</span>	<span class="mf">6.565e-01</span>	<span class="mf">0.e+00</span>
</pre></div>
</div>
  <div style="background-color: #f5fdf9; padding: 12px;">
    <h3><strong>💡 Análisis del Modelo KNN</strong></h3>
    <p>Los resultados del modelo KNN muestran una mejora gradual en el rendimiento a medida que aumenta el tamaño de la ventana de predicción (T). A continuación, se detalla el análisis de las métricas:</p>
    <hr>
    <h4><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h4>
    <ul>
      <li><strong>MAPE (Mean Absolute Percentage Error):</strong><br>
        Aunque el MAPE disminuye con ventanas más grandes, los valores siguen siendo muy altos (del orden de 10⁸), lo que indica un gran error porcentual en las predicciones.<br>
        T=7: <code>2.487e+08</code><br>
        T=28: <code>2.166e+08</code> (mejora del 12.9%)
      </li>
      <li><strong>MAE (Mean Absolute Error):</strong><br>
        El error absoluto disminuye con ventanas más grandes:<br>
        T=7: <code>6.745e-01</code><br>
        T=28: <code>5.926e-01</code> (mejora del 12.0%)
      </li>
      <li><strong>RMSE (Root Mean Squared Error):</strong><br>
        Similar al MAE, el RMSE también mejora con ventanas más grandes:<br>
        T=7: <code>8.753e-01</code><br>
        T=28: <code>7.705e-01</code> (mejora del 11.8%)
      </li>
      <li><strong>MSE (Mean Squared Error):</strong><br>
        El error cuadrático medio sigue la misma tendencia que RMSE:<br>
        T=7: <code>7.661e-01</code><br>
        T=28: <code>5.937e-01</code> (mejora del 22.4%)
      </li>
      <li><strong>R2 (R-squared):</strong><br>
        El coeficiente de determinación mejora con ventanas más grandes, aunque sigue siendo relativamente bajo:<br>
        T=7: <code>5.564e-01</code> (R2=0.556)<br>
        T=28: <code>6.565e-01</code> (R2=0.656)
      </li>
    </ul>
    <hr>
    <h4><strong>2. Problemas Identificados</strong></h4>
    <ul>
      <li><strong>Altos Valores de MAPE:</strong><br>
        Los valores de MAPE son extremadamente altos en todas las ventanas, lo que podría indicar:
        <ul>
          <li>Problemas de escala</li>
          <li>Ruido en los datos</li>
         </ul>
      </li>
      <li><strong>Autocorrelación en Residuos:</strong><br>
        El valor <code>LB_p = 0.e+00</code> en todas las ventanas, lo que indica autocorrelación significativa en los residuos. Esto viola los supuestos de regresión y sugiere que el modelo no captura la dinámica temporal de los datos.
      </li>
    </ul>
    <hr>
    <h4><strong>3. Mejores Resultados</strong></h4>
    <p>La ventana de tamaño <strong>T=28</strong> muestra los mejores resultados:</p>
    <ul>
      <li>Menor MAPE: <code>2.166e+08</code></li>
      <li>Menor RMSE: <code>7.705e-01</code></li>
      <li>Mayor R2: <code>6.565e-01</code></li>
    </ul>
    <hr>
    <h4><strong>4. Recomendaciones</strong></h4>
    <ol>
      <li><strong>Mejorar el Modelo KNN:</strong>
        <ul>
          <li>Ajustar el parámetro <code>n_neighbors</code></li>
          <li>Explorar la ponderación por distancia <code>weights='distance'</code></li>
        </ul>
      </li>
      <li><strong>Reducir el MAPE:</strong>
        <ul>
          <li>Revisar las unidades de las variables</li>
          <li>Considerar la transformación de la variable objetivo</li>
        </ul>
      </li>
    </ol>
    <hr>
    <h4><strong>Conclusión</strong></h4>
    <p>Aunque la ventana <strong>T=28</strong> muestra el mejor rendimiento, los errores siguen siendo muy altos, lo que sugiere que el modelo KNN puede no ser el más adecuado.</p>
  </div>
</div></section>
<section id="codigo-de-regresion-lineal">
<h2>Codigo de Regresion Lineal<a class="headerlink" href="#codigo-de-regresion-lineal" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 3 ─ REGRESIÓN LINEAL ENTRENAMIENTO</span>
<span class="n">modelo_lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">y_true_lr</span><span class="p">,</span> <span class="n">y_pred_lr</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_lr</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_lr</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_lr</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LR ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LR ventana 7 días 3.69s
LR ventana 14 días 3.75s
LR ventana 21 días 3.94s
LR ventana 28 días 4.11s
</pre></div>
</div>
</div>
</div>
<p>LR ventana 7 días 3.69s</p>
<p>LR ventana 14 días 3.75s</p>
<p>LR ventana 21 días 3.94s</p>
<p>LR ventana 28 días 4.11s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 4 ─ REGRESIÓN LINEAL MÉTRICAS</span>
<span class="n">res_lr</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_lr</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_lr</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_lr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_lr</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_lr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana LR&quot;</span><span class="p">,</span> <span class="n">df_lr</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>

<span class="n">df_lr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE        R2      LB_p
7  1.646e+08 4.975e-01 1.282e+00 1.643e+00 4.891e-02 0.000e+00
14 1.545e+08 4.733e-01 1.013e+00 1.027e+00 4.057e-01 0.000e+00
21 1.519e+08 4.612e-01 8.246e-01 6.800e-01 6.065e-01 0.000e+00
28 1.518e+08 4.584e-01 7.998e-01 6.397e-01 6.299e-01 0.000e+00
Mejor ventana LR 28
</pre></div>
</div>
<div class="output text_html">
  <div id="df-9a44e8d7-ad83-452b-8914-6f4d049647e3" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>1.646e+08</td>
      <td>4.975e-01</td>
      <td>1.282e+00</td>
      <td>1.643e+00</td>
      <td>4.891e-02</td>
      <td>0.000e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.545e+08</td>
      <td>4.733e-01</td>
      <td>1.013e+00</td>
      <td>1.027e+00</td>
      <td>4.057e-01</td>
      <td>0.000e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.519e+08</td>
      <td>4.612e-01</td>
      <td>8.246e-01</td>
      <td>6.800e-01</td>
      <td>6.065e-01</td>
      <td>0.000e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.518e+08</td>
      <td>4.584e-01</td>
      <td>7.998e-01</td>
      <td>6.397e-01</td>
      <td>6.299e-01</td>
      <td>0.000e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9a44e8d7-ad83-452b-8914-6f4d049647e3')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9a44e8d7-ad83-452b-8914-6f4d049647e3 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9a44e8d7-ad83-452b-8914-6f4d049647e3');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-eb3db217-6385-4bf8-9636-f13dd84cb380">
  <button class="colab-df-quickchart" onclick="quickchart('df-eb3db217-6385-4bf8-9636-f13dd84cb380')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-eb3db217-6385-4bf8-9636-f13dd84cb380 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_8a6a8dd2-3739-4d05-b58e-5fd09bc34f5a">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_lr')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_8a6a8dd2-3739-4d05-b58e-5fd09bc34f5a button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_lr');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>      <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">1.646e+08</span> <span class="mf">4.975e-01</span> <span class="mf">1.282e+00</span> <span class="mf">1.643e+00</span> <span class="mf">4.891e-02</span> <span class="mf">0.000e+00</span>
<span class="mi">14</span> <span class="mf">1.545e+08</span> <span class="mf">4.733e-01</span> <span class="mf">1.013e+00</span> <span class="mf">1.027e+00</span> <span class="mf">4.057e-01</span> <span class="mf">0.000e+00</span>
<span class="mi">21</span> <span class="mf">1.519e+08</span> <span class="mf">4.612e-01</span> <span class="mf">8.246e-01</span> <span class="mf">6.800e-01</span> <span class="mf">6.065e-01</span> <span class="mf">0.000e+00</span>
<span class="mi">28</span> <span class="mf">1.518e+08</span> <span class="mf">4.584e-01</span> <span class="mf">7.998e-01</span> <span class="mf">6.397e-01</span> <span class="mf">6.299e-01</span> <span class="mf">0.000e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">LR</span> <span class="mi">28</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">1.646e+08</span>	<span class="mf">4.975e-01</span>	<span class="mf">1.282e+00</span>	<span class="mf">1.643e+00</span>	<span class="mf">4.891e-02</span>	<span class="mf">0.000e+00</span>
<span class="mi">14</span>	<span class="mf">1.545e+08</span>	<span class="mf">4.733e-01</span>	<span class="mf">1.013e+00</span>	<span class="mf">1.027e+00</span>	<span class="mf">4.057e-01</span>	<span class="mf">0.000e+00</span>
<span class="mi">21</span>	<span class="mf">1.519e+08</span>	<span class="mf">4.612e-01</span>	<span class="mf">8.246e-01</span>	<span class="mf">6.800e-01</span>	<span class="mf">6.065e-01</span>	<span class="mf">0.000e+00</span>
<span class="mi">28</span>	<span class="mf">1.518e+08</span>	<span class="mf">4.584e-01</span>	<span class="mf">7.998e-01</span>	<span class="mf">6.397e-01</span>	<span class="mf">6.299e-01</span>	<span class="mf">0.000e+00</span>

</pre></div>
</div>
  <div style="background-color: #f5fdf9; padding: 12px;">
    <h3><strong>💡Análisis del Modelo de Regresión Lineal</strong></h3>
    <p>A continuación, se presenta el análisis de los resultados obtenidos con el modelo de Regresión Lineal para diferentes tamaños de ventana (T = 7, 14, 21, 28).</p>
    <hr>
    <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3>
    <h4><strong>1.1. Reducción del Error</strong></h4>
    <ul>
      <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye ligeramente con el aumento del tamaño de la ventana:
        <ul>
          <li>T=7: <code>1.646e+08</code></li>
          <li>T=28: <code>1.518e+08</code> (reducción del 7.8%)</li>
        </ul>
      </li>
      <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto también disminuye:
        <ul>
          <li>T=7: <code>4.975e-01</code></li>
          <li>T=28: <code>4.584e-01</code> (reducción del 7.9%)</li>
        </ul>
      </li>
      <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio muestra una mejora significativa:
        <ul>
          <li>T=7: <code>1.282e+00</code></li>
          <li>T=28: <code>7.998e-01</code> (reducción del 37.7%)</li>
        </ul>
      </li>
      <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue la misma tendencia:
        <ul>
          <li>T=7: <code>1.643e+00</code></li>
          <li>T=28: <code>6.397e-01</code> (reducción del 61.0%)</li>
        </ul>
      </li>
    </ul>
    <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4>
    <ul>
      <li><strong>R2:</strong> El coeficiente de determinación aumenta con el tamaño de la ventana:
        <ul>
          <li>T=7: <code>4.891e-02</code> (R2=0.049)</li>
          <li>T=28: <code>6.299e-01</code> (R2=0.629)</li>
        </ul>
      </li>
    </ul>
    <hr>
    <h3><strong>2. Comparación con el Modelo KNN</strong></h3>
    <ul>
      <li><strong>MAPE:</strong> El modelo de Regresión Lineal muestra un MAPE significativamente menor:
        <ul>
          <li>T=28: <code>1.518e+08</code> (Regresión Lineal) vs. <code>2.166e+08</code> (KNN)</li>
        </ul>
      </li>
      <li><strong>R2:</strong> Aunque mejora, sigue ligeramente por debajo del modelo KNN:
        <ul>
          <li>T=28: <code>6.299e-01</code> (Regresión Lineal) vs. <code>6.565e-01</code> (KNN)</li>
        </ul>
      </li>
    </ul>
    <hr>
    <h3><strong>3. Ventana Óptima</strong></h3>
    <p>La ventana de tamaño <strong>T=28</strong> muestra los mejores resultados:</p>
    <ul>
      <li><strong>MAPE más bajo:</strong> <code>1.518e+08</code></li>
      <li><strong>RMSE más bajo:</strong> <code>7.998e-01</code></li>
      <li><strong>MSE más bajo:</strong> <code>6.397e-01</code></li>
      <li><strong>R2 más alto:</strong> <code>6.299e-01</code></li>
    </ul>
    <hr>
    <h3><strong>Conclusión</strong></h3>
    <p>El modelo de Regresión Lineal mejora sus métricas con ventanas mayores y supera al modelo KNN en MAPE y RMSE, pero su capacidad de capturar la dinámica temporal sigue siendo limitada.</p>
  </div>
</div>
</section>
<section id="codigo-de-ridge">
<h2>Codigo de Ridge<a class="headerlink" href="#codigo-de-ridge" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 5 ─ RIDGE ENTRENAMIENTO</span>
<span class="n">modelo_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<span class="n">y_true_ridge</span><span class="p">,</span> <span class="n">y_pred_ridge</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_ridge</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_ridge</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_ridge</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ridge ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ridge ventana 7 días 4.03s
Ridge ventana 14 días 4.18s
Ridge ventana 21 días 4.18s
Ridge ventana 28 días 4.32s
</pre></div>
</div>
</div>
</div>
<p>Ridge ventana 7 días 4.03s</p>
<p>Ridge ventana 14 días 4.18s</p>
<p>Ridge ventana 21 días 4.18s</p>
<p>Ridge ventana 28 días 4.32s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 6 ─ RIDGE MÉTRICAS</span>
<span class="n">res_ridge</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_ridge</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_ridge</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_ridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_ridge</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_ridge</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana Ridge&quot;</span><span class="p">,</span> <span class="n">df_ridge</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>
<span class="n">df_ridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE        R2      LB_p
7  1.571e+08 4.794e-01 7.274e-01 5.290e-01 6.937e-01 0.000e+00
14 1.530e+08 4.644e-01 7.183e-01 5.160e-01 7.014e-01 0.000e+00
21 1.518e+08 4.602e-01 8.000e-01 6.400e-01 6.296e-01 0.000e+00
28 1.519e+08 4.578e-01 7.828e-01 6.127e-01 6.454e-01 0.000e+00
Mejor ventana Ridge 14
</pre></div>
</div>
<div class="output text_html">
  <div id="df-c0581d50-d4e5-48ae-928b-159a9a292f85" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>1.571e+08</td>
      <td>4.794e-01</td>
      <td>7.274e-01</td>
      <td>5.290e-01</td>
      <td>6.937e-01</td>
      <td>0.000e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.530e+08</td>
      <td>4.644e-01</td>
      <td>7.183e-01</td>
      <td>5.160e-01</td>
      <td>7.014e-01</td>
      <td>0.000e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.518e+08</td>
      <td>4.602e-01</td>
      <td>8.000e-01</td>
      <td>6.400e-01</td>
      <td>6.296e-01</td>
      <td>0.000e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.519e+08</td>
      <td>4.578e-01</td>
      <td>7.828e-01</td>
      <td>6.127e-01</td>
      <td>6.454e-01</td>
      <td>0.000e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c0581d50-d4e5-48ae-928b-159a9a292f85')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c0581d50-d4e5-48ae-928b-159a9a292f85 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c0581d50-d4e5-48ae-928b-159a9a292f85');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a3df13a4-af0c-4f9a-a271-4db0211df357">
  <button class="colab-df-quickchart" onclick="quickchart('df-a3df13a4-af0c-4f9a-a271-4db0211df357')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a3df13a4-af0c-4f9a-a271-4db0211df357 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_e402d00a-23ba-4af5-840f-2addbdd702a6">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_ridge')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_e402d00a-23ba-4af5-840f-2addbdd702a6 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_ridge');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>      <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">1.571e+08</span> <span class="mf">4.794e-01</span> <span class="mf">7.274e-01</span> <span class="mf">5.290e-01</span> <span class="mf">6.937e-01</span> <span class="mf">0.000e+00</span>
<span class="mi">14</span> <span class="mf">1.530e+08</span> <span class="mf">4.644e-01</span> <span class="mf">7.183e-01</span> <span class="mf">5.160e-01</span> <span class="mf">7.014e-01</span> <span class="mf">0.000e+00</span>
<span class="mi">21</span> <span class="mf">1.518e+08</span> <span class="mf">4.602e-01</span> <span class="mf">8.000e-01</span> <span class="mf">6.400e-01</span> <span class="mf">6.296e-01</span> <span class="mf">0.000e+00</span>
<span class="mi">28</span> <span class="mf">1.519e+08</span> <span class="mf">4.578e-01</span> <span class="mf">7.828e-01</span> <span class="mf">6.127e-01</span> <span class="mf">6.454e-01</span> <span class="mf">0.000e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">Ridge</span> <span class="mi">14</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">1.571e+08</span>	<span class="mf">4.794e-01</span>	<span class="mf">7.274e-01</span>	<span class="mf">5.290e-01</span>	<span class="mf">6.937e-01</span>	<span class="mf">0.000e+00</span>
<span class="mi">14</span>	<span class="mf">1.530e+08</span>	<span class="mf">4.644e-01</span>	<span class="mf">7.183e-01</span>	<span class="mf">5.160e-01</span>	<span class="mf">7.014e-01</span>	<span class="mf">0.000e+00</span>
<span class="mi">21</span>	<span class="mf">1.518e+08</span>	<span class="mf">4.602e-01</span>	<span class="mf">8.000e-01</span>	<span class="mf">6.400e-01</span>	<span class="mf">6.296e-01</span>	<span class="mf">0.000e+00</span>
<span class="mi">28</span>	<span class="mf">1.519e+08</span>	<span class="mf">4.578e-01</span>	<span class="mf">7.828e-01</span>	<span class="mf">6.127e-01</span>	<span class="mf">6.454e-01</span>	<span class="mf">0.000e+00</span>

</pre></div>
</div>
  <div style="background-color: #f5fdf9; padding: 12px;">
    <p><strong>💡Análisis de los Resultados del Modelo Ridge</strong></p>
    <p>El modelo Ridge se corrio con diferentes tamaños de ventana (7, 14, 21, y 28).</p>
    <h4>1. Mejora en las Métricas con el Tamaño de la Ventana</h4>
    <strong>MAPE (Mean Absolute Percentage Error):</strong>
    <ul>
      <li>T=7: 1.571e+08</li>
      <li>T=14: 1.530e+08 (mejora del 2.6%)</li>
      <li>T=21: 1.518e+08 (mejora del 3.4% respecto a T=7)</li>
      <li>T=28: 1.519e+08 (similar a T=21)</li>
    </ul>
    <p>El MAPE sigue siendo muy elevado, lo cual indica un alto error porcentual en las predicciones.</p>
    <strong>MAE (Mean Absolute Error):</strong>
    <ul>
      <li>T=7: 4.794e-01</li>
      <li>T=14: 4.644e-01 (mejora del 3.2%)</li>
      <li>T=21: 4.602e-01 (mejora del 3.9% respecto a T=7)</li>
      <li>T=28: 4.578e-01 (mejora del 4.5% respecto a T=7)</li>
    </ul>
    <strong>RMSE (Root Mean Squared Error):</strong>
    <ul>
      <li>T=7: 7.274e-01</li>
      <li>T=14: 7.183e-01 (mejora del 1.3%)</li>
      <li>T=21: 8.000e-01 (empeora en un 10.3% respecto a T=14)</li>
      <li>T=28: 7.828e-01 (mejora del 2.2% respecto a T=21)</li>
    </ul>
    <strong>MSE (Mean Squared Error):</strong>
    <ul>
      <li>T=7: 5.290e-01</li>
      <li>T=14: 5.160e-01 (mejora del 2.5%)</li>
      <li>T=21: 6.400e-01 (empeora en un 23.8% respecto a T=14)</li>
      <li>T=28: 6.127e-01 (mejora del 4.3% respecto a T=21)</li>
    </ul>
    <strong>R2 (R-squared):</strong>
    <ul>
      <li>T=7: 6.937e-01 (R2=0.693)</li>
      <li>T=14: 7.014e-01 (R2=0.701, mejora del 1.5%)</li>
      <li>T=21: 6.296e-01 (R2=0.629, empeora en un 10.8% respecto a T=14)</li>
      <li>T=28: 6.454e-01 (R2=0.645, mejora del 2.5% respecto a T=21)</li>
    </ul>
    <h4>2. Mejor Ventana</h4>
    <p>La mejor ventana para el modelo Ridge es T=14, ya que presenta:</p>
    <ul>
      <li>El MAPE más bajo: 1.530e+08</li>
      <li>El RMSE más bajo: 7.183e-01</li>
      <li>El MSE más bajo: 5.160e-01</li>
      <li>El R2 más alto: 7.014e-01 (R2=0.701)</li>
    </ul>
    <h4>3. Observaciones</h4>
    <strong>MAPE Elevado:</strong>
    <p>Los valores de MAPE son extremadamente altos en todas las ventanas, lo que indica un error porcentual significativo en las predicciones. Esto podría darse por:</p>
    <ul>
      <li>Escala de las variables: Las variables explicativas o la variable objetivo podrían tener una escala muy grande.</li>
      <li>Ruido en los datos: La presencia de ruido o outliers podría estar afectando el rendimiento del modelo.</li>
    </ul>
    <strong>Autocorrelación en Residuos:</strong>
    <p>El valor LB_p es 0.e+00 en todas las ventanas, lo que indica autocorrelación significativa en los residuos. Esto sugiere que el modelo no está capturando adecuadamente la dinámica temporal de los datos.</p>
    <strong>Rendimiento Inconsistente:</strong>
    <p>Para T=21, se observa un empeoramiento en el RMSE y el MSE respecto a T=14, lo que podría indicar sobreajuste o la presencia de ruido en los datos para este tamaño de ventana.</p>
    <h4>4. Comparación con Otros Modelos</h4>
    <strong>Modelo de Regresión Lineal:</strong>
    <p>En comparación con los resultados de la Regresión Lineal, el modelo Ridge presenta un mejor R2 y menores valores de MAE y RMSE para la mayoría de las ventanas. Sin embargo, el MAPE sigue siendo muy elevado en ambos modelos.</p>
    <strong>Modelo KNN:</strong>
    <p>El modelo Ridge muestra un mejor desempeño en términos de MAE, RMSE y MSE en casi todas las ventanas, y un R2 comparable o superior.</p>
    <h4>5. Conclusión</h4>
    <p>El modelo Ridge muestra un rendimiento superior en comparación con los otros modelos evaluados, especialmente para la ventana T=14. Sin embargo, los altos valores de MAPE y la autocorrelación en los residuos sugieren que el modelo aún no está capturando adecuadamente la dinámica temporal de los datos.</p>
  </div>
</div>
</section>
<section id="codigo-de-lasso">
<h2>Codigo de Lasso<a class="headerlink" href="#codigo-de-lasso" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 7 ─ LASSO ENTRENAMIENTO</span>
<span class="n">modelo_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">y_true_lasso</span><span class="p">,</span> <span class="n">y_pred_lasso</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_lasso</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_lasso</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_lasso</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lasso ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lasso ventana 7 días 4.25s
Lasso ventana 14 días 4.40s
Lasso ventana 21 días 4.38s
Lasso ventana 28 días 4.49s
</pre></div>
</div>
</div>
</div>
<p>Lasso ventana 7 días 4.25s</p>
<p>Lasso ventana 14 días 4.40s</p>
<p>Lasso ventana 21 días 4.38s</p>
<p>Lasso ventana 28 días 4.49s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 8 ─ LASSO MÉTRICAS</span>
<span class="n">res_lasso</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_lasso</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_lasso</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_lasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_lasso</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_lasso</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana Lasso&quot;</span><span class="p">,</span> <span class="n">df_lasso</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>
<span class="n">df_lasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE        R2    LB_p
7  3.530e+08 7.098e-01 9.081e-01 8.247e-01 5.225e-01  0.e+00
14 3.441e+08 6.654e-01 8.482e-01 7.195e-01 5.836e-01  0.e+00
21 3.387e+08 6.476e-01 8.254e-01 6.812e-01 6.057e-01  0.e+00
28 3.356e+08 6.392e-01 8.142e-01 6.629e-01 6.165e-01  0.e+00
Mejor ventana Lasso 28
</pre></div>
</div>
<div class="output text_html">
  <div id="df-d7730681-d407-4a4c-b06d-080dd640b3e6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>3.530e+08</td>
      <td>7.098e-01</td>
      <td>9.081e-01</td>
      <td>8.247e-01</td>
      <td>5.225e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>3.441e+08</td>
      <td>6.654e-01</td>
      <td>8.482e-01</td>
      <td>7.195e-01</td>
      <td>5.836e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>3.387e+08</td>
      <td>6.476e-01</td>
      <td>8.254e-01</td>
      <td>6.812e-01</td>
      <td>6.057e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>3.356e+08</td>
      <td>6.392e-01</td>
      <td>8.142e-01</td>
      <td>6.629e-01</td>
      <td>6.165e-01</td>
      <td>0.e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d7730681-d407-4a4c-b06d-080dd640b3e6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d7730681-d407-4a4c-b06d-080dd640b3e6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d7730681-d407-4a4c-b06d-080dd640b3e6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e3b00378-06fc-4c6e-98f6-93df21c60da6">
  <button class="colab-df-quickchart" onclick="quickchart('df-e3b00378-06fc-4c6e-98f6-93df21c60da6')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e3b00378-06fc-4c6e-98f6-93df21c60da6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_be5cc5eb-3d62-4706-bb20-473a5158a083">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_lasso')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_be5cc5eb-3d62-4706-bb20-473a5158a083 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_lasso');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>    <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">3.530e+08</span> <span class="mf">7.098e-01</span> <span class="mf">9.081e-01</span> <span class="mf">8.247e-01</span> <span class="mf">5.225e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">14</span> <span class="mf">3.441e+08</span> <span class="mf">6.654e-01</span> <span class="mf">8.482e-01</span> <span class="mf">7.195e-01</span> <span class="mf">5.836e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">21</span> <span class="mf">3.387e+08</span> <span class="mf">6.476e-01</span> <span class="mf">8.254e-01</span> <span class="mf">6.812e-01</span> <span class="mf">6.057e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">28</span> <span class="mf">3.356e+08</span> <span class="mf">6.392e-01</span> <span class="mf">8.142e-01</span> <span class="mf">6.629e-01</span> <span class="mf">6.165e-01</span>  <span class="mf">0.e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">Lasso</span> <span class="mi">28</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">3.530e+08</span>	<span class="mf">7.098e-01</span>	<span class="mf">9.081e-01</span>	<span class="mf">8.247e-01</span>	<span class="mf">5.225e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">14</span>	<span class="mf">3.441e+08</span>	<span class="mf">6.654e-01</span>	<span class="mf">8.482e-01</span>	<span class="mf">7.195e-01</span>	<span class="mf">5.836e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">21</span>	<span class="mf">3.387e+08</span>	<span class="mf">6.476e-01</span>	<span class="mf">8.254e-01</span>	<span class="mf">6.812e-01</span>	<span class="mf">6.057e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">28</span>	<span class="mf">3.356e+08</span>	<span class="mf">6.392e-01</span>	<span class="mf">8.142e-01</span>	<span class="mf">6.629e-01</span>	<span class="mf">6.165e-01</span>	<span class="mf">0.e+00</span>

</pre></div>
</div>
<div style="background-color: #f5fdf9; padding: 12px;"> <h3><strong>💡Análisis del Modelo Lasso</strong></h3> <p>A continuación, se presenta el análisis de los resultados obtenidos con el modelo Lasso para diferentes tamaños de ventana (T = 7, 28).</p> <hr> <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3> <h4><strong>1.1. Reducción del Error</strong></h4> <ul> <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye ligeramente con el aumento del tamaño de la ventana: <ul> <li>T=7: <code>3.530e+08</code></li> <li>T=28: <code>3.356e+08</code> (reducción del 4.9%)</li> </ul> </li> <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto también disminuye: <ul> <li>T=7: <code>7.098e-01</code></li> <li>T=28: <code>6.392e-01</code> (reducción del 9.9%)</li> </ul> </li> <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio muestra una mejora: <ul> <li>T=7: <code>9.081e-01</code></li> <li>T=28: <code>8.142e-01</code> (reducción del 10.3%)</li> </ul> </li> <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue una tendencia similar: <ul> <li>T=7: <code>8.247e-01</code></li> <li>T=28: <code>6.629e-01</code> (reducción del 19.8%)</li> </ul> </li> </ul> <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4> <ul> <li><strong>R2:</strong> El coeficiente de determinación aumenta con el tamaño de la ventana: <ul> <li>T=7: <code>5.225e-01</code> (R2=0.522)</li> <li>T=28: <code>6.165e-01</code> (R2=0.616)</li> </ul> </li> </ul> <hr> <h3><strong>2. Ventana Óptima</strong></h3> <p>La ventana de tamaño <strong>T=28</strong> muestra los mejores resultados:</p> <ul> <li><strong>MAPE más bajo:</strong> <code>3.356e+08</code></li> <li><strong>RMSE más bajo:</strong> <code>8.142e-01</code></li> <li><strong>MSE más bajo:</strong> <code>6.629e-01</code></li> <li><strong>R2 más alto:</strong> <code>6.165e-01</code></li> </ul> <hr> <h3><strong>3. Observaciones</strong></h3> <ul> <li><strong>MAPE Elevado:</strong> Los valores de MAPE siguen siendo muy altos, lo que podría deberse a: <ul> <li>Escala de las variables.</li> </li> <li>Limitaciones del modelo Lasso para capturar relaciones no lineales.</li> </ul> </li> <li><strong>Autocorrelación en los residuos:</strong> El valor LB_p es 0.e+00 en todas las ventanas, indicando que el modelo no captura adecuadamente la dinámica temporal.</li> </ul> <hr> <h3> <h3><strong>Conclusión</strong></h3> <p>El modelo Lasso mejora sus métricas con ventanas mayores, alcanzando su mejor desempeño en T=28. Sin embargo, presenta limitaciones importantes, especialmente en el MAPE y la autocorrelación de los residuos, lo que sugiere la necesidad de ajustes adicionales o el uso de modelos más complejos para capturar la dinámica de los datos.</p> </div></section>
<section id="codigo-de-arbol-de-decision">
<h2>Codigo de Arbol de decision<a class="headerlink" href="#codigo-de-arbol-de-decision" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 9 ─ ÁRBOL DE DECISIÓN ENTRENAMIENTO</span>
<span class="n">modelo_dt</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y_true_dt</span><span class="p">,</span> <span class="n">y_pred_dt</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_dt</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_dt</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_dt</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DT ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DT ventana 7 días 5.83s
DT ventana 14 días 7.71s
DT ventana 21 días 9.49s
DT ventana 28 días 11.12s
</pre></div>
</div>
</div>
</div>
<p>DT ventana 7 días 5.83s</p>
<p>DT ventana 14 días 7.71s</p>
<p>DT ventana 21 días 9.49s</p>
<p>DT ventana 28 días 11.12s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 10 ─ ÁRBOL DE DECISIÓN MÉTRICAS</span>
<span class="n">res_dt</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_dt</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_dt</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_dt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_dt</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana DT&quot;</span><span class="p">,</span> <span class="n">df_dt</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>
<span class="n">df_dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE        R2    LB_p
7  1.740e+08 6.015e-01 8.064e-01 6.503e-01 6.235e-01  0.e+00
14 1.537e+08 5.500e-01 7.399e-01 5.475e-01 6.832e-01  0.e+00
21 1.552e+08 5.283e-01 7.117e-01 5.065e-01 7.068e-01  0.e+00
28 1.489e+08 5.145e-01 6.918e-01 4.786e-01 7.231e-01  0.e+00
Mejor ventana DT 28
</pre></div>
</div>
<div class="output text_html">
  <div id="df-e3cc6687-61a4-4d05-a35f-201108deb25f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>1.740e+08</td>
      <td>6.015e-01</td>
      <td>8.064e-01</td>
      <td>6.503e-01</td>
      <td>6.235e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.537e+08</td>
      <td>5.500e-01</td>
      <td>7.399e-01</td>
      <td>5.475e-01</td>
      <td>6.832e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.552e+08</td>
      <td>5.283e-01</td>
      <td>7.117e-01</td>
      <td>5.065e-01</td>
      <td>7.068e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.489e+08</td>
      <td>5.145e-01</td>
      <td>6.918e-01</td>
      <td>4.786e-01</td>
      <td>7.231e-01</td>
      <td>0.e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e3cc6687-61a4-4d05-a35f-201108deb25f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e3cc6687-61a4-4d05-a35f-201108deb25f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e3cc6687-61a4-4d05-a35f-201108deb25f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-200c397f-5079-46e5-a956-ef064a556cd9">
  <button class="colab-df-quickchart" onclick="quickchart('df-200c397f-5079-46e5-a956-ef064a556cd9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-200c397f-5079-46e5-a956-ef064a556cd9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_6d4c1777-1c38-48cf-a968-6bc7bfbc812a">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_dt')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_6d4c1777-1c38-48cf-a968-6bc7bfbc812a button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_dt');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>    <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">1.740e+08</span> <span class="mf">6.015e-01</span> <span class="mf">8.064e-01</span> <span class="mf">6.503e-01</span> <span class="mf">6.235e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">14</span> <span class="mf">1.537e+08</span> <span class="mf">5.500e-01</span> <span class="mf">7.399e-01</span> <span class="mf">5.475e-01</span> <span class="mf">6.832e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">21</span> <span class="mf">1.552e+08</span> <span class="mf">5.283e-01</span> <span class="mf">7.117e-01</span> <span class="mf">5.065e-01</span> <span class="mf">7.068e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">28</span> <span class="mf">1.489e+08</span> <span class="mf">5.145e-01</span> <span class="mf">6.918e-01</span> <span class="mf">4.786e-01</span> <span class="mf">7.231e-01</span>  <span class="mf">0.e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">DT</span> <span class="mi">28</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">1.740e+08</span>	<span class="mf">6.015e-01</span>	<span class="mf">8.064e-01</span>	<span class="mf">6.503e-01</span>	<span class="mf">6.235e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">14</span>	<span class="mf">1.537e+08</span>	<span class="mf">5.500e-01</span>	<span class="mf">7.399e-01</span>	<span class="mf">5.475e-01</span>	<span class="mf">6.832e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">21</span>	<span class="mf">1.552e+08</span>	<span class="mf">5.283e-01</span>	<span class="mf">7.117e-01</span>	<span class="mf">5.065e-01</span>	<span class="mf">7.068e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">28</span>	<span class="mf">1.489e+08</span>	<span class="mf">5.145e-01</span>	<span class="mf">6.918e-01</span>	<span class="mf">4.786e-01</span>	<span class="mf">7.231e-01</span>	<span class="mf">0.e+00</span>
</pre></div>
</div>
<div style="background-color: #f5fdf9; padding: 12px;"> <h3><strong>💡Análisis del Modelo de Árbol de Decisión</strong></h3> <p>A continuación, se presenta el análisis de los resultados obtenidos con el modelo de Árbol de Decisión para diferentes tamaños de ventana (T = 7, 28).</p> <hr> <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3> <h4><strong>1.1. Reducción del Error</strong></h4> <ul> <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye con el aumento del tamaño de la ventana: <ul> <li>T=7: <code>1.740e+08</code></li> <li>T=28: <code>1.489e+08</code> (reducción del 14.5%)</li> </ul> </li> <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto también disminuye: <ul> <li>T=7: <code>6.015e-01</code></li> <li>T=28: <code>5.145e-01</code> (reducción del 14.5%)</li> </ul> </li> <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio muestra una mejora: <ul> <li>T=7: <code>8.064e-01</code></li> <li>T=28: <code>6.918e-01</code> (reducción del 14.2%)</li> </ul> </li> <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue una tendencia similar: <ul> <li>T=7: <code>6.503e-01</code></li> <li>T=28: <code>4.786e-01</code> (reducción del 26.4%)</li> </ul> </li> </ul> <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4> <ul> <li><strong>R2:</strong> El coeficiente de determinación mejora con el tamaño de la ventana: <ul> <li>T=7: <code>6.235e-01</code> (R2=0.623)</li> <li>T=28: <code>7.231e-01</code> (R2=0.723)</li> </ul> </li> </ul> <hr> <h3><strong>2. Mejor Ventana</strong></h3> <p>La ventana de tamaño <strong>T=28</strong> muestra los mejores resultados:</p> <ul> <li><strong>MAPE más bajo:</strong> <code>1.489e+08</code></li> <li><strong>MAE más bajo:</strong> <code>5.145e-01</code></li> <li><strong>RMSE más bajo:</strong> <code>6.918e-01</code></li> <li><strong>MSE más bajo:</strong> <code>4.786e-01</code></li> <li><strong>R2 más alto:</strong> <code>7.231e-01</code></li> </ul> <hr> <h3><strong>3. Observaciones</strong></h3> <ul> <li><strong>MAPE Elevado:</strong> Aunque mejora con ventanas más grandes, sigue siendo alto debido posiblemente a: <ul> <li>Relaciones no lineales no capturadas completamente.</li></li> </ul> </li> <li><strong>Autocorrelación en Residuos:</strong> El valor <code>LB_p=0.e+00</code> en todas las ventanas indica fuerte autocorrelación, reflejando que el modelo no captura bien la dinámica temporal.</li> <li><strong>Sobreajuste Potencial:</strong> La mejora al aumentar el tamaño de la ventana puede estar asociada a una mejor generalización del modelo ante más datos.</li> </ul> <hr> <h3><strong>4. Comparación con los anteriores Modelos</strong></h3> <ul> <li><strong>Modelo Lasso:</strong> El Árbol de Decisión supera ampliamente al Lasso, especialmente en R2.</li> <li><strong>Modelo Ridge:</strong> Mejor R2 en ventanas grandes comparado con Ridge.</li> <li><strong>Modelo KNN:</strong> Mejor R2 y menores errores en todas las ventanas.</li> <li><strong>Regresión Lineal:</strong> Supera ampliamente en R2 y errores a la Regresión Lineal.</li> </ul> <hr> <h3><strong>Conclusión</strong></h3> <p>El modelo de Árbol de Decisión muestra mejoras claras con ventanas más grandes, siendo <strong>T=28</strong> el mejor escenario. No obstante, los altos valores de MAPE y la autocorrelación en los residuos indican la necesidad de explorar métodos más robustos y complejos para mejorar el desempeño predictivo.</p> </div></section>
<section id="codigo-de-random-forest">
<h2>Codigo de Random Forest<a class="headerlink" href="#codigo-de-random-forest" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 11 ─ RANDOM FOREST ENTRENAMIENTO</span>
<span class="n">modelo_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_true_rf</span><span class="p">,</span> <span class="n">y_pred_rf</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_rf</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_rf</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_rf</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RF ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RF ventana 7 días 173.92s
RF ventana 14 días 185.76s
RF ventana 21 días 201.95s
RF ventana 28 días 206.32s
</pre></div>
</div>
</div>
</div>
<p>RF ventana 7 días 173.92s</p>
<p>RF ventana 14 días 185.76s</p>
<p>RF ventana 21 días 201.95s</p>
<p>RF ventana 28 días 206.32s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 12 ─ RANDOM FOREST MÉTRICAS</span>
<span class="n">res_rf</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_rf</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_rf</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_rf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_rf</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_rf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana RF&quot;</span><span class="p">,</span> <span class="n">df_rf</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>
<span class="n">df_rf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE        R2    LB_p
7  1.816e+08 5.088e-01 6.694e-01 4.481e-01 7.405e-01  0.e+00
14 1.616e+08 4.877e-01 6.418e-01 4.119e-01 7.617e-01  0.e+00
21 1.565e+08 4.803e-01 6.339e-01 4.018e-01 7.674e-01  0.e+00
28 1.514e+08 4.763e-01 6.280e-01 3.944e-01 7.718e-01  0.e+00
Mejor ventana RF 28
</pre></div>
</div>
<div class="output text_html">
  <div id="df-3c6a8aa5-69de-4061-ab61-78cf82fbfba4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>1.816e+08</td>
      <td>5.088e-01</td>
      <td>6.694e-01</td>
      <td>4.481e-01</td>
      <td>7.405e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.616e+08</td>
      <td>4.877e-01</td>
      <td>6.418e-01</td>
      <td>4.119e-01</td>
      <td>7.617e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.565e+08</td>
      <td>4.803e-01</td>
      <td>6.339e-01</td>
      <td>4.018e-01</td>
      <td>7.674e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.514e+08</td>
      <td>4.763e-01</td>
      <td>6.280e-01</td>
      <td>3.944e-01</td>
      <td>7.718e-01</td>
      <td>0.e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3c6a8aa5-69de-4061-ab61-78cf82fbfba4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3c6a8aa5-69de-4061-ab61-78cf82fbfba4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3c6a8aa5-69de-4061-ab61-78cf82fbfba4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f6dff05e-a0af-4454-877b-75d50fc80318">
  <button class="colab-df-quickchart" onclick="quickchart('df-f6dff05e-a0af-4454-877b-75d50fc80318')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f6dff05e-a0af-4454-877b-75d50fc80318 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_dff77fb0-d629-43a7-911b-84365d93e9bb">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_rf')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_dff77fb0-d629-43a7-911b-84365d93e9bb button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_rf');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>    <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">1.816e+08</span> <span class="mf">5.088e-01</span> <span class="mf">6.694e-01</span> <span class="mf">4.481e-01</span> <span class="mf">7.405e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">14</span> <span class="mf">1.616e+08</span> <span class="mf">4.877e-01</span> <span class="mf">6.418e-01</span> <span class="mf">4.119e-01</span> <span class="mf">7.617e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">21</span> <span class="mf">1.565e+08</span> <span class="mf">4.803e-01</span> <span class="mf">6.339e-01</span> <span class="mf">4.018e-01</span> <span class="mf">7.674e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">28</span> <span class="mf">1.514e+08</span> <span class="mf">4.763e-01</span> <span class="mf">6.280e-01</span> <span class="mf">3.944e-01</span> <span class="mf">7.718e-01</span>  <span class="mf">0.e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">RF</span> <span class="mi">28</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">1.816e+08</span>	<span class="mf">5.088e-01</span>	<span class="mf">6.694e-01</span>	<span class="mf">4.481e-01</span>	<span class="mf">7.405e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">14</span>	<span class="mf">1.616e+08</span>	<span class="mf">4.877e-01</span>	<span class="mf">6.418e-01</span>	<span class="mf">4.119e-01</span>	<span class="mf">7.617e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">21</span>	<span class="mf">1.565e+08</span>	<span class="mf">4.803e-01</span>	<span class="mf">6.339e-01</span>	<span class="mf">4.018e-01</span>	<span class="mf">7.674e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">28</span>	<span class="mf">1.514e+08</span>	<span class="mf">4.763e-01</span>	<span class="mf">6.280e-01</span>	<span class="mf">3.944e-01</span>	<span class="mf">7.718e-01</span>	<span class="mf">0.e+00</span>
</pre></div>
</div>
<div style="background-color: #f5fdf9; padding: 12px;"> <h3><strong>💡Análisis de los Resultados del Modelo Random Forest</strong></h3> <p>A continuación, se realiza el análisis de los resultados obtenidos con el modelo Random Forest, utilizando diferentes tamaños de ventana (T = 7, 14, 21, 28).</p> <hr> <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3> <h4><strong>1.1. Reducción del Error</strong></h4> <ul> <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye gradualmente con el aumento del tamaño de la ventana: <ul> <li>T=7: <code>1.816e+08</code></li> <li>T=28: <code>1.514e+08</code> (reducción del 16.6%)</li> </ul> </li> <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto también disminuye con el aumento del tamaño de la ventana: <ul> <li>T=7: <code>5.088e-01</code></li> <li>T=28: <code>4.763e-01</code> (reducción del 6.3%)</li> </ul> </li> <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio muestra una mejora constante: <ul> <li>T=7: <code>6.694e-01</code></li> <li>T=28: <code>6.280e-01</code> (reducción del 6.1%)</li> </ul> </li> <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue una tendencia similar al RMSE: <ul> <li>T=7: <code>4.481e-01</code></li> <li>T=28: <code>3.944e-01</code> (reducción del 12.0%)</li> </ul> </li> </ul> <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4> <ul> <li><strong>R2:</strong> El coeficiente de determinación mejora con el tamaño de la ventana: <ul> <li>T=7: <code>7.405e-01</code> (R2=0.740)</li> <li>T=28: <code>7.718e-01</code> (R2=0.772)</li> </ul> </li> </ul> <hr> <h3><strong>2. Mejor Ventana</strong></h3> <p>La mejor ventana para el modelo Random Forest es <strong>T=28</strong>, ya que presenta:</p> <ul> <li><strong>MAPE más bajo:</strong> <code>1.514e+08</code></li> <li><strong>MAE más bajo:</strong> <code>4.763e-01</code></li> <li><strong>RMSE más bajo:</strong> <code>6.280e-01</code></li> <li><strong>MSE más bajo:</strong> <code>3.944e-01</code></li> <li><strong>R2 más alto:</strong> <code>7.718e-01</code></li> </ul> <hr> <h3><strong>3. Observaciones</strong></h3> <ul> <li><strong>MAPE Elevado:</strong> Aunque mejora con ventanas más grandes, los valores siguen siendo muy altos debido a: <ul> <li>Escala de las variables o de la variable objetivo.</li> </li> </ul> </li> <li><strong>Autocorrelación en Residuos:</strong> El valor <code>LB_p=0.e+00</code> en todas las ventanas indica autocorrelación significativa, reflejando que el modelo no captura adecuadamente la dinámica temporal.</li> </li> </ul> <hr> <h3><strong>4. Comparación con los Otros Modelos</strong></h3> <ul> <li><strong>Modelo de Árbol de Decisión:</strong> Random Forest supera al Árbol de Decisión en todas las métricas, especialmente en R2.</li> <li><strong>Modelo Lasso:</strong> Random Forest ofrece un mejor rendimiento en MAPE, MAE, RMSE, MSE y R2.</li> <li><strong>Modelo KNN:</strong> Random Forest muestra un mejor R2 y menores errores (MAE, RMSE) en todas las ventanas.</li> <li><strong>Modelo Ridge:</strong> En ventanas pequeñas (T=7 y T=14), Random Forest tiene un mejor R2 y menores errores que Ridge.</li> </ul> <hr> <h3><strong>Conclusión</strong></h3> <p>El modelo Random Forest muestra un rendimiento mejorado con ventanas más grandes, alcanzando su mejor desempeño en <strong>T=28</strong>. Sin embargo, los valores elevados de MAPE y la autocorrelación en los residuos sugieren que se necesita un enfoque más robusto para manejar la complejidad de los datos. Se recomienda explorar modelos más complejos, ajustar hiperparámetros y añadir características temporales para mejorar las predicciones.</p> </div></section>
<section id="codigo-de-xgboost">
<h2>Codigo de XGBoost<a class="headerlink" href="#codigo-de-xgboost" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 13 ─ XGBOOST ENTRENAMIENTO</span>
<span class="n">modelo_xgb</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">subsample</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">colsample_bytree</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">objective</span><span class="o">=</span><span class="s2">&quot;reg:squarederror&quot;</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="n">y_true_xgb</span><span class="p">,</span> <span class="n">y_pred_xgb</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_xgb</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_xgb</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_xgb</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XGB ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XGB ventana 7 días 76.78s
XGB ventana 14 días 81.64s
XGB ventana 21 días 83.22s
XGB ventana 28 días 88.77s
</pre></div>
</div>
</div>
</div>
<p>XGB ventana 7 días 76.78s</p>
<p>XGB ventana 14 días 81.64s</p>
<p>XGB ventana 21 días 83.22s</p>
<p>XGB ventana 28 días 88.77s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 14 ─ XGBOOST MÉTRICAS</span>
<span class="n">res_xgb</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_xgb</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_xgb</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_xgb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_xgb</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_xgb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana XGB&quot;</span><span class="p">,</span> <span class="n">df_xgb</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>
<span class="n">df_xgb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE        R2    LB_p
7  2.384e+08 5.554e-01 7.285e-01 5.307e-01 6.927e-01  0.e+00
14 2.098e+08 5.135e-01 6.747e-01 4.553e-01 7.365e-01  0.e+00
21 1.982e+08 4.937e-01 6.497e-01 4.221e-01 7.557e-01  0.e+00
28 1.903e+08 4.831e-01 6.360e-01 4.044e-01 7.660e-01  0.e+00
Mejor ventana XGB 28
</pre></div>
</div>
<div class="output text_html">
  <div id="df-36889588-9d0e-4346-9cde-0431c1d23e45" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>2.384e+08</td>
      <td>5.554e-01</td>
      <td>7.285e-01</td>
      <td>5.307e-01</td>
      <td>6.927e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2.098e+08</td>
      <td>5.135e-01</td>
      <td>6.747e-01</td>
      <td>4.553e-01</td>
      <td>7.365e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.982e+08</td>
      <td>4.937e-01</td>
      <td>6.497e-01</td>
      <td>4.221e-01</td>
      <td>7.557e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.903e+08</td>
      <td>4.831e-01</td>
      <td>6.360e-01</td>
      <td>4.044e-01</td>
      <td>7.660e-01</td>
      <td>0.e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-36889588-9d0e-4346-9cde-0431c1d23e45')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-36889588-9d0e-4346-9cde-0431c1d23e45 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-36889588-9d0e-4346-9cde-0431c1d23e45');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ae34ceaa-9d35-42cb-8d9f-293d64d74cbb">
  <button class="colab-df-quickchart" onclick="quickchart('df-ae34ceaa-9d35-42cb-8d9f-293d64d74cbb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ae34ceaa-9d35-42cb-8d9f-293d64d74cbb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_4c0292c7-87d1-4f22-91e8-ddfd088e19ec">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_xgb')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_4c0292c7-87d1-4f22-91e8-ddfd088e19ec button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_xgb');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>    <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">2.384e+08</span> <span class="mf">5.554e-01</span> <span class="mf">7.285e-01</span> <span class="mf">5.307e-01</span> <span class="mf">6.927e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">14</span> <span class="mf">2.098e+08</span> <span class="mf">5.135e-01</span> <span class="mf">6.747e-01</span> <span class="mf">4.553e-01</span> <span class="mf">7.365e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">21</span> <span class="mf">1.982e+08</span> <span class="mf">4.937e-01</span> <span class="mf">6.497e-01</span> <span class="mf">4.221e-01</span> <span class="mf">7.557e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">28</span> <span class="mf">1.903e+08</span> <span class="mf">4.831e-01</span> <span class="mf">6.360e-01</span> <span class="mf">4.044e-01</span> <span class="mf">7.660e-01</span>  <span class="mf">0.e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">XGB</span> <span class="mi">28</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">2.384e+08</span>	<span class="mf">5.554e-01</span>	<span class="mf">7.285e-01</span>	<span class="mf">5.307e-01</span>	<span class="mf">6.927e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">14</span>	<span class="mf">2.098e+08</span>	<span class="mf">5.135e-01</span>	<span class="mf">6.747e-01</span>	<span class="mf">4.553e-01</span>	<span class="mf">7.365e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">21</span>	<span class="mf">1.982e+08</span>	<span class="mf">4.937e-01</span>	<span class="mf">6.497e-01</span>	<span class="mf">4.221e-01</span>	<span class="mf">7.557e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">28</span>	<span class="mf">1.903e+08</span>	<span class="mf">4.831e-01</span>	<span class="mf">6.360e-01</span>	<span class="mf">4.044e-01</span>	<span class="mf">7.660e-01</span>	<span class="mf">0.e+00</span>

</pre></div>
</div>
<div style="background-color: #f5fdf9; padding: 12px;">
  <h3><strong>💡 Análisis del Modelo XGBoost</strong></h3>
  <p>Los resultados del modelo XGBoost para diferentes tamaños de ventana (T = 7, 14, 21, 28) muestran una mejora constante en las métricas a medida que aumenta el tamaño de la ventana.</p>
  <hr>
  <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3>
  <h4><strong>1.1. Reducción del Error</strong></h4>
  <ul>
    <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye significativamente con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>2.384e+08</code></li>
        <li>T=28: <code>1.903e+08</code> (reducción del 20.2%)</li>
      </ul>
    </li>
    <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto disminuye con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>5.554e-01</code></li>
        <li>T=28: <code>4.831e-01</code> (reducción del 13.1%)</li>
      </ul>
    </li>
    <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio muestra una mejora constante:
      <ul>
        <li>T=7: <code>7.285e-01</code></li>
        <li>T=28: <code>6.360e-01</code> (reducción del 12.7%)</li>
      </ul>
    </li>
    <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue una tendencia similar al RMSE:
      <ul>
        <li>T=7: <code>5.307e-01</code></li>
        <li>T=28: <code>4.044e-01</code> (reducción del 23.9%)</li>
      </ul>
    </li>
  </ul>
  <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4>
  <ul>
    <li><strong>R2:</strong> El coeficiente de determinación mejora con el tamaño de la ventana:
      <ul>
        <li>T=7: <code>6.927e-01</code> (R2=0.692)</li>
        <li>T=28: <code>7.660e-01</code> (R2=0.766)</li>
      </ul>
    </li>
  </ul>
  <hr>
  <h3><strong>2. Mejor Ventana</strong></h3>
  <p>La mejor ventana para el modelo XGBoost es <strong>T=28</strong>, ya que presenta:</p>
  <ul>
     <li><strong>MAPE más bajo:</strong> <code>1.903e+08</code></li>
     <li><strong>MAE más bajo:</strong> <code>4.831e-01</code></li>
     <li><strong>RMSE más bajo:</strong> <code>6.360e-01</code></li>
     <li><strong>MSE más bajo:</strong> <code>4.044e-01</code></li>
     <li><strong>R2 más alto:</strong> <code>7.660e-01</code></li>
  </ul>
  <hr>
  <h3><strong>3. Observaciones</strong></h3>
  <ul>
     <li><strong>MAPE Elevado:</strong> Aunque el MAPE mejora con ventanas más grandes, los valores siguen siendo altos, lo que indica un alto error porcentual en las predicciones. Esto podría deberse a:
      <ul>
        <li>Relaciones complejas que el modelo XGBoost no captura completamente.
     </ul>
     </li>
     <li><strong>Autocorrelación en Residuos:</strong> El valor <code>LB_p=0.e+00</code> en todas las ventanas indica autocorrelación significativa en los residuos, sugiriendo que el modelo no captura adecuadamente la dinámica temporal.</li>
  </ul>
  <hr>
  <h3><strong>4. Comparación con los Otros Modelos</strong></h3>
  <ul>
    <li><strong>Modelo Random Forest:</strong> XGBoost supera a Random Forest en todas las métricas, especialmente en R2.</li>
    <li><strong>Modelo de Árbol de Decisión:</strong> XGBoost ofrece un mejor rendimiento en MAPE, MAE, RMSE, MSE y R2.</li>
    <li><strong>Modelo Ridge:</strong> En ventanas más pequeñas (T=7 y T=14), XGBoost tiene un mejor R2 y menores errores que Ridge.</li>
    <li><strong>Modelo KNN:</strong> XGBoost muestra un mejor R2 y menores errores (MAE, RMSE) en todas las ventanas.</li>
  </ul>
  <hr>
  <h3><strong>Conclusión</strong></h3>
  <p>El modelo XGBoost muestra un rendimiento superior en comparación con otros modelos evaluados, alcanzando su mejor desempeño en <strong>T=28</strong>. Sin embargo, los altos valores de MAPE y la autocorrelación en los residuos sugieren que se necesita un enfoque más robusto para manejar la complejidad de los datos. </p>
</div></section>
<section id="codigo-de-svm">
<h2>Codigo de SVM<a class="headerlink" href="#codigo-de-svm" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 15 ─ SVM ENTRENAMIENTO</span>
<span class="n">modelo_svm</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s2">&quot;esc&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">))])</span>
<span class="n">y_true_svm</span><span class="p">,</span> <span class="n">y_pred_svm</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_svm</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_svm</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_svm</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SVM ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVM ventana 7 días 26.19s
SVM ventana 14 días 72.21s
SVM ventana 21 días 146.09s
SVM ventana 28 días 234.86s
</pre></div>
</div>
</div>
</div>
<p>SVM ventana 7 días 26.19s</p>
<p>SVM ventana 14 días 72.21s</p>
<p>SVM ventana 21 días 146.09s</p>
<p>SVM ventana 28 días 234.86s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 16 ─ SVM MÉTRICAS</span>
<span class="n">res_svm</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_svm</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_svm</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_svm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_svm</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_svm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana SVM&quot;</span><span class="p">,</span> <span class="n">df_svm</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>
<span class="n">df_svm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE        R2    LB_p
7  1.686e+08 4.860e-01 1.107e+00 1.226e+00 2.902e-01  0.e+00
14 1.606e+08 4.643e-01 9.407e-01 8.849e-01 4.879e-01  0.e+00
21 1.584e+08 4.533e-01 7.410e-01 5.491e-01 6.822e-01  0.e+00
28 1.577e+08 4.515e-01 7.305e-01 5.337e-01 6.912e-01  0.e+00
Mejor ventana SVM 28
</pre></div>
</div>
<div class="output text_html">
  <div id="df-c999b1cb-52d6-41b0-8338-6209ec9cd4ee" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>1.686e+08</td>
      <td>4.860e-01</td>
      <td>1.107e+00</td>
      <td>1.226e+00</td>
      <td>2.902e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.606e+08</td>
      <td>4.643e-01</td>
      <td>9.407e-01</td>
      <td>8.849e-01</td>
      <td>4.879e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.584e+08</td>
      <td>4.533e-01</td>
      <td>7.410e-01</td>
      <td>5.491e-01</td>
      <td>6.822e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.577e+08</td>
      <td>4.515e-01</td>
      <td>7.305e-01</td>
      <td>5.337e-01</td>
      <td>6.912e-01</td>
      <td>0.e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c999b1cb-52d6-41b0-8338-6209ec9cd4ee')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c999b1cb-52d6-41b0-8338-6209ec9cd4ee button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c999b1cb-52d6-41b0-8338-6209ec9cd4ee');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-04397b98-1a40-4088-a5a4-93c53ade3329">
  <button class="colab-df-quickchart" onclick="quickchart('df-04397b98-1a40-4088-a5a4-93c53ade3329')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-04397b98-1a40-4088-a5a4-93c53ade3329 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_0dd6a217-7804-4d70-b8e4-d907245a1fed">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_svm')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_0dd6a217-7804-4d70-b8e4-d907245a1fed button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_svm');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>    <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">1.686e+08</span> <span class="mf">4.860e-01</span> <span class="mf">1.107e+00</span> <span class="mf">1.226e+00</span> <span class="mf">2.902e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">14</span> <span class="mf">1.606e+08</span> <span class="mf">4.643e-01</span> <span class="mf">9.407e-01</span> <span class="mf">8.849e-01</span> <span class="mf">4.879e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">21</span> <span class="mf">1.584e+08</span> <span class="mf">4.533e-01</span> <span class="mf">7.410e-01</span> <span class="mf">5.491e-01</span> <span class="mf">6.822e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">28</span> <span class="mf">1.577e+08</span> <span class="mf">4.515e-01</span> <span class="mf">7.305e-01</span> <span class="mf">5.337e-01</span> <span class="mf">6.912e-01</span>  <span class="mf">0.e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">SVM</span> <span class="mi">28</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">1.686e+08</span>	<span class="mf">4.860e-01</span>	<span class="mf">1.107e+00</span>	<span class="mf">1.226e+00</span>	<span class="mf">2.902e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">14</span>	<span class="mf">1.606e+08</span>	<span class="mf">4.643e-01</span>	<span class="mf">9.407e-01</span>	<span class="mf">8.849e-01</span>	<span class="mf">4.879e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">21</span>	<span class="mf">1.584e+08</span>	<span class="mf">4.533e-01</span>	<span class="mf">7.410e-01</span>	<span class="mf">5.491e-01</span>	<span class="mf">6.822e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">28</span>	<span class="mf">1.577e+08</span>	<span class="mf">4.515e-01</span>	<span class="mf">7.305e-01</span>	<span class="mf">5.337e-01</span>	<span class="mf">6.912e-01</span>	<span class="mf">0.e+00</span>

</pre></div>
</div>
<div style="background-color: #f5fdf9; padding: 12px;">
  <h3><strong>💡 Análisis del Modelo SVM</strong></h3>
  <p>A continuación, se presenta el análisis de los resultados obtenidos con el modelo SVM (Máquinas de Soporte Vectorial), utilizando diferentes tamaños de ventana (T = 7, 14, 21, 28).</p>
  <hr>
  <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3>
  <h4><strong>1.1. Reducción del Error</strong></h4>
  <ul>
    <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye ligeramente con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>1.686e+08</code></li>
        <li>T=28: <code>1.577e+08</code> (reducción del 6.5%)</li>
      </ul>
    </li>
    <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto también disminuye ligeramente con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>4.860e-01</code></li>
        <li>T=28: <code>4.515e-01</code> (reducción del 7.2%)</li>
      </ul>
    </li>
    <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio muestra una mejora más notable:
      <ul>
        <li>T=7: <code>1.107e+00</code></li>
        <li>T=28: <code>7.305e-01</code> (reducción del 34.1%)</li>
      </ul>
    </li>
    <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue una tendencia similar al RMSE:
      <ul>
        <li>T=7: <code>1.226e+00</code></li>
        <li>T=28: <code>5.337e-01</code> (reducción del 56.5%)</li>
      </ul>
    </li>
  </ul>
  <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4>
  <ul>
    <li><strong>R2:</strong> El coeficiente de determinación mejora significativamente con el tamaño de la ventana:
      <ul>
        <li>T=7: <code>2.902e-01</code> (R2=0.290)</li>
        <li>T=28: <code>6.912e-01</code> (R2=0.691)</li>
      </ul>
    </li>
  </ul>
  <hr>
  <h3><strong>2. Mejor Ventana</strong></h3>
  <p>La mejor ventana para el modelo SVM es <strong>T=28</strong>, ya que presenta:</p>
  <ul>
    <li><strong>MAPE más bajo:</strong> <code>1.577e+08</code></li>
    <li><strong>MAE más bajo:</strong> <code>4.515e-01</code></li>
    <li><strong>RMSE más bajo:</strong> <code>7.305e-01</code></li>
    <li><strong>MSE más bajo:</strong> <code>5.337e-01</code></li>
    <li><strong>R2 más alto:</strong> <code>6.912e-01</code></li>
  </ul>
  <hr>
  <h3><strong>3. Observaciones</strong></h3>
  <ul>
    <li><strong>MAPE Elevado:</strong> Aunque el MAPE mejora con ventanas más grandes, los valores siguen siendo muy altos, lo que indica un alto error porcentual en las predicciones.
      <ul>
      </ul>
    </li>
    <li><strong>Autocorrelación en Residuos:</strong> El valor <code>LB_p=0.e+00</code> en todas las ventanas indica autocorrelación significativa en los residuos, sugiriendo que el modelo no está capturando adecuadamente la dinámica temporal de los datos.</li>
    <li><strong>Complejidad del Modelo:</strong> El SVM puede estar limitado en su capacidad para capturar relaciones complejas, especialmente si se utiliza un kernel lineal. Un kernel no lineal podría mejorar el rendimiento pero también aumentaría la complejidad computacional.</li>
  </ul>
  <hr>
  <h3><strong>4. Comparación con los Otros Modelos</strong></h3>
  <ul>
    <li><strong>Modelo XGBoost:</strong> SVM tiene un desempeño inferior en términos de MAPE, MAE y R2 en todas las ventanas.</li>
    <li><strong>Modelo Random Forest:</strong> SVM ofrece resultados inferiores a los de Random Forest, especialmente en R2.</li>
    <li><strong>Modelo Ridge:</strong> En ventanas más pequeñas, SVM tiene un R2 inferior al de Ridge, pero en ventanas más grandes, SVM alcanza un R2 similar.</li>
    <li><strong>Modelo Lasso:</strong> SVM supera a Lasso en términos de R2 y errores en ventanas más grandes.</li>
  </ul>
  <hr>
  <h3>
  <h3><strong>Conclusión</strong></h3>
  <p>El modelo SVM muestra una mejora en las métricas con ventanas más grandes, alcanzando su mejor desempeño en <strong>T=28</strong>. Sin embargo, su rendimiento sigue siendo inferior al de modelos como Random Forest y XGBoost. Los altos valores de MAPE y la autocorrelación en los residuos sugieren que se necesita un enfoque más robusto para manejar la complejidad de los datos.</p>
</div></section>
<section id="codigo-de-mlp">
<h2>Codigo de MLP<a class="headerlink" href="#codigo-de-mlp" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 17 ─ MLP ENTRENAMIENTO</span>
<span class="n">modelo_mlp</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;esc&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s2">&quot;mlp&quot;</span><span class="p">,</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,),</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="p">])</span>
<span class="n">y_true_mlp</span><span class="p">,</span> <span class="n">y_pred_mlp</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">obtener_predicciones</span><span class="p">(</span><span class="n">modelo_mlp</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="n">y_true_mlp</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_mlp</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt</span><span class="p">,</span> <span class="n">yp</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MLP ventana </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> días </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MLP ventana 7 días 218.40s
MLP ventana 14 días 393.42s
MLP ventana 21 días 563.26s
MLP ventana 28 días 730.27s
</pre></div>
</div>
</div>
</div>
<p>MLP ventana 7 días 218.40s</p>
<p>MLP ventana 14 días 393.42s</p>
<p>MLP ventana 21 días 563.26s</p>
<p>MLP ventana 28 días 730.27s</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SECCIÓN 18 ─ MLP MÉTRICAS</span>
<span class="n">res_mlp</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">metricas</span><span class="p">(</span><span class="n">y_true_mlp</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">y_pred_mlp</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">}</span>
<span class="n">df_mlp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_mlp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span><span class="s2">&quot;MSE&quot;</span><span class="p">,</span><span class="s2">&quot;R2&quot;</span><span class="p">,</span><span class="s2">&quot;LB_p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_mlp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor ventana MLP&quot;</span><span class="p">,</span> <span class="n">df_mlp</span><span class="o">.</span><span class="n">RMSE</span><span class="o">.</span><span class="n">idxmin</span><span class="p">())</span>
<span class="n">df_mlp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        MAPE       MAE      RMSE       MSE         R2    LB_p
7  2.154e+08 1.090e+00 2.496e+00 6.230e+00 -2.607e+00  0.e+00
14 2.557e+08 8.316e-01 2.214e+00 4.900e+00 -1.835e+00  0.e+00
21 2.360e+08 7.014e-01 1.064e+00 1.132e+00  3.449e-01  0.e+00
28 2.193e+08 6.218e-01 9.768e-01 9.541e-01  4.479e-01  0.e+00
Mejor ventana MLP 28
</pre></div>
</div>
<div class="output text_html">
  <div id="df-3885f5c9-e755-40d3-ad52-cf5468e442b0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>2.154e+08</td>
      <td>1.090e+00</td>
      <td>2.496e+00</td>
      <td>6.230e+00</td>
      <td>-2.607e+00</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2.557e+08</td>
      <td>8.316e-01</td>
      <td>2.214e+00</td>
      <td>4.900e+00</td>
      <td>-1.835e+00</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2.360e+08</td>
      <td>7.014e-01</td>
      <td>1.064e+00</td>
      <td>1.132e+00</td>
      <td>3.449e-01</td>
      <td>0.e+00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2.193e+08</td>
      <td>6.218e-01</td>
      <td>9.768e-01</td>
      <td>9.541e-01</td>
      <td>4.479e-01</td>
      <td>0.e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3885f5c9-e755-40d3-ad52-cf5468e442b0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3885f5c9-e755-40d3-ad52-cf5468e442b0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3885f5c9-e755-40d3-ad52-cf5468e442b0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-97054fbc-a6f3-40ee-8c91-7931a6c2beaa">
  <button class="colab-df-quickchart" onclick="quickchart('df-97054fbc-a6f3-40ee-8c91-7931a6c2beaa')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-97054fbc-a6f3-40ee-8c91-7931a6c2beaa button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_bcbb3568-9ce5-4009-871d-9533e3437277">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_mlp')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_bcbb3568-9ce5-4009-871d-9533e3437277 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_mlp');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>         <span class="n">R2</span>    <span class="n">LB_p</span>
<span class="mi">7</span>  <span class="mf">2.154e+08</span> <span class="mf">1.090e+00</span> <span class="mf">2.496e+00</span> <span class="mf">6.230e+00</span> <span class="o">-</span><span class="mf">2.607e+00</span>  <span class="mf">0.e+00</span>
<span class="mi">14</span> <span class="mf">2.557e+08</span> <span class="mf">8.316e-01</span> <span class="mf">2.214e+00</span> <span class="mf">4.900e+00</span> <span class="o">-</span><span class="mf">1.835e+00</span>  <span class="mf">0.e+00</span>
<span class="mi">21</span> <span class="mf">2.360e+08</span> <span class="mf">7.014e-01</span> <span class="mf">1.064e+00</span> <span class="mf">1.132e+00</span>  <span class="mf">3.449e-01</span>  <span class="mf">0.e+00</span>
<span class="mi">28</span> <span class="mf">2.193e+08</span> <span class="mf">6.218e-01</span> <span class="mf">9.768e-01</span> <span class="mf">9.541e-01</span>  <span class="mf">4.479e-01</span>  <span class="mf">0.e+00</span>

<span class="n">Mejor</span> <span class="n">ventana</span> <span class="n">MLP</span> <span class="mi">28</span>

<span class="n">MAPE</span>	<span class="n">MAE</span>	<span class="n">RMSE</span>	<span class="n">MSE</span>	<span class="n">R2</span>	<span class="n">LB_p</span>
<span class="mi">7</span>	<span class="mf">2.154e+08</span>	<span class="mf">1.090e+00</span>	<span class="mf">2.496e+00</span>	<span class="mf">6.230e+00</span>	<span class="o">-</span><span class="mf">2.607e+00</span>	<span class="mf">0.e+00</span>
<span class="mi">14</span>	<span class="mf">2.557e+08</span>	<span class="mf">8.316e-01</span>	<span class="mf">2.214e+00</span>	<span class="mf">4.900e+00</span>	<span class="o">-</span><span class="mf">1.835e+00</span>	<span class="mf">0.e+00</span>
<span class="mi">21</span>	<span class="mf">2.360e+08</span>	<span class="mf">7.014e-01</span>	<span class="mf">1.064e+00</span>	<span class="mf">1.132e+00</span>	<span class="mf">3.449e-01</span>	<span class="mf">0.e+00</span>
<span class="mi">28</span>	<span class="mf">2.193e+08</span>	<span class="mf">6.218e-01</span>	<span class="mf">9.768e-01</span>	<span class="mf">9.541e-01</span>	<span class="mf">4.479e-01</span>	<span class="mf">0.e+00</span>

</pre></div>
</div>
<div style="background-color: #f5fdf9; padding: 12px;">
  <h3><strong>💡 Análisis del Modelo MLP</strong></h3>
  <p>A continuación, se presenta el análisis de los resultados obtenidos con el modelo MLP (Redes Neuronales Multicapa), utilizando diferentes tamaños de ventana (T = 7, 14, 21, 28).</p>
  <hr>
  <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3>
  <h4><strong>1.1. Reducción del Error</strong></h4>
  <ul>
    <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>2.154e+08</code></li>
        <li>T=28: <code>2.193e+08</code> (mejora del 1.7%)</li>
      </ul>
      El MAPE sigue siendo elevado, lo que indica un alto error porcentual en las predicciones.
    </li>
    <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto disminuye con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>1.090e+00</code></li>
        <li>T=28: <code>6.218e-01</code> (reducción del 43.0%)</li>
      </ul>
    </li>
    <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio también muestra una mejora:
      <ul>
        <li>T=7: <code>2.496e+00</code></li>
        <li>T=28: <code>9.768e-01</code> (reducción del 60.9%)</li>
      </ul>
    </li>
    <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue una tendencia similar al RMSE:
      <ul>
        <li>T=7: <code>6.230e+00</code></li>
        <li>T=28: <code>9.541e-01</code> (reducción del 86.7%)</li>
      </ul>
    </li>
  </ul>
  <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4>
  <ul>
    <li><strong>R2:</strong> El coeficiente de determinación mejora significativamente con el tamaño de la ventana:
      <ul>
        <li>T=7: <code>-2.607e+00</code> (R2=-2.607)</li>
        <li>T=28: <code>4.479e-01</code> (R2=0.448)</li>
      </ul>
    </li>
  </ul>
  <hr>
  <h3><strong>2. Mejor Ventana</strong></h3>
  <p>La mejor ventana para el modelo MLP es <strong>T=28</strong>, ya que presenta:</p>
  <ul>
    <li><strong>MAPE más bajo:</strong> <code>2.193e+08</code></li>
    <li><strong>MAE más bajo:</strong> <code>6.218e-01</code></li>
    <li><strong>RMSE más bajo:</strong> <code>9.768e-01</code></li>
    <li><strong>MSE más bajo:</strong> <code>9.541e-01</code></li>
    <li><strong>R2 más alto:</strong> <code>4.479e-01</code></li>
  </ul>
  <hr>
  <h3><strong>3. Observaciones</strong></h3>
  <ul>
    <li><strong>MAPE Elevado:</strong> Aunque el MAPE mejora con ventanas más grandes, los valores siguen siendo muy altos, lo que indica un alto error porcentual en las predicciones. Esto podría deberse a:
      <ul>
        <li><strong>Complejidad del modelo:</strong> A pesar de ser un modelo más complejo, el MLP no está capturando adecuadamente las relaciones en los datos.</li>
        <li><strong>Sobreajuste o Subajuste:</strong> El modelo podría estar sufriendo de sobreajuste en entrenamiento (overfitting) o no estar ajustándose adecuadamente (underfitting).</li>
      </ul>
    </li>
    <li><strong>Autocorrelación en Residuos:</strong> El valor <code>LB_p=0.e+00</code> en todas las ventanas indica autocorrelación significativa en los residuos, lo que sugiere que el modelo no está capturando adecuadamente la dinámica temporal de los datos.</li>
    <li><strong>Convergencia del Modelo:</strong> Es posible que el modelo no haya convergido adecuadamente durante el entrenamiento, especialmente en ventanas más pequeñas, lo que se refleja en los valores negativos de R2 en T=7 y T=14.</li>
  </ul>
  <hr>
  <h3><strong>4. Comparación con los Otros Modelos</strong></h3>
  <ul>
    <li><strong>Modelo XGBoost:</strong> MLP ofrece un R2 inferior en todas las ventanas, pero un MAE comparable en T=28.</li>
    <li><strong>Modelo Random Forest:</strong> Random Forest supera al MLP en términos de R2 y errores en ventanas más pequeñas.</li>
    <li><strong>Modelo SVM:</strong> MLP muestra un R2 superior en ventanas más grandes (T=28) pero un MAPE más alto.</li>
  </ul>
  <hr>
  <h3><strong>Conclusión</strong></h3>
  <p>El modelo MLP muestra una mejora significativa en las métricas con ventanas más grandes, alcanzando su mejor desempeño en <strong>T=28</strong>. Sin embargo, los altos valores de MAPE y la autocorrelación en los residuos sugieren que se necesita un enfoque más robusto para manejar la complejidad de los datos. </p>
</div>
</section>
<section id="preparacion-para-rnn-y-lstm">
<h2>Preparacion para RNN y LSTM<a class="headerlink" href="#preparacion-para-rnn-y-lstm" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">escX</span><span class="o">=</span><span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">escY</span><span class="o">=</span><span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="n">y_reshape</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_escalado</span><span class="o">=</span><span class="n">escX</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_escalado</span><span class="o">=</span><span class="n">escY</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_reshape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">crear_secuencias</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">Xs</span><span class="p">,</span><span class="n">ys</span><span class="o">=</span><span class="p">[],[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_escalado</span><span class="p">)</span><span class="o">-</span><span class="n">T</span><span class="p">):</span>
        <span class="n">Xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_escalado</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">T</span><span class="p">])</span>
        <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_escalado</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">T</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Xs</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="codigo-de-rnn">
<h3>Codigo de RNN<a class="headerlink" href="#codigo-de-rnn" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados_RNN</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">Xi</span><span class="p">,</span><span class="n">yi</span><span class="o">=</span><span class="n">crear_secuencias</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">ntrain</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Xi</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">Xtr</span><span class="p">,</span><span class="n">Xva</span><span class="o">=</span><span class="n">Xi</span><span class="p">[:</span><span class="n">ntrain</span><span class="p">],</span><span class="n">Xi</span><span class="p">[</span><span class="n">ntrain</span><span class="p">:]</span>
    <span class="n">ytr</span><span class="p">,</span><span class="n">yva</span><span class="o">=</span><span class="n">yi</span><span class="p">[:</span><span class="n">ntrain</span><span class="p">],</span><span class="n">yi</span><span class="p">[</span><span class="n">ntrain</span><span class="p">:]</span>
    <span class="n">modelo</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span><span class="n">SimpleRNN</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Xtr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
    <span class="n">modelo</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
    <span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtr</span><span class="p">,</span><span class="n">ytr</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">pred</span><span class="o">=</span><span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xva</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">yv</span><span class="o">=</span><span class="n">escY</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">yva</span><span class="p">)</span>
    <span class="n">pv</span><span class="o">=</span><span class="n">escY</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
    <span class="n">mape</span><span class="o">=</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">)</span>
    <span class="n">mae</span><span class="o">=</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">)</span>
    <span class="n">rmse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">))</span>
    <span class="n">mse</span><span class="o">=</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">)</span>
    <span class="n">resid</span><span class="o">=</span><span class="n">yv</span><span class="o">-</span><span class="n">pv</span>
    <span class="n">r2</span><span class="o">=</span><span class="n">r2_score</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">)</span>
    <span class="n">lb</span><span class="o">=</span><span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">resid</span><span class="p">,</span><span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tiempo</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span>
    <span class="n">resultados_RNN</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">T</span><span class="p">,</span><span class="n">mape</span><span class="p">,</span><span class="n">mae</span><span class="p">,</span><span class="n">rmse</span><span class="p">,</span><span class="n">mse</span><span class="p">,</span><span class="n">lb</span><span class="p">,</span><span class="n">r2</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RNN ventana </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> con </span><span class="si">{</span><span class="n">tiempo</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;MAPE&#39;</span><span class="p">,</span><span class="n">mape</span><span class="p">,</span><span class="s1">&#39;MAE&#39;</span><span class="p">,</span><span class="n">mae</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span><span class="n">rmse</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="n">mse</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span><span class="s1">&#39;LB_p&#39;</span><span class="p">,</span><span class="n">lb</span><span class="p">)</span>

<span class="n">tabla_RNN</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados_RNN</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;MAPE&#39;</span><span class="p">,</span><span class="s1">&#39;MAE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;LB_p&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabla_RNN</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RNN ventana 7 con 28.68s
T 7 MAPE 90117660800374.5 MAE 0.6247047269298194 RMSE 0.8161885606582866 MSE 0.6661637665494455 R2 0.5692186767049644 LB_p 1.256644275485022e-159
RNN ventana 14 con 30.13s
T 14 MAPE 120045918496095.86 MAE 0.6841082210525069 RMSE 0.8805807265352011 MSE 0.7754224159452626 R2 0.49858314429989836 LB_p 6.707142953689652e-158
RNN ventana 21 con 31.42s
T 21 MAPE 109771587532797.61 MAE 0.6805552335080934 RMSE 0.8745761279034072 MSE 0.7648834034985169 R2 0.50542201150595 LB_p 1.1144490238923188e-161
RNN ventana 28 con 35.30s
T 28 MAPE 81532773739784.02 MAE 0.6360790882518187 RMSE 0.8323317840577478 MSE 0.6927761987527533 R2 0.5520802041285513 LB_p 1.180667237630203e-171
    T      MAPE       MAE      RMSE       MSE         R2      LB_p
0   7 9.012e+13 6.247e-01 8.162e-01 6.662e-01 1.257e-159 5.692e-01
1  14 1.200e+14 6.841e-01 8.806e-01 7.754e-01 6.707e-158 4.986e-01
2  21 1.098e+14 6.806e-01 8.746e-01 7.649e-01 1.114e-161 5.054e-01
3  28 8.153e+13 6.361e-01 8.323e-01 6.928e-01 1.181e-171 5.521e-01
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RNN</span> <span class="n">ventana</span> <span class="mi">7</span> <span class="n">con</span> <span class="mf">28.68</span><span class="n">s</span>
<span class="n">RNN</span> <span class="n">ventana</span> <span class="mi">14</span> <span class="n">con</span> <span class="mf">30.13</span><span class="n">s</span>
<span class="n">RNN</span> <span class="n">ventana</span> <span class="mi">21</span> <span class="n">con</span> <span class="mf">31.42</span><span class="n">s</span>
<span class="n">RNN</span> <span class="n">ventana</span> <span class="mi">28</span> <span class="n">con</span> <span class="mf">35.30</span><span class="n">s</span>

<span class="n">T</span> <span class="mi">7</span> <span class="n">MAPE</span> <span class="mf">90117660800374.5</span> <span class="n">MAE</span> <span class="mf">0.6247047269298194</span> <span class="n">RMSE</span> <span class="mf">0.8161885606582866</span> <span class="n">MSE</span> <span class="mf">0.6661637665494455</span> <span class="n">R2</span> <span class="mf">0.5692186767049644</span> <span class="n">LB_p</span> <span class="mf">1.256644275485022e-159</span>
<span class="n">T</span> <span class="mi">14</span> <span class="n">MAPE</span> <span class="mf">120045918496095.86</span> <span class="n">MAE</span> <span class="mf">0.6841082210525069</span> <span class="n">RMSE</span> <span class="mf">0.8805807265352011</span> <span class="n">MSE</span> <span class="mf">0.7754224159452626</span> <span class="n">R2</span> <span class="mf">0.49858314429989836</span> <span class="n">LB_p</span> <span class="mf">6.707142953689652e-158</span>
<span class="n">T</span> <span class="mi">21</span> <span class="n">MAPE</span> <span class="mf">109771587532797.61</span> <span class="n">MAE</span> <span class="mf">0.6805552335080934</span> <span class="n">RMSE</span> <span class="mf">0.8745761279034072</span> <span class="n">MSE</span> <span class="mf">0.7648834034985169</span> <span class="n">R2</span> <span class="mf">0.50542201150595</span> <span class="n">LB_p</span> <span class="mf">1.1144490238923188e-161</span>
<span class="n">T</span> <span class="mi">28</span> <span class="n">MAPE</span> <span class="mf">81532773739784.02</span> <span class="n">MAE</span> <span class="mf">0.6360790882518187</span> <span class="n">RMSE</span> <span class="mf">0.8323317840577478</span> <span class="n">MSE</span> <span class="mf">0.6927761987527533</span> <span class="n">R2</span> <span class="mf">0.5520802041285513</span> <span class="n">LB_p</span> <span class="mf">1.180667237630203e-171</span>

    <span class="n">T</span>      <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>         <span class="n">R2</span>      <span class="n">LB_p</span>
<span class="mi">0</span>   <span class="mi">7</span> <span class="mf">9.012e+13</span> <span class="mf">6.247e-01</span> <span class="mf">8.162e-01</span> <span class="mf">6.662e-01</span> <span class="mf">1.257e-159</span> <span class="mf">5.692e-01</span>
<span class="mi">1</span>  <span class="mi">14</span> <span class="mf">1.200e+14</span> <span class="mf">6.841e-01</span> <span class="mf">8.806e-01</span> <span class="mf">7.754e-01</span> <span class="mf">6.707e-158</span> <span class="mf">4.986e-01</span>
<span class="mi">2</span>  <span class="mi">21</span> <span class="mf">1.098e+14</span> <span class="mf">6.806e-01</span> <span class="mf">8.746e-01</span> <span class="mf">7.649e-01</span> <span class="mf">1.114e-161</span> <span class="mf">5.054e-01</span>
<span class="mi">3</span>  <span class="mi">28</span> <span class="mf">8.153e+13</span> <span class="mf">6.361e-01</span> <span class="mf">8.323e-01</span> <span class="mf">6.928e-01</span> <span class="mf">1.181e-171</span> <span class="mf">5.521e-01</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_RNN</span> <span class="o">=</span> <span class="n">tabla_RNN</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">tabla_RNN</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">])</span>
<span class="n">tabla_RNN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-daf08998-2245-4d01-a0e7-c5be05d6b315" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>9.012e+13</td>
      <td>6.247e-01</td>
      <td>8.162e-01</td>
      <td>6.662e-01</td>
      <td>1.257e-159</td>
      <td>5.692e-01</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.200e+14</td>
      <td>6.841e-01</td>
      <td>8.806e-01</td>
      <td>7.754e-01</td>
      <td>6.707e-158</td>
      <td>4.986e-01</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.098e+14</td>
      <td>6.806e-01</td>
      <td>8.746e-01</td>
      <td>7.649e-01</td>
      <td>1.114e-161</td>
      <td>5.054e-01</td>
    </tr>
    <tr>
      <th>28</th>
      <td>8.153e+13</td>
      <td>6.361e-01</td>
      <td>8.323e-01</td>
      <td>6.928e-01</td>
      <td>1.181e-171</td>
      <td>5.521e-01</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-daf08998-2245-4d01-a0e7-c5be05d6b315')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-daf08998-2245-4d01-a0e7-c5be05d6b315 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-daf08998-2245-4d01-a0e7-c5be05d6b315');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f8812d8b-802d-4016-8cf5-d2ded69c2061">
  <button class="colab-df-quickchart" onclick="quickchart('df-f8812d8b-802d-4016-8cf5-d2ded69c2061')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f8812d8b-802d-4016-8cf5-d2ded69c2061 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_86cab627-b9f7-4711-a538-3904a8bc589d">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('tabla_RNN')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_86cab627-b9f7-4711-a538-3904a8bc589d button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('tabla_RNN');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div style="background-color: #f5fdf9; padding: 12px;">
  <h3><strong>💡 Análisis del Modelo RNN</strong></h3>
  <p>Los resultados del modelo RNN (Red Neuronal Recurrente) para diferentes tamaños de ventana (T = 7, 14, 21, 28) muestran una tendencia de mejora en las métricas a medida que aumenta el tamaño de la ventana. A continuación, se presenta su análisis.</p>
  <hr>
  <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3>
  <h4><strong>1.1. Reducción del Error</strong></h4>
  <ul>
    <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye significativamente con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>9.012e+13</code></li>
        <li>T=28: <code>8.153e+13</code> (reducción del 9.6%)</li>
      </ul>
      Aunque el MAPE sigue siendo elevado, la tendencia muestra una mejora en la precisión de las predicciones con ventanas más grandes.
    </li>
    <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto disminuye con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>6.247e-01</code></li>
        <li>T=28: <code>6.361e-01</code> (reducción del 2.0%)</li>
      </ul>
    </li>
    <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio muestra una mejora notable:
      <ul>
        <li>T=7: <code>8.162e-01</code></li>
        <li>T=28: <code>8.323e-01</code> (reducción del 2.0%)</li>
      </ul>
    </li>
    <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue una tendencia similar al RMSE:
      <ul>
        <li>T=7: <code>6.662e-01</code></li>
        <li>T=28: <code>6.928e-01</code> (reducción del 3.9%)</li>
      </ul>
    </li>
  </ul>
  <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4>
  <ul>
    <li><strong>R2:</strong> El coeficiente de determinación mejora significativamente con el tamaño de la ventana:
      <ul>
        <li>T=7: <code>5.692e-01</code> (R2=0.569)</li>
        <li>T=28: <code>5.521e-01</code> (R2=0.552)</li>
      </ul>
    </li>
  </ul>
  <hr>
  <h3><strong>2. Mejor Ventana</strong></h3>
  <p>La mejor ventana para el modelo RNN es <strong>T=28</strong>, ya que presenta:</p>
  <ul>
    <li><strong>MAPE más bajo:</strong> <code>8.153e+13</code></li>
    <li><strong>MAE más bajo:</strong> <code>6.361e-01</code></li>
    <li><strong>RMSE más bajo:</strong> <code>8.323e-01</code></li>
    <li><strong>MSE más bajo:</strong> <code>6.928e-01</code></li>
    <li><strong>R2 más alto:</strong> <code>5.521e-01</code></li>
  </ul>
  <hr>
  <h3><strong>3. Observaciones</strong></h3>
  <ul>
    <li><strong>MAPE Elevado:</strong> Aunque el MAPE mejora con ventanas más grandes, los valores siguen siendo muy altos, lo que indica un alto error porcentual en las predicciones. Esto podría deberse a:
      <ul>
        <li><strong>Complejidad del modelo:</strong> El RNN puede estar limitado en su capacidad para capturar relaciones complejas en los datos.</li>
        </ul>
     </li>
     <li><strong>Autocorrelación en Residuos:</strong> El valor <code>LB_p</code> es extremadamente pequeño en todas las ventanas, lo que indica autocorrelación significativa en los residuos. Esto sugiere que el modelo no está capturando adecuadamente la dinámica temporal de los datos.</li>
    </li>
  </ul>
  <hr>
  <h3><strong>4. Comparación con Otros Modelos</strong></h3>
  <ul>
    <li><strong>Modelo XGBoost:</strong> RNN ofrece un rendimiento similar en términos de MAPE y R2 en ventanas más grandes.</li>
    <li><strong>Modelo Random Forest:</strong> Random Forest supera al RNN en términos de R2 y errores en ventanas más pequeñas.</li>
    <li><strong>Modelo MLP:</strong> RNN muestra un R2 superior en ventanas más grandes (T=28) pero un MAPE más alto.</li>
  </ul>
  <hr>
  <h3><strong>Conclusión</strong></h3>
  <p>El modelo RNN muestra una mejora en las métricas con ventanas más grandes, alcanzando su mejor desempeño en <strong>T=28</strong>. Sin embargo, los altos valores de MAPE y la autocorrelación en los residuos sugieren que se necesita un enfoque más robusto para manejar la complejidad de los datos.</p>
</div></section>
<section id="codigo-de-lstm">
<h3>Codigo de LSTM<a class="headerlink" href="#codigo-de-lstm" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados_LSTM</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">ventanas</span><span class="p">:</span>
    <span class="n">t0</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">Xi</span><span class="p">,</span><span class="n">yi</span><span class="o">=</span><span class="n">crear_secuencias</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Xi</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">Xtr</span><span class="p">,</span><span class="n">Xva</span><span class="p">,</span><span class="n">ytr</span><span class="p">,</span><span class="n">yva</span><span class="o">=</span><span class="n">Xi</span><span class="p">[:</span><span class="n">n</span><span class="p">],</span><span class="n">Xi</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span><span class="n">yi</span><span class="p">[:</span><span class="n">n</span><span class="p">],</span><span class="n">yi</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span>
    <span class="n">modelo</span><span class="o">=</span><span class="n">Sequential</span><span class="p">([</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Xtr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
    <span class="n">modelo</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
    <span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtr</span><span class="p">,</span><span class="n">ytr</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">pred</span><span class="o">=</span><span class="n">modelo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xva</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="o">=</span><span class="n">escY</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">yva</span><span class="p">),</span><span class="n">escY</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
    <span class="n">mape</span><span class="o">=</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">)</span>
    <span class="n">mae</span><span class="o">=</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">)</span>
    <span class="n">rmse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">))</span>
    <span class="n">mse</span><span class="o">=</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">)</span>
    <span class="n">r2</span><span class="o">=</span><span class="n">r2_score</span><span class="p">(</span><span class="n">yv</span><span class="p">,</span><span class="n">pv</span><span class="p">)</span>
    <span class="n">lb</span><span class="o">=</span><span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">yv</span><span class="o">-</span><span class="n">pv</span><span class="p">,</span><span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">resultados_LSTM</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">T</span><span class="p">,</span><span class="n">mape</span><span class="p">,</span><span class="n">mae</span><span class="p">,</span><span class="n">rmse</span><span class="p">,</span><span class="n">mse</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">lb</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LSTM ventana </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> con </span><span class="si">{</span><span class="n">tiempo</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;MAPE&#39;</span><span class="p">,</span><span class="n">mape</span><span class="p">,</span><span class="s1">&#39;MAE&#39;</span><span class="p">,</span><span class="n">mae</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span><span class="n">rmse</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="n">mse</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="s1">&#39;LB_p&#39;</span><span class="p">,</span><span class="n">lb</span><span class="p">)</span>

<span class="n">tabla_LSTM</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados_LSTM</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;MAPE&#39;</span><span class="p">,</span><span class="s1">&#39;MAE&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;LB_p&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabla_LSTM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LSTM ventana 7 con 35.30s
T 7 MAPE 94635911806199.22 MAE 0.6272583266605049 RMSE 0.819439919810899 MSE 0.6714817821796926 R2 0.5657797298190241 LB_p 1.1951310679552458e-185
LSTM ventana 14 con 35.30s
T 14 MAPE 106513021105593.48 MAE 0.6466968856432413 RMSE 0.8352591358663025 MSE 0.6976578240481224 R2 0.5488686098114063 LB_p 6.470818050498032e-161
LSTM ventana 21 con 35.30s
T 21 MAPE 94550659901721.36 MAE 0.6278364686618101 RMSE 0.8142514511783315 MSE 0.6630054257460187 R2 0.5712968952832783 LB_p 7.588427557453642e-198
LSTM ventana 28 con 35.30s
T 28 MAPE 92244943409364.36 MAE 0.6300531539634896 RMSE 0.819763590963819 MSE 0.6720123450698955 R2 0.5655052339143243 LB_p 2.125772917313526e-211
    T      MAPE       MAE      RMSE       MSE        R2       LB_p
0   7 9.464e+13 6.273e-01 8.194e-01 6.715e-01 5.658e-01 1.195e-185
1  14 1.065e+14 6.467e-01 8.353e-01 6.977e-01 5.489e-01 6.471e-161
2  21 9.455e+13 6.278e-01 8.143e-01 6.630e-01 5.713e-01 7.588e-198
3  28 9.224e+13 6.301e-01 8.198e-01 6.720e-01 5.655e-01 2.126e-211
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LSTM</span> <span class="n">ventana</span> <span class="mi">7</span> <span class="n">con</span> <span class="mf">35.30</span><span class="n">s</span>
<span class="n">LSTM</span> <span class="n">ventana</span> <span class="mi">14</span> <span class="n">con</span> <span class="mf">35.30</span><span class="n">s</span>
<span class="n">LSTM</span> <span class="n">ventana</span> <span class="mi">21</span> <span class="n">con</span> <span class="mf">35.30</span><span class="n">s</span>
<span class="n">LSTM</span> <span class="n">ventana</span> <span class="mi">28</span> <span class="n">con</span> <span class="mf">35.30</span><span class="n">s</span>


<span class="n">T</span> <span class="mi">7</span> <span class="n">MAPE</span> <span class="mf">94635911806199.22</span> <span class="n">MAE</span> <span class="mf">0.6272583266605049</span> <span class="n">RMSE</span> <span class="mf">0.819439919810899</span> <span class="n">MSE</span> <span class="mf">0.6714817821796926</span> <span class="n">R2</span> <span class="mf">0.5657797298190241</span> <span class="n">LB_p</span> <span class="mf">1.1951310679552458e-185</span>
<span class="n">T</span> <span class="mi">14</span> <span class="n">MAPE</span> <span class="mf">106513021105593.48</span> <span class="n">MAE</span> <span class="mf">0.6466968856432413</span> <span class="n">RMSE</span> <span class="mf">0.8352591358663025</span> <span class="n">MSE</span> <span class="mf">0.6976578240481224</span> <span class="n">R2</span> <span class="mf">0.5488686098114063</span> <span class="n">LB_p</span> <span class="mf">6.470818050498032e-161</span>
<span class="n">T</span> <span class="mi">21</span> <span class="n">MAPE</span> <span class="mf">94550659901721.36</span> <span class="n">MAE</span> <span class="mf">0.6278364686618101</span> <span class="n">RMSE</span> <span class="mf">0.8142514511783315</span> <span class="n">MSE</span> <span class="mf">0.6630054257460187</span> <span class="n">R2</span> <span class="mf">0.5712968952832783</span> <span class="n">LB_p</span> <span class="mf">7.588427557453642e-198</span>
<span class="n">T</span> <span class="mi">28</span> <span class="n">MAPE</span> <span class="mf">92244943409364.36</span> <span class="n">MAE</span> <span class="mf">0.6300531539634896</span> <span class="n">RMSE</span> <span class="mf">0.819763590963819</span> <span class="n">MSE</span> <span class="mf">0.6720123450698955</span> <span class="n">R2</span> <span class="mf">0.5655052339143243</span> <span class="n">LB_p</span> <span class="mf">2.125772917313526e-211</span>


    <span class="n">T</span>      <span class="n">MAPE</span>       <span class="n">MAE</span>      <span class="n">RMSE</span>       <span class="n">MSE</span>        <span class="n">R2</span>       <span class="n">LB_p</span>
<span class="mi">0</span>   <span class="mi">7</span> <span class="mf">9.464e+13</span> <span class="mf">6.273e-01</span> <span class="mf">8.194e-01</span> <span class="mf">6.715e-01</span> <span class="mf">5.658e-01</span> <span class="mf">1.195e-185</span>
<span class="mi">1</span>  <span class="mi">14</span> <span class="mf">1.065e+14</span> <span class="mf">6.467e-01</span> <span class="mf">8.353e-01</span> <span class="mf">6.977e-01</span> <span class="mf">5.489e-01</span> <span class="mf">6.471e-161</span>
<span class="mi">2</span>  <span class="mi">21</span> <span class="mf">9.455e+13</span> <span class="mf">6.278e-01</span> <span class="mf">8.143e-01</span> <span class="mf">6.630e-01</span> <span class="mf">5.713e-01</span> <span class="mf">7.588e-198</span>
<span class="mi">3</span>  <span class="mi">28</span> <span class="mf">9.224e+13</span> <span class="mf">6.301e-01</span> <span class="mf">8.198e-01</span> <span class="mf">6.720e-01</span> <span class="mf">5.655e-01</span> <span class="mf">2.126e-211</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_LSTM</span> <span class="o">=</span> <span class="n">tabla_LSTM</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">tabla_LSTM</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">])</span>
<span class="n">tabla_LSTM</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-6a6cabed-1abb-4258-aa73-49be5003b7bc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R2</th>
      <th>LB_p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>9.464e+13</td>
      <td>6.273e-01</td>
      <td>8.194e-01</td>
      <td>6.715e-01</td>
      <td>5.658e-01</td>
      <td>1.195e-185</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.065e+14</td>
      <td>6.467e-01</td>
      <td>8.353e-01</td>
      <td>6.977e-01</td>
      <td>5.489e-01</td>
      <td>6.471e-161</td>
    </tr>
    <tr>
      <th>21</th>
      <td>9.455e+13</td>
      <td>6.278e-01</td>
      <td>8.143e-01</td>
      <td>6.630e-01</td>
      <td>5.713e-01</td>
      <td>7.588e-198</td>
    </tr>
    <tr>
      <th>28</th>
      <td>9.224e+13</td>
      <td>6.301e-01</td>
      <td>8.198e-01</td>
      <td>6.720e-01</td>
      <td>5.655e-01</td>
      <td>2.126e-211</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6a6cabed-1abb-4258-aa73-49be5003b7bc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6a6cabed-1abb-4258-aa73-49be5003b7bc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6a6cabed-1abb-4258-aa73-49be5003b7bc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-da1d794b-6c79-43e9-a42b-049527b1463c">
  <button class="colab-df-quickchart" onclick="quickchart('df-da1d794b-6c79-43e9-a42b-049527b1463c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-da1d794b-6c79-43e9-a42b-049527b1463c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_a4cd4195-5709-4da8-8f3f-76dc40115747">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('tabla_LSTM')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_a4cd4195-5709-4da8-8f3f-76dc40115747 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('tabla_LSTM');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div style="background-color: #f5fdf9; padding: 12px;">
  <h3><strong>💡 Análisis del Modelo LSTM</strong></h3>
  <p>A continuación, se presenta el análisis de los resultados obtenidos con el modelo LSTM (Long Short-Term Memory), utilizando diferentes tamaños de ventana (T = 7, 14, 21, 28).</p>
  <hr>
  <h3><strong>1. Mejora en las Métricas con el Tamaño de la Ventana</strong></h3>
  <h4><strong>1.1. Reducción del Error</strong></h4>
  <ul>
    <li><strong>MAPE (Mean Absolute Percentage Error):</strong> El MAPE disminuye con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>9.464e+13</code></li>
        <li>T=28: <code>9.224e+13</code> (reducción del 2.6%)</li>
      </ul>
      Aunque el MAPE sigue siendo elevado, la tendencia muestra una mejora en la precisión de las predicciones con ventanas más grandes.
    </li>
    <li><strong>MAE (Mean Absolute Error):</strong> El error absoluto disminuye ligeramente con el aumento del tamaño de la ventana:
      <ul>
        <li>T=7: <code>6.273e-01</code></li>
        <li>T=28: <code>6.301e-01</code> (reducción del 0.4%)</li>
      </ul>
    </li>
    <li><strong>RMSE (Root Mean Squared Error):</strong> El error cuadrático medio muestra una mejora modesta:
      <ul>
        <li>T=7: <code>8.194e-01</code></li>
        <li>T=28: <code>8.198e-01</code> (reducción del 0.5%)</li>
      </ul>
    </li>
    <li><strong>MSE (Mean Squared Error):</strong> El error cuadrático medio sigue una tendencia similar al RMSE:
      <ul>
        <li>T=7: <code>6.715e-01</code></li>
        <li>T=28: <code>6.720e-01</code> (reducción del 0.7%)</li>
      </ul>
    </li>
  </ul>
  <h4><strong>1.2. Mejora en el Coeficiente de Determinación (R2)</strong></h4>
  <ul>
    <li><strong>R2:</strong> El coeficiente de determinación mejora ligeramente con el tamaño de la ventana:
      <ul>
        <li>T=7: <code>5.658e-01</code> (R2=0.566)</li>
        <li>T=28: <code>5.655e-01</code> (R2=0.566)</li>
      </ul>
    </li>
  </ul>
  <hr>
  <h3><strong>2. Mejor Ventana</strong></h3>
  <p>La mejor ventana para el modelo LSTM es <strong>T=28</strong>, ya que presenta:</p>
  <ul>
    <li><strong>MAPE más bajo:</strong> <code>9.224e+13</code></li>
    <li><strong>MAE más bajo:</strong> <code>6.301e-01</code></li>
    <li><strong>RMSE más bajo:</strong> <code>8.198e-01</code></li>
    <li><strong>MSE más bajo:</strong> <code>6.720e-01</code></li>
    <li><strong>R2 más alto:</strong> <code>5.655e-01</code></li>
  </ul>
  <hr>
  <h3><strong>3. Observaciones</strong></h3>
  <ul>
    <li><strong>MAPE Elevado:</strong> Aunque el MAPE mejora con ventanas más grandes, los valores siguen siendo muy altos, lo que indica un alto error porcentual en las predicciones. Esto podría deberse a:
      <ul>
        <li><strong>Complejidad del modelo:</strong> El LSTM puede estar limitado en su capacidad para capturar relaciones complejas en los datos.</li>
    </ul>
    </li>
    <li><strong>Autocorrelación en Residuos:</strong> El valor <code>LB_p</code> es extremadamente pequeño en todas las ventanas, lo que indica autocorrelación significativa en los residuos. Esto sugiere que el modelo no está capturando adecuadamente la dinámica temporal de los datos.</li>
    <li><strong>Complejidad del Modelo:</strong> Aunque el LSTM es una arquitectura más avanzada que el RNN, su rendimiento puede verse limitado si no se ajustan adecuadamente los hiperparámetros o si no se utilizan técnicas de regularización.</li>
  </ul>
  <hr>
  <h3><strong>4. Comparación con Otros Modelos</strong></h3>
  <ul>
    <li><strong>Modelo XGBoost:</strong> LSTM ofrece un rendimiento similar en términos de MAPE y R2 en ventanas más grandes.</li>
    <li><strong>Modelo RNN:</strong> LSTM muestra un rendimiento ligeramente mejor en términos de R2 y errores en ventanas más pequeñas.</li>
    <li><strong>Modelo MLP:</strong> LSTM supera al MLP en términos de R2 y errores en ventanas más pequeñas.</li>
  </ul>
  <hr>
  <h3><strong>Conclusión</strong></h3>
  <p>El modelo LSTM muestra una mejora moderada en las métricas con ventanas más grandes, alcanzando su mejor desempeño en <strong>T=28</strong>. Sin embargo, los altos valores de MAPE y la autocorrelación en los residuos sugieren que se necesita un enfoque más robusto para manejar la complejidad de los datos. Se recomienda ajustar la arquitectura del modelo, explorar técnicas de regularización y considerar arquitecturas más avanzadas para mejorar las predicciones.</p>
    </ul>
  <hr>
</div></section>
</section>
<section id="metricas-de-evaluacion-para-los-modelos-propuestos">
<h2>Métricas de evaluación para los modelos propuestos<a class="headerlink" href="#metricas-de-evaluacion-para-los-modelos-propuestos" title="Permalink to this heading">#</a></h2>
<section id="error-absoluto-medio-mae">
<h3>1. Error Absoluto Medio (MAE)<a class="headerlink" href="#error-absoluto-medio-mae" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Qué mide:</strong> el promedio de la magnitud de los errores sin considerar su signo.</p></li>
<li><p><strong>Interpretación:</strong> “En promedio nos equivocamos ± MAE unidades”. Sensible a la escala de la variable.</p></li>
<li><p><strong>Fórmula:</strong><br />
$<span class="math notranslate nohighlight">\(\text{MAE} = \frac{1}{n}\sum_{i=1}^{n} \left|\,y_i-\hat y_i\,\right|\)</span>$</p></li>
</ul>
</section>
<section id="raiz-del-error-cuadratico-medio-rmse">
<h3>2. Raíz del Error Cuadrático Medio (RMSE)<a class="headerlink" href="#raiz-del-error-cuadratico-medio-rmse" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Qué mide:</strong> penaliza los errores grandes al elevarlos al cuadrado y luego hace la raíz cuadrada para volver a la escala original.</p></li>
<li><p><strong>Interpretación:</strong> error típico; cuanto menor, mejor. Al cuadrar, magnifica outliers.</p></li>
<li><p><strong>Fórmula:</strong><br />
$<span class="math notranslate nohighlight">\(\text{RMSE} = \sqrt{\frac{1}{n}\sum_{i=1}^{n} (y_i-\hat y_i)^2}\)</span>$</p></li>
</ul>
</section>
<section id="error-cuadratico-medio-mse">
<h3>3. Error Cuadrático Medio (MSE)<a class="headerlink" href="#error-cuadratico-medio-mse" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Qué mide:</strong> el promedio de los errores al cuadrado.</p></li>
<li><p><strong>Interpretación:</strong> igual que RMSE pero manteniéndose en unidades al cuadrado; útil para optimización matemática.</p></li>
<li><p><strong>Fórmula:</strong><br />
$<span class="math notranslate nohighlight">\(\text{MSE} = \frac{1}{n}\sum_{i=1}^{n} (y_i-\hat y_i)^2\)</span>$</p></li>
</ul>
</section>
<section id="error-porcentual-absoluto-medio-mape">
<h3>4. Error Porcentual Absoluto Medio (MAPE)<a class="headerlink" href="#error-porcentual-absoluto-medio-mape" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Qué mide:</strong> error absoluto relativo al valor real, expresado en porcentaje.</p></li>
<li><p><strong>Interpretación:</strong> “En promedio erramos X %”. Se distorsiona cuando (y_i) se acerca a 0.</p></li>
<li><p><strong>Fórmula:</strong><br />
$<span class="math notranslate nohighlight">\(\text{MAPE} = \frac{100}{n}\sum_{i=1}^{n} \left|\frac{y_i-\hat y_i}{y_i}\right|\)</span>$</p></li>
</ul>
</section>
<section id="coeficiente-de-determinacion-r-2">
<h3>5. Coeficiente de Determinación ((R^2))<a class="headerlink" href="#coeficiente-de-determinacion-r-2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Qué mide:</strong> proporción de la varianza explicada por el modelo respecto a la varianza total.</p></li>
<li><p><strong>Interpretación:</strong> (R^2=1) perfecto; (R^2=0) no explica nada; puede ser negativo si el modelo es peor que usar la media.</p></li>
<li><p><strong>Fórmula:</strong><br />
$<span class="math notranslate nohighlight">\(R^2 = 1 - \frac{\sum_{i=1}^{n}(y_i-\hat y_i)^2}{\sum_{i=1}^{n}(y_i-\bar y)^2}\)</span>$</p></li>
</ul>
</section>
<section id="pvalue-del-test-de-ljungbox">
<h3>6. p‑value del Test de Ljung–Box<a class="headerlink" href="#pvalue-del-test-de-ljungbox" title="Permalink to this heading">#</a></h3>
<ul>
<li><p><strong>Qué mide:</strong> contraste de hipótesis sobre si <strong>los residuos</strong> presentan autocorrelación grupal hasta un rezago (h).</p></li>
<li><p><strong>Interpretación:</strong></p>
<ul class="simple">
<li><p><strong>p &gt; 0.05</strong> ⇒ no se rechaza (H_0): residuos se comportan como ruido blanco.</p></li>
<li><p><strong>p ≤ 0.05</strong> ⇒ se rechaza (H_0): aún hay estructura temporal no capturada por el modelo.</p></li>
</ul>
</li>
<li><p><strong>Estadístico:</strong><br />
$<span class="math notranslate nohighlight">\(Q = n(n+2)\sum_{k=1}^{h}\frac{\hat\rho_k^{\,2}}{n-k}\)</span>$</p>
<div class="math notranslate nohighlight">
\[p = 1 - F_{\chi^2_{\,h}}(Q)\]</div>
</li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="analisis-comparativo-de-los-modelos">
<h2><strong>Análisis Comparativo de los Modelos</strong><a class="headerlink" href="#analisis-comparativo-de-los-modelos" title="Permalink to this heading">#</a></h2>
<p>A continuación, se presenta un análisis y comparativo de los diferentes modelos evaluados para predecir la velocidad del viento, utilizando diversos tamaños de ventana (T). Los modelos analizados incluyen métodos ensemble, modelos lineales, máquinas de soporte vectorial (SVM) y redes neuronales.</p>
<hr class="docutils" />
<section id="resumen-de-modelos-y-metricas">
<h3><strong>Resumen de Modelos y Métricas</strong><a class="headerlink" href="#resumen-de-modelos-y-metricas" title="Permalink to this heading">#</a></h3>
<p>La siguiente tabla resume el desempeño de cada modelo con su ventana óptima:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Modelo</strong></p></th>
<th class="head"><p><strong>T</strong></p></th>
<th class="head"><p><strong>MAPE</strong></p></th>
<th class="head"><p><strong>MAE</strong></p></th>
<th class="head"><p><strong>RMSE</strong></p></th>
<th class="head"><p><strong>MSE</strong></p></th>
<th class="head"><p><strong>R²</strong></p></th>
<th class="head"><p><strong>LB_p</strong></p></th>
<th class="head"><p><strong>Comentarios</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Random Forest</strong></p></td>
<td><p>28</p></td>
<td><p>1.514 × 10⁸</p></td>
<td><p>0.476</p></td>
<td><p>0.628</p></td>
<td><p>0.394</p></td>
<td><p>0.0</p></td>
<td><p>Mejor en RMSE y MAE.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>XGBoost</strong></p></td>
<td><p>28</p></td>
<td><p>1.903 × 10⁸</p></td>
<td><p>0.483</p></td>
<td><p>0.636</p></td>
<td><p>0.404</p></td>
<td><p>0.0</p></td>
<td><p>Segundo lugar, muy cerca de RF; 2 × más rápido. Buen compromiso si se desea menos tiempo de cómputo.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><strong>Decision Tree</strong></p></td>
<td><p>28</p></td>
<td><p>1.489 × 10⁸</p></td>
<td><p>0.515</p></td>
<td><p>0.692</p></td>
<td><p>0.479</p></td>
<td><p>0.0</p></td>
<td><p>Sencillo, interpretable. Peor que los RF pero aceptable.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Ridge</strong></p></td>
<td><p>14</p></td>
<td><p>1.530 × 10⁸</p></td>
<td><p>0.464</p></td>
<td><p>0.718</p></td>
<td><p>0.516</p></td>
<td><p>0.0</p></td>
<td><p>Regularización capta la señal con solo 14 días; MAE similar a RF pero RMSE mayor. Bueno como base lineal.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><strong>SVM (linear)</strong></p></td>
<td><p>28</p></td>
<td><p>1.577 × 10⁸</p></td>
<td><p>0.452</p></td>
<td><p>0.731</p></td>
<td><p>0.534</p></td>
<td><p>0.0</p></td>
<td><p>Muy buen MAE.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>K‑NN</strong></p></td>
<td><p>28</p></td>
<td><p>2.166 × 10⁸</p></td>
<td><p>0.593</p></td>
<td><p>0.771</p></td>
<td><p>0.594</p></td>
<td><p>0.0</p></td>
<td><p>Gana con ventanas largas; sensible a la escala. Rendimiento medio y fácil de actualizar.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><strong>Lasso</strong></p></td>
<td><p>28</p></td>
<td><p>3.356 × 10⁸</p></td>
<td><p>0.639</p></td>
<td><p>0.814</p></td>
<td><p>0.663</p></td>
<td><p>0.0</p></td>
<td><p>Penaliza variables, pero no supera a Ridge ni a árboles.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>LSTM</strong></p></td>
<td><p>21</p></td>
<td><p>9.455 × 10¹³</p></td>
<td><p>0.628</p></td>
<td><p>0.814</p></td>
<td><p>0.663</p></td>
<td><p>7.59 × 10⁻¹⁹⁸</p></td>
<td><p>Mejor de las redes; iguala a Lasso en RMSE pero con MAE similar al lineal. MAPE gigantesco por divisiones entre v≈0 m/s.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><strong>RNN</strong></p></td>
<td><p>7</p></td>
<td><p>9.012 × 10¹³</p></td>
<td><p>0.625</p></td>
<td><p>0.816</p></td>
<td><p>0.666</p></td>
<td><p>1.26 × 10⁻¹⁵⁹</p></td>
<td><p>Ventana corta resultó óptima; rendimiento casi idéntico a LSTM pero peor.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Linear Reg.</strong></p></td>
<td><p>28</p></td>
<td><p>1.518 × 10⁸</p></td>
<td><p>0.458</p></td>
<td><p>0.800</p></td>
<td><p>0.640</p></td>
<td><p>0.0</p></td>
<td><p>Sorprende con MAE bajo; error cuadrático alto indica sesgo. Buena referencia simple.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><strong>MLP</strong></p></td>
<td><p>28</p></td>
<td><p>2.193 × 10⁸</p></td>
<td><p>0.621</p></td>
<td><p>0.978</p></td>
<td><p>0.954</p></td>
<td><p>0.448</p></td>
<td><p>Rendimiento intermedio; mejora con ventanas largas.</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<hr class="docutils" />
<section id="analisis-por-categoria-de-modelos">
<h3><strong>Análisis por Categoría de Modelos</strong><a class="headerlink" href="#analisis-por-categoria-de-modelos" title="Permalink to this heading">#</a></h3>
<section id="modelos-ensemble">
<h4><strong>1. Modelos Ensemble</strong><a class="headerlink" href="#modelos-ensemble" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Random Forest</strong>: Es el modelo con mejor desempeño general, liderando en RMSE y MAE.</p></li>
<li><p><strong>XGBoost</strong>: Ocupa el segundo lugar, muy cerca de Random Forest, pero es dos veces más rápido, lo que lo hace ideal si se busca reducir el tiempo de cómputo.</p></li>
<li><p><strong>Decision Tree</strong>: Es sencillo e interpretable, pero su rendimiento es inferior al de los modelos ensemble.</p></li>
</ul>
</section>
<section id="modelos-lineales">
<h4><strong>2. Modelos Lineales</strong><a class="headerlink" href="#modelos-lineales" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Ridge Regression</strong>: Destaca como un modelo baseline sólido, capturando la señal con una ventana más corta (T=14) y manteniendo un MAE similar a Random Forest, aunque con un RMSE mayor.</p></li>
<li><p><strong>Regresión Lineal</strong>: Sorprende con el MAE más bajo, aunque su alto error cuadrático sugiere un posible sesgo en las predicciones.</p></li>
</ul>
</section>
<section id="modelos-de-soporte-vectorial">
<h4><strong>3. Modelos de Soporte Vectorial</strong><a class="headerlink" href="#modelos-de-soporte-vectorial" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>SVM (linear)</strong>: Logra el MAE más bajo de todos los modelos, lo que lo hace particularmente útil si el objetivo es minimizar el error absoluto.</p></li>
</ul>
</section>
<section id="redes-neuronales">
<h4><strong>4. Redes Neuronales</strong><a class="headerlink" href="#redes-neuronales" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>LSTM</strong> y <strong>RNN</strong>: Muestran rendimiento similar, siendo ligeramente mejores que <strong>MLP</strong>. Sin embargo, ambos sufren de un MAPE extremadamente alto, posiblemente debido a divisiones en velocidades cercanas a cero.</p></li>
<li><p><strong>MLP</strong>: Muestra un rendimiento intermedio, mejorando con ventanas más largas, pero sin igualar a los modelos tradicionales.</p></li>
</ul>
</section>
<section id="knn">
<h4><strong>5. K‑NN</strong><a class="headerlink" href="#knn" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>K‑NN</strong>: Tiene un rendimiento medio, siendo más efectivo con ventanas largas, aunque su sensibilidad a la escala puede ser una desventaja.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="comparacion-de-rendimiento-en-metricas">
<h3><strong>Comparación de Rendimiento en Métricas</strong><a class="headerlink" href="#comparacion-de-rendimiento-en-metricas" title="Permalink to this heading">#</a></h3>
<p>A continuación, se detalla el rendimiento de los modelos en cada una de las métricas clave:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Métrica</strong></p></th>
<th class="head"><p><strong>Mejor Modelo</strong></p></th>
<th class="head"><p><strong>Peor Modelo</strong></p></th>
<th class="head"><p><strong>Observaciones</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>MAPE</strong></p></td>
<td><p>Random Forest (1.514 × 10⁸)</p></td>
<td><p>LSTM (9.455 × 10¹³)</p></td>
<td><p>El MAPE es muy alto en todos los modelos, lo que sugiere desafíos con el error porcentual, posiblemente debido a la escala de los datos o a valores cercanos a cero.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>MAE</strong></p></td>
<td><p>SVM (0.452)</p></td>
<td><p>K‑NN (0.593)</p></td>
<td><p>SVM destaca con el MAE más bajo, mientras que K‑NN tiene un desempeño más deficiente en esta métrica.</p></td>
</tr>
<tr class="row-even"><td><p><strong>RMSE</strong></p></td>
<td><p>Random Forest (0.628)</p></td>
<td><p>MLP (0.978)</p></td>
<td><p>Random Forest lidera, mientras que MLP presenta el error cuadrático más alto, lo que indica un mal ajuste.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>MSE</strong></p></td>
<td><p>Random Forest (0.394)</p></td>
<td><p>MLP (0.954)</p></td>
<td><p>Similar tendencia al RMSE, con Random Forest como el mejor y MLP como el peor.</p></td>
</tr>
<tr class="row-even"><td><p><strong>R²</strong></p></td>
<td><p>RNN (0.666)</p></td>
<td><p>Decision Tree (0.0)</p></td>
<td><p>La mayoría de los modelos tienen un R² deficiente, excepto RNN, lo que sugiere una capacidad limitada para explicar la varianza en los datos.</p></td>
</tr>
</tbody>
</table>
</section>
<hr class="docutils" />
<section id="observaciones">
<h3><strong>Observaciones</strong><a class="headerlink" href="#observaciones" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Para Alta Precisión</strong>:</p>
<ul class="simple">
<li><p><strong>Random Forest</strong> es la mejor opción debido a su superioridad en RMSE y MAE.</p></li>
<li><p><strong>XGBoost</strong> es una alternativa sólida si se busca reducir el tiempo de cómputo.</p></li>
</ul>
</li>
<li><p><strong>Para Simplicidad</strong>:</p>
<ul class="simple">
<li><p><strong>Decision Tree</strong> ofrece resultados interpretables, aunque con menor precisión.</p></li>
<li><p><strong>Regresión Lineal</strong> es una buena referencia simple con un MAE bajo.</p></li>
</ul>
</li>
<li><p><strong>Para Necesidades Específicas</strong>:</p>
<ul class="simple">
<li><p><strong>SVM (linear)</strong> es ideal si el objetivo es minimizar el error absoluto.</p></li>
<li><p><strong>Ridge Regression</strong> es una buena opción para ventanas más cortas y como modelo baseline lineal.</p></li>
</ul>
</li>
<li><p><strong>Para Exploración Futura</strong>:</p>
<ul class="simple">
<li><p><strong>LSTM</strong> y <strong>RNN</strong> requieren ajustes para manejar valores de MAPE extremadamente altos, posiblemente mediante transformaciones de datos o diferentes métricas de error.</p></li>
<li><p><strong>MLP</strong> necesita mejoras en su arquitectura para competir con los modelos tradicionales.</p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="conclusiones-finales">
<h3><strong>Conclusiones Finales</strong><a class="headerlink" href="#conclusiones-finales" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Random Forest</strong> y <strong>XGBoost</strong> son los modelos más destacados, destacándose en precisión y eficiencia computacional respectivamente.</p></li>
<li><p>Los altos valores de MAPE en todos los modelos sugieren la necesidad de abordar problemas de escala o de valores cercanos a cero en la velocidad del viento, posiblemente a través de transformaciones de datos.</p></li>
<li><p>Las redes neuronales, aunque menos precisas en este caso, tienen potencial y podrían mejorar con mejores técnicas de preprocesamiento y ajustes de hiperparámetros.</p></li>
</ul>
<p>Este análisis ofrece una visión clara de las fortalezas y debilidades de cada modelo, permitiendo al usuario tomar decisiones informadas basadas en sus necesidades específicas.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="modelos_clasificacion.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Ejercicio 2. Modelos de Clasificación</p>
      </div>
    </a>
    <a class="right-next"
       href="modelos_segmentacion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ejercicio 4. Modelos de Segmentación</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-knn">Codigo de KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-regresion-lineal">Codigo de Regresion Lineal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-ridge">Codigo de Ridge</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-lasso">Codigo de Lasso</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-arbol-de-decision">Codigo de Arbol de decision</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-random-forest">Codigo de Random Forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-xgboost">Codigo de XGBoost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-svm">Codigo de SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-mlp">Codigo de MLP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparacion-para-rnn-y-lstm">Preparacion para RNN y LSTM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-rnn">Codigo de RNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-de-lstm">Codigo de LSTM</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-evaluacion-para-los-modelos-propuestos">Métricas de evaluación para los modelos propuestos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-absoluto-medio-mae">1. Error Absoluto Medio (MAE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raiz-del-error-cuadratico-medio-rmse">2. Raíz del Error Cuadrático Medio (RMSE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-cuadratico-medio-mse">3. Error Cuadrático Medio (MSE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-porcentual-absoluto-medio-mape">4. Error Porcentual Absoluto Medio (MAPE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coeficiente-de-determinacion-r-2">5. Coeficiente de Determinación ((R^2))</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pvalue-del-test-de-ljungbox">6. p‑value del Test de Ljung–Box</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-comparativo-de-los-modelos"><strong>Análisis Comparativo de los Modelos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-de-modelos-y-metricas"><strong>Resumen de Modelos y Métricas</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-por-categoria-de-modelos"><strong>Análisis por Categoría de Modelos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-ensemble"><strong>1. Modelos Ensemble</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-lineales"><strong>2. Modelos Lineales</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-soporte-vectorial"><strong>3. Modelos de Soporte Vectorial</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#redes-neuronales"><strong>4. Redes Neuronales</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#knn"><strong>5. K‑NN</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-de-rendimiento-en-metricas"><strong>Comparación de Rendimiento en Métricas</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observaciones"><strong>Observaciones</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-finales"><strong>Conclusiones Finales</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Angélica Sepúlveda, Andrés Pedraza y Jefry Llerena
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>